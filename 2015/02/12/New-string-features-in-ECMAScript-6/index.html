<!DOCTYPE html>
<html>

<head>
  <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" >
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
  <title>ECMAScript 6中字符串的新特性 | OwenYang&#39;S IDEAS</title>
  <meta name="description" content="" />
  <meta name="keywords" content="blog, tech blog, code, personal opinion, OwenYang ideas" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="MobileOptimized" content="320" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="icon" type="image/x-icon" href="/img/favicon.ico" />
  <link rel="stylesheet" type="text/css" href="/css/screen.css" />
  <link rel="stylesheet" href="/css/moody.css" type="text/css">

  <meta name="generator" content="OwenYang'S IDEAS">

  
  
  

  
</head>

<!--
<body class="post-template">
-->
<body class="home-template">
<div id="perspective" class="perspective effect-movedown">
  <div class="container">
    <!-- wrapper -->
    <div class="wrapper">
      <header class="header">
    <a href="/" class="logo">OwenYang'S IDEAS</a>
    <nav class="header__nav">
        <ul class="header__nav-list">
            
                <li class="nav-item">
                    <a class="icon-home"  href="/">Home</a>
                    </li>
            
                <li class="nav-item">
                    <a class="icon-mail"  href="/about/">Contact</a>
                    </li>
            

        </ul>
    </nav>
</header>

      

<main class="content" role="main">
  <article class="post">
    <h1 class="post-title">ECMAScript 6中字符串的新特性</h1>
    <span class="post-meta">
      <time datetime="2015-02-12T12:26:43.000Z" itemprop="datePublished">
          Feb 12 2015
      </time>
    
    
    | 
    <a href='/tags/Template/'>Template</a>, 
    
    <a href='/tags/Template-String/'>Template String</a>, 
    
    <a href='/tags/JavaScript/'>JavaScript</a>, 
    
    <a href='/tags/ES6/'>ES6</a>, 
    
    <a href='/tags/ECMAScript-6/'>ECMAScript 6</a>
    
    
</span>
    <section class="post-content">
      <p>本文将覆盖在ECMAScript 6 (ES6)中，字符串的新特性。</p>
<h2 id="Unicode_码位(code_point)转义">Unicode 码位(code point)转义</h2>
<p>Unicode字符码位的长度是21位<a href="http://speakingjs.com/es5/ch24.html" target="_blank" rel="external">[2]</a>。而JavaScript的字符串，是16位的，以UTF-16的方式编码。因此，超出16位码长的码位范围(the Basic Multilingual Pane, BMP, 基本多文种平面)则用两个JavaScript字符表示。直到现在，如果想用数字指定这样的码位，需要两个叫Unicode转义符的东西。以下，则会以相应的码位(0x1F680)打印出一个火箭。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log(<span class="string">'\uD83D\uDE80'</span>);</div></pre></td></tr></table></figure>

<p>在ECMAScript 6中，有一个新的Unicode转义符，能让你指定任意的码位（不用再管是否是16位）：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log(<span class="string">'\u{1F680}'</span>);</div></pre></td></tr></table></figure>

<h2 id="字符串的插值，多行及原始字符语法">字符串的插值，多行及原始字符语法</h2>
<p>模板字符串 <a href="http://www.2ality.com/2011/09/quasi-literals.html" target="_blank" rel="external">[3]</a>提供了3个有意思的特性。<br><strong>1. 模板字符中，支持字符串插值：</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> first = <span class="string">'Jane'</span>;</div><div class="line"><span class="keyword">let</span> last = <span class="string">'Doe'</span>;</div><div class="line"><span class="built_in">console</span>.log(`Hello ${first} ${last}!`);</div><div class="line"><span class="comment">// Hello Jane Doe!</span></div></pre></td></tr></table></figure>

<p><strong>2. 模板字符串可以包含多行：</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> multiLine = `</div><div class="line">  This is</div><div class="line">  a string</div><div class="line">  <span class="keyword">with</span> multiple</div><div class="line">  lines`;</div></pre></td></tr></table></figure>

<p><strong>3. 模板字符串可以是原始的：</strong><br>若使用<code>String.raw</code> 作为模板字符串的前缀，则模板字符串可以是<em>原始(raw)</em>的。反斜线也不再是特殊字符，<code>\n</code> 也不会被解释成换行符：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> raw = <span class="built_in">String</span>.raw`Not a newline: \n`;</div><div class="line"><span class="built_in">console</span>.log(raw === <span class="string">'Not a newline: \\n'</span>); <span class="comment">// true</span></div></pre></td></tr></table></figure>

<h2 id="字符串迭代那些事">字符串迭代那些事</h2>
<p>字符串是可迭代的 <a href="http://www.2ality.com/2013/06/iterators-generators.html" target="_blank" rel="external">[4]</a>，这就意味着可以使用<code>for-of</code> 去迭代其中的字符：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> ch of <span class="string">'abc'</span>) {</div><div class="line">    <span class="built_in">console</span>.log(ch);</div><div class="line">}</div><div class="line"><span class="comment">// Output:</span></div><div class="line"><span class="comment">// a</span></div><div class="line"><span class="comment">// b</span></div><div class="line"><span class="comment">// c</span></div></pre></td></tr></table></figure>

<p>亦可用展开运行符(…) 将字符串转换成数组：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> chars = [...<span class="string">'abc'</span>];</div><div class="line"><span class="comment">// ['a', 'b', 'c']</span></div></pre></td></tr></table></figure>

<h3 id="处理Unicode的码位">处理Unicode的码位</h3>
<p>字符串迭代器，会以码位边界将字符串进行划分。这将导致迭代器的返回值，会是一个或两个字符：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> ch of <span class="string">'x\uD83D\uDE80y'</span>) {</div><div class="line">    <span class="built_in">console</span>.log(ch.length);</div><div class="line">}</div><div class="line"><span class="comment">// Output:</span></div><div class="line"><span class="comment">// 1</span></div><div class="line"><span class="comment">// 2</span></div><div class="line"><span class="comment">// 1</span></div></pre></td></tr></table></figure>

<p>这将会为我提供一个快速而简单的方法，去计算字符串Unicode码位的数量：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; [...<span class="string">'x\uD83D\uDE80y'</span>].length</div><div class="line"><span class="number">3</span></div></pre></td></tr></table></figure>

<p>这同样会在，不包含基本多文种平面(non-BMP)码位的字符串操作中提供方便。如：反转字符串：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> str = <span class="string">'x\uD83D\uDE80y'</span>;</div><div class="line"></div><div class="line"><span class="comment">// ES5: \uD83D\uDE80 are (incorrectly) reversed</span></div><div class="line"><span class="built_in">console</span>.log(str.split(<span class="string">''</span>).reverse().join(<span class="string">''</span>));</div><div class="line"><span class="comment">// 'y\uDE80\uD83Dx'</span></div><div class="line"></div><div class="line"><span class="comment">// ES6: order of \uD83D\uDE80 is preserved</span></div><div class="line"><span class="built_in">console</span>.log([...str].reverse().join(<span class="string">''</span>));</div><div class="line"><span class="comment">// 'y\uD83D\uDE80x'</span></div></pre></td></tr></table></figure>

<p>这是在firefox控制台中，两个反转之后的结果：<br><img src="/images/firefox_unicode.png" alt="Unicode in Firefox"></p>
<h3 id="码位中数值">码位中数值</h3>
<p>有一个新的方法 <code>codePointAt()</code> 将返回字符串，给定索引的码位数字值：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> str = <span class="string">'x\uD83D\uDE80y'</span>;</div><div class="line"><span class="built_in">console</span>.log(str.codePointAt(<span class="number">0</span>).toString(<span class="number">16</span>)); <span class="comment">// 78</span></div><div class="line"><span class="built_in">console</span>.log(str.codePointAt(<span class="number">1</span>).toString(<span class="number">16</span>)); <span class="comment">// 1f680</span></div><div class="line"><span class="built_in">console</span>.log(str.codePointAt(<span class="number">3</span>).toString(<span class="number">16</span>)); <span class="comment">// 79</span></div></pre></td></tr></table></figure>

<p>该方法在与字符串迭代操作结合时，也能很好的运行使用：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> ch of <span class="string">'x\uD83D\uDE80y'</span>) {</div><div class="line">    <span class="built_in">console</span>.log(ch.codePointAt(<span class="number">0</span>).toString(<span class="number">16</span>));</div><div class="line">}</div><div class="line"><span class="comment">// Output:</span></div><div class="line"><span class="comment">// 78</span></div><div class="line"><span class="comment">// 1f680</span></div><div class="line"><span class="comment">// 79</span></div></pre></td></tr></table></figure>

<p>与方法<code>codePointAt()</code>相对的则是<code>String.fromCodePoint()</code>：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; <span class="built_in">String</span>.fromCodePoint(<span class="number">0x78</span>, <span class="number">0x1f680</span>, <span class="number">0x79</span>) === <span class="string">'x\uD83D\uDE80y'</span></div><div class="line"><span class="literal">true</span></div></pre></td></tr></table></figure>

<h2 id="包含与重要字符串的方法">包含与重要字符串的方法</h2>
<p>有三个方法，可以检查一个字符串是否存在于另一个字符串：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&gt; <span class="string">'hello'</span>.startsWith(<span class="string">'hell'</span>)</div><div class="line"><span class="literal">true</span></div><div class="line">&gt; <span class="string">'hello'</span>.endsWith(<span class="string">'ello'</span>)</div><div class="line"><span class="literal">true</span></div><div class="line">&gt; <span class="string">'hello'</span>.includes(<span class="string">'ell'</span>)</div><div class="line"><span class="literal">true</span></div></pre></td></tr></table></figure>

<p>每一个方法都有一个可选的，第二个参数。可以指定被搜寻字符串的开始或结束位置：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&gt; <span class="string">'hello'</span>.startsWith(<span class="string">'ello'</span>, <span class="number">1</span>)</div><div class="line"><span class="literal">true</span></div><div class="line">&gt; <span class="string">'hello'</span>.endsWith(<span class="string">'hell'</span>, <span class="number">4</span>)</div><div class="line"><span class="literal">true</span></div><div class="line"></div><div class="line">&gt; <span class="string">'hello'</span>.includes(<span class="string">'ell'</span>, <span class="number">1</span>)</div><div class="line"><span class="literal">true</span></div><div class="line">&gt; <span class="string">'hello'</span>.includes(<span class="string">'ell'</span>, <span class="number">2</span>)</div><div class="line"><span class="literal">false</span></div></pre></td></tr></table></figure>

<p>方法<code>repeat()</code> 则用以重复某个字符串：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; <span class="string">'doo '</span>.repeat(<span class="number">3</span>)</div><div class="line"><span class="string">'doo doo doo '</span></div></pre></td></tr></table></figure>

<h2 id="所有新方法">所有新方法</h2>
<h3 id="模板字符串：">模板字符串：</h3>
<ul>
<li>String.raw(callSite, …substitutions) : string<br>用于产生<em>原始(raw)</em>字串(反斜杠不会被转义)。</li>
</ul>
<h3 id="Unicode和码位：">Unicode和码位：</h3>
<ul>
<li><p>String.fromCodePoint(…codePoints : number[]) : string<br>将数字值码位转换成字符串。</p>
</li>
<li><p>String.prototype.codePointAt(pos) : number<br>返回码位开始位置的数字值(会包含一个或两个JavaScript的字符)。</p>
</li>
<li><p>String.prototype.normalize(form? : string) : string<br>不同的码位组合，最后可能有一致的显示。<a href="">Unicode normalization</a>可以将它们转化成同样的值，这会被叫做规范的表示方式(canonical representation)。这将有助于比较和查找字符串。在一般的文本之中，’NFC’是一种被推荐的形式。</p>
</li>
</ul>
<h3 id="查找字符串：">查找字符串：</h3>
<ul>
<li><p>String.prototype.startsWith(searchString, position=0) : boolean<br>检查一个字符串是否以另一个字符串(searchString)开始。位置(position)指定从哪开始执行检查。</p>
</li>
<li><p>String.prototype.endsWith(searchString, endPosition=searchString.length) : boolean<br>检查一个字符串是否以另一个字符串(searchString)结尾。结束位置(endPosition)指定在哪执行结尾检查。</p>
</li>
<li><p>String.prototype.includes(searchString, position=0) : boolean<br>检查一个字符字符串是否包含另一个字符串(searchString)。位置(position)指定从哪开始检查。</p>
</li>
</ul>
<h3 id="重复字符串：">重复字符串：</h3>
<ul>
<li>String.prototype.repeat(count) : string<br>返回给定字符串N次。</li>
</ul>
<h2 id="参考">参考</h2>
<ol>
<li><a href="http://www.2ality.com/2014/08/es6-today.html" target="_blank" rel="external">Using ECMAScript 6 today</a></li>
<li>Chapter 24, “<a href="http://speakingjs.com/es5/ch24.html" target="_blank" rel="external">Unicode and JavaScript</a>” of “Speaking JavaScript”; includes an introduction to Unicode.</li>
<li><a href="http://www.2ality.com/2011/09/quasi-literals.html" target="_blank" rel="external">Template strings: embedded DSLs in ECMAScript 6</a></li>
<li><a href="http://www.2ality.com/2013/06/iterators-generators.html" target="_blank" rel="external">Iterators and generators in ECMAScript 6</a></li>
<li>译自 <a href="http://www.2ality.com/2015/01/es6-strings.html" target="_blank" rel="external">New string features in ECMAScript 6</a></li>
</ol>

    </section>
    <footer class="post-footer">
      <section class="author">
    <h4>Owen Yang</h4>
    <p>爱看书，爱社区，爱前端，爱代码。爱这样一个挨踢的行业。</p>
</section>
      <section class="share">
    <h4>Share this post</h4>
    <a class="icon-sina-weibo" href="http://v.t.sina.com.cn/share/share.php?url=http://owenyang0.github.io/2015/02/12/New-string-features-in-ECMAScript-6/&title=ECMAScript 6中字符串的新特性 | OwenYang&#39;S" target="_blank">
        <span class="hidden">weibo</span>
    </a>
    <a class="icon-twitter" href="http://twitter.com/share?url=http://owenyang0.github.io/2015/02/12/New-string-features-in-ECMAScript-6/"
       onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
        <span class="hidden">Twitter</span>
    </a>
    <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=http://owenyang0.github.io/2015/02/12/New-string-features-in-ECMAScript-6/"
       onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
        <span class="hidden">Facebook</span>
    </a>
    <a class="icon-google-plus" href="https://plus.google.com/share?url=http://owenyang0.github.io/2015/02/12/New-string-features-in-ECMAScript-6/"
       onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
        <span class="hidden">Google+</span>
    </a>
</section>

    </footer>
  </article>
  <nav class="pagination" role="pagination">
    
    <a class="newer-posts" href="/2015/02/22/2014压过的辙痕/">
        ← 2014压过的辙痕
    </a>
    
    <span class="icon-logo">•</span>
    
    <a class="older-posts" href="/2015/02/09/NPM-install-killed-error-solution/">
        NPM install - killed error solution →
    </a>
    
</nav>

  <div id="comment" class="comments-area">
    <h4 class="title"><a href="#disqus_comments" name="disqus_comments">Comments</a></h4>
    
    <div id="disqus_thread">
        <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </div>
    
</div>

</main>


      
<footer class="site-footer">
  
  <div class="inner">
     <section class="copyright">All content copyright <a href="/">OwenYang'S IDEAS</a> &copy; 2014 &bull; All rights reserved.</section>
     <section class="poweredby">Proudly published with <a class="icon-ghost" href="https://github.com/owenyang0/moody">moody</a></section>
  </div>
</footer>

      <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


<script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-57882600-1']);
    _gaq.push(['_trackPageview']);

    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
</script>


<script type="text/javascript">
    var disqus_shortname = 'owenyang';

    (function(){
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



    </div>
  </div>
</div>
</body>
</html>
