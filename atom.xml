<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>修远</title>
  <subtitle>其修远兮之路漫漫，吾将求索于墙外之巅</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://owenyang0.github.io/"/>
  <updated>2016-08-15T09:00:19.000Z</updated>
  <id>http://owenyang0.github.io/</id>
  
  <author>
    <name>Owen Yang</name>
    <email>usay@outlook.com</email>
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>编写可维护性CSS之二，语义化</title>
    <link href="http://owenyang0.github.io/2016/05/19/MaintainableCSS-Semantics/"/>
    <id>http://owenyang0.github.io/2016/05/19/MaintainableCSS-Semantics/</id>
    <published>2016-05-19T14:59:14.000Z</published>
    <updated>2016-08-15T09:00:19.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>这是一个系列，谈论所有有关编写可维护性CSS。<br>翻译自：<a href="http://maintainablecss.com/" target="_blank" rel="external">MaintainableCSS</a><br>完整版：<a href="http://owenyang0.github.io/maintainablecss-cn/chapters/semantics/">maintainablecss-cn/chapters/semantics/</a></p>
<p><strong>译者：</strong><br><i class="fa fa-github-square" aria-hidden="true"></i> <a href="https://github.com/owenyang0" target="_blank" rel="external">Owen Yang</a><br><i class="fa fa-github-square" aria-hidden="true"></i> <a href="https://github.com/bangwu" target="_blank" rel="external">Bang Wu</a></p>
</blockquote>
<p><strong>概述:</strong> 基于这 <em>是</em> 什么命名，而不是基于它 <em>像</em> 什么或 <em>能做</em> 什么命名。</p>
<h2 id="长版本解释"><a href="#长版本解释" class="headerlink" title="长版本解释"></a>长版本解释</h2><p>语义化(semantic)的 HTML 不仅仅关乎我们所使用的元素&mdash;&mdash;你当然知道一个链接应该使用 <code>&lt;a&gt;</code> 标签，表格数据应该使用 <code>&lt;table&gt;</code> 标签，段落使用 <code>&lt;p&gt;</code> 等等。</p>
<p>更重要的是，它和我们所添加的类名(class names)和IDs有关。而类名和IDs为 CSS 和 JavaScript提供额外的机制，让我们更容易去操作和增强 HTML 元素。</p>
<p>很容易出现不经过思考而随意添加类名的场景，但现实中命名却又特别重要。</p>
<blockquote>
<p>&ldquo;在计算机科学领域，有两大难题，如何让缓存失效(cache invalidation)和如何给各种东西命名。&rdquo;<br><br>&mdash; <cite>Phil Karlton, 网景架构师</cite></p>
</blockquote>
<p>这是由于人只是擅长和人沟通，却不太能理解简短的，不具有语义化的抽象概念。</p>
<h2 id="类名好坏对比"><a href="#类名好坏对比" class="headerlink" title="类名好坏对比"></a>类名好坏对比</h2><p>试着找出非语义化和语义化类名的区别…<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- 不好 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"red pull-left"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"grid row"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-xs-4"</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>这里完全看不出这段 HTML 代码要表达 <em>什么</em>。你 <em>可能</em> 会说它 <em>看起来</em> 怎样（比如应该在小屏幕还是大屏幕上），但也就仅此而已。<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- 好 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"header"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"basket"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"product"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"searchResults"</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>这段代码就正是我所推崇的。我很清楚地知道这段 HTML 代表着什么。虽然我不知道它看起来应该是怎样的，但我并不在乎，这是 CSS 存在的价值。而语义化的类名对 HTML 和 CSS 甚至 JS 都很有意义。</p>
<p>所以，<em>为什么</em> 我们应该使用语义化的类名呢？</p>
<h2 id="因为更容易理解"><a href="#因为更容易理解" class="headerlink" title="因为更容易理解"></a>因为更容易理解</h2><p>若使用语义化类名，不论你是在修改 HTML 或者 CSS，你都清楚你将造成的影响。而使用视觉化类名(visual class names)的方式，你不得不在每一个元素上写很多类名，最终你可能只是对这些类名有一个模糊的理解，而不清楚它真正的意图是什么。而且，视觉化类名非常难以维护。</p>
<h2 id="因为要构建响应式站点"><a href="#因为要构建响应式站点" class="headerlink" title="因为要构建响应式站点"></a>因为要构建响应式站点</h2><p>一般说来，不同的视图(viewport)会有不同的样式。比如，你可能需要在大屏上浮动(float)一个元素，在小屏不浮动。如果你有一个叫 <code>.clearfix</code> 的类名来清理浮动，但在小屏上的效果却和类名不一样，这看起来会不会让人困惑呢？</p>
<p>使用语义化的类名，你就会基于 mediea queries 去编写样式，这会让 CSS 更易维护。</p>
<h2 id="因为更容易查找"><a href="#因为更容易查找" class="headerlink" title="因为更容易查找"></a>因为更容易查找</h2><p>如果一个元素是基于其外在表像命名，比如 <code>.red</code>, <code>.clearfix</code>, 和 <code>.pull-left</code> 等，那么这些类名就会像垃圾一样散落在代码库的任何地方&mdash;&mdash;当你搜索一段特定的 HTML 代码的时候，类名不会起任何作用。</p>
<p>换句话说，如果你的类名足够语义化，搜索特定代码片段是很简单的事。更常见的是，当你从头搜索你的 HTML(想像一下浏览器上的审查元素)去找类名的时候，查找唯一的 CSS 选择器肯定会快很多。</p>
<h2 id="因为不想做无故的回归测试"><a href="#因为不想做无故的回归测试" class="headerlink" title="因为不想做无故的回归测试"></a>因为不想做无故的回归测试</h2><p>如果你使用描述性的，非语义化的类名，那么当你修改其中一个类名的时候，样式的改变会影响每一个使用这个类名的元素。基于你使用 CSS 的经验，你能保证你的修改不会在其他地方产生不可预知的问题吗？</p>
<p>语义化的类名是唯一的，所以当你编辑其中一个的时候，你 <em>能</em> 自信地说，你的修改只会影响你想要改变的那个模块，维护起来更简单。</p>
<h2 id="因为不用再恐惧更新代码"><a href="#因为不用再恐惧更新代码" class="headerlink" title="因为不用再恐惧更新代码"></a>因为不用再恐惧更新代码</h2><p>和前一个有关回归测试的那一点有关，当你对修改的代码不够自信的时候，你很有可能会造成 BUG 接着便会由于害怕出错而不再碰那些代码。更可怕的是会造成恶性循环，写很多冗余代码，最后变得越来越不具有可维护性。</p>
<h2 id="因为有助于自动化测试"><a href="#因为有助于自动化测试" class="headerlink" title="因为有助于自动化测试"></a>因为有助于自动化测试</h2><p>自动化功能测试需要定位特定的元素，与其进化交互（输入文本，点击按钮、链接等等），基于这些操作进行相关校验。</p>
<p>若你的 HTML 通篇都使用描述性的类名，那么你将不会有一个可靠方式去定位一个特定的元素，更惶论与其交互了。</p>
<h2 id="因为为JavaScript提供了有意义的接口"><a href="#因为为JavaScript提供了有意义的接口" class="headerlink" title="因为为JavaScript提供了有意义的接口"></a>因为为JavaScript提供了有意义的接口</h2><p>就像和自动化测试一样，语义化的类名对JavaScript来说同样有意义。描述性的类名不具有可靠性，不可用于定位相应的模块或组件。</p>
<h2 id="因为常规维护的担心"><a href="#因为常规维护的担心" class="headerlink" title="因为常规维护的担心"></a>因为常规维护的担心</h2><p>若你是基于该元素是什么而命名，你就不必再次修改 HTML 的类名。如，heading 始终是 heading, 你不用管它变成什么样子。</p>
<p>样式可能会改变，但你只需要改变你的 CSS。这在另一个方面来说，实际是上松耦合从而提高了可维护性。</p>
<h2 id="因为非语义类名调试困难"><a href="#因为非语义类名调试困难" class="headerlink" title="因为非语义类名调试困难"></a>因为非语义类名调试困难</h2><p>当你调试(debug)一个元素的时候，会出现很多类似的 CSS 选择器，增加了调试的难度。</p>
<h2 id="因为标准推荐使用"><a href="#因为标准推荐使用" class="headerlink" title="因为标准推荐使用"></a>因为标准推荐使用</h2><p>HTML5 的规范在 <a href="https://www.w3.org/TR/html5/dom.html#classes" target="_blank" rel="external">3.2.5.7</a> 里有说，使用类名属性。</p>
<blockquote>
<p>“[…] 更鼓励使用能描述内容本质的类名，而不是那些只是描述其外在表像的值。”</p>
</blockquote>
<h2 id="因为能带来性能的提升"><a href="#因为能带来性能的提升" class="headerlink" title="因为能带来性能的提升"></a>因为能带来性能的提升</h2><p>这是一个 <em>非常</em> 小的优势，因为当你一个元素只有一个类名的时候，你的整个 HTML 代码体积都会更小。而使用描述性的类名，每个元素有无数个类名，结果自然与前者不一样。</p>
<h2 id="因为和重用规则有关"><a href="#因为和重用规则有关" class="headerlink" title="因为和重用规则有关"></a>因为和重用规则有关</h2><p>如果你没有使用语义化类名，你有可能会是误解了重用(reuse)的概念，而误用重用。阅读下章，获得更多。</p>
<!--## Why? Because visual class names might declare the same property!

It's likely that several different utility classes could refer to the same property meaning order matters and performance degrades.

Think of an example of this.
-->
<h2 id="最后想想语义化"><a href="#最后想想语义化" class="headerlink" title="最后想想语义化"></a>最后想想语义化</h2><p>语义化的类名是 <em>MaintainableCSS</em> 的基石，没有它，一切都没意义。所以，基于是什么命名，其他所有都将受益。</p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;这是一个系列，谈论所有有关编写可维护性CSS。&lt;br&gt;翻译自：&lt;a href=&quot;http://maintainablecss.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;MaintainableCSS&lt;/a&gt;&lt;br&gt;完
    
    </summary>
    
    
      <category term="MaintainableCSS" scheme="http://owenyang0.github.io/tags/MaintainableCSS/"/>
    
      <category term="CSS" scheme="http://owenyang0.github.io/tags/CSS/"/>
    
      <category term="Semantics" scheme="http://owenyang0.github.io/tags/Semantics/"/>
    
  </entry>
  
  <entry>
    <title>编写可维护性CSS之一，前言</title>
    <link href="http://owenyang0.github.io/2016/05/19/MaintainableCSS-introduction/"/>
    <id>http://owenyang0.github.io/2016/05/19/MaintainableCSS-introduction/</id>
    <published>2016-05-19T14:27:27.000Z</published>
    <updated>2016-08-15T09:00:19.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>这是一个系列，谈论所有有关编写可维护性CSS。<br>翻译自：<a href="http://maintainablecss.com/" target="_blank" rel="external">MaintainableCSS</a><br>完整版：<a href="http://owenyang0.github.io/maintainablecss-cn/chapters/introduction/">maintainablecss-cn/chapters/introduction/</a></p>
<p><strong>译者：</strong><br><i class="fa fa-github-square" aria-hidden="true"></i> <a href="https://github.com/owenyang0" target="_blank" rel="external">Owen Yang</a><br><i class="fa fa-github-square" aria-hidden="true"></i> <a href="https://github.com/bangwu" target="_blank" rel="external">Bang Wu</a></p>
</blockquote>
<p><em>MaintainableCSS</em> 是一种编写模块化、可扩展和易维护的CSS的架构。</p>
<p>在实际情况下，这意味着，作为一个开发者，当我想创建一个新的功能或者修改已有的功能的时候，我不需要担心会使原来的代码变的更糟。</p>
<h2 id="什么都不需要下载"><a href="#什么都不需要下载" class="headerlink" title="什么都不需要下载"></a>什么都不需要下载</h2><p><em>MaintainableCSS</em> 是不需要下载的。这只是一套帮助你构建大规模或者小规模网站的原则、指南和约定。</p>
<h2 id="可维护的意义是什么？"><a href="#可维护的意义是什么？" class="headerlink" title="可维护的意义是什么？"></a>可维护的意义是什么？</h2><p>有一份可维护的代码意味着当你编辑一个模块的样式的时候不需要担心意外的改变的其他模块的代码。我清楚的知道我写出的代码是经过封装的。</p>
<h2 id="可维护的意义是什么？-1"><a href="#可维护的意义是什么？-1" class="headerlink" title="可维护的意义是什么？"></a>可维护的意义是什么？</h2><p>这意味着, 当CSS代码库的大小增长的时候, 维护这些代码不会有任何困难. 如果你曾经继承了一个大的CSS代码库并且害怕去编辑这些已有的样式,你就会深有感触了。</p>
<h2 id="模块化的意义是什么？"><a href="#模块化的意义是什么？" class="headerlink" title="模块化的意义是什么？"></a>模块化的意义是什么？</h2><p>模块是一个特殊的、独立的单元，可以与其他的模块进行组合，以便形成更加复杂的单元。例如在一个客厅，你可以把电视、沙发和墙分别看成模块，这些组合在一起就是一个可以使用的房间。</p>
<p>如果你带走其中一个单元，其他的任然能够工作的很好，没有电视你也能坐在沙发上，在一个网站上，页眉、页脚、产品列表和文章，这些都可以考虑为一个模块。</p>
<h2 id="这适合谁？"><a href="#这适合谁？" class="headerlink" title="这适合谁？"></a>这适合谁？</h2><p>如果你曾经经历过维护CSS的痛苦，这本书可以帮助你避免常见的问题。无论的你的组是1个人或者是100个人，你都能在这本书上找到有用的建议。如果你的网站正在发展，你更加需要这本书。</p>
<h2 id="这学起来难吗？"><a href="#这学起来难吗？" class="headerlink" title="这学起来难吗？"></a>这学起来难吗？</h2><p>我想说的是这很容易学。你可以在20分钟内读完这本书并且在几分钟内使用这些规则。如果你发现了任何错误请及时通知我。</p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;这是一个系列，谈论所有有关编写可维护性CSS。&lt;br&gt;翻译自：&lt;a href=&quot;http://maintainablecss.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;MaintainableCSS&lt;/a&gt;&lt;br&gt;完
    
    </summary>
    
    
      <category term="MaintainableCSS" scheme="http://owenyang0.github.io/tags/MaintainableCSS/"/>
    
      <category term="CSS" scheme="http://owenyang0.github.io/tags/CSS/"/>
    
  </entry>
  
  <entry>
    <title>Babel和Rollup，开始构建发布你的ES6模块(Modules)</title>
    <link href="http://owenyang0.github.io/2016/05/14/Build-and-Public-ES6-Modules-Today/"/>
    <id>http://owenyang0.github.io/2016/05/14/Build-and-Public-ES6-Modules-Today/</id>
    <published>2016-05-14T10:06:26.000Z</published>
    <updated>2016-08-15T09:00:19.000Z</updated>
    
    <content type="html"><![CDATA[<p>早在2015年六月，ES2015规范或者叫ES6就正式被ECMA国际协会(Ecma International)批准，成为了新一代的语言标准。2016年四月，Node.js团队发布了号称支持93%的ES6语言特性的Node v6，不过这一切还是由于V8引擎v5.0的发布。</p>
<p>是应该使用最新的语言特性，ES6+的语法，还是应该使用第三方库与polyfills来编写一个JavaScript库？相信这个问题一定困扰着写JavaScript库的你，因为这很难说前者会比后者有更大的优势。私以为，前者能减少代码冗余，让代码更可读，使用更少的抽象，让代码库更容易维护与扩展，提高开发效率等等。</p>
<p>如果你正在开发一个全新的基于Node.js平台的JavaScript库(npm 包), 那基于Node.js v6环境使用最新的特性将是一个很好的选择。你也可以同时提供给Node v5或者更老版本的开发者一个回退版本(fallback)，如此一来Node v6的用户也可以正常地使用你的库：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> MyLibrary = <span class="built_in">require</span>(<span class="string">'my-library'</span>);</div></pre></td></tr></table></figure></p>
<p>在Node.js v6的环境，代码将是最简洁优雅的。同时也得保证使用Node 0.x, 4.x, 5.x的用户能够导入ES5.1版本的库：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> MyLibrary = <span class="built_in">require</span>(<span class="string">'my-library/legacy'</span>);</div></pre></td></tr></table></figure></p>
<p>除此以外，强烈推荐将使用ES2015模块语法的版本也放在你的NPM包中。虽然ES2015的<a href="https://twitter.com/koistya/status/726042867211325440" target="_blank" rel="external">模块系统</a>还无法在Node.js或者V8中使用，但Node.js和前端社区早已大量地使用这种规范组织代码，这一切都归功于模块打包工具(module bundlers)，如Webpack, Berify, JSPM，Babel等等。</p>
<p>若要使用ES6的方式发布你的包，你项目的目录结构看起来可能会像这样：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">.</div><div class="line">├── /dist/                  # Temp folder for compiled output</div><div class="line">│   ├── /legacy/            # Legacy bundle(s) for Node 0.x, 4.x</div><div class="line">│   │   ├── /main.js        # ES5.1 bundle for Node 0.x, 4.x</div><div class="line">│   │   └── /package.json   # Legacy NPM module settings</div><div class="line">│   ├── /main.js            # ES6 bundle /w CommonJS for Node v6</div><div class="line">│   ├── /main.mjs           # ES6 bundle /w Modules for cool kids</div><div class="line">│   ├── /main.browser.js    # ES5.1 bundle for browsers</div><div class="line">│   ├── /my-library.js      # UMD bundle for browsers</div><div class="line">│   ├── /my-library.min.js  # UMD bundle, minified and optimized</div><div class="line">│   └── /package.json       # NPM module settings</div><div class="line">├── /node_modules/          # 3rd-party libraries and utilities</div><div class="line">├── /src/                   # ES2015+ source code</div><div class="line">│   ├── /main.js            # The main entry point</div><div class="line">│   ├── /sub-module-a.js    # A module referenced in main.js</div><div class="line">│   └── /sub-module-b.js    # A module referenced in main.js</div><div class="line">├── /test/                  # Unit and end-to-end tests</div><div class="line">├── /tools/                 # Build automation scripts and utilities</div><div class="line">│   └── /build.js           # Builds the project with Babel/Rollup</div><div class="line">└── package.json            # Project settings</div></pre></td></tr></table></figure></p>
<p>在 <em>src</em> 目录里包含了你项目的源代码(当然是ES2015+规范)，<em>dist</em> (或者 <em>build</em> )目录则是在你构建工程时动态生成的。通过 <em>dist</em> 目录，你可以发布你的NPM包(package)，里面包含了使用Babel和Webapck编译出来的符合CommonJS, ES6，和UMD规范的包(bundle).</p>
<p>在你的 <em>package.json</em> 文件里面会包含这些bundle的引用：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  &quot;name&quot;: &quot;my-library&quot;,</div><div class="line">  &quot;version&quot;: &quot;1.0.0&quot;,</div><div class="line">  &quot;main&quot;: &quot;main.js&quot;,</div><div class="line">  &quot;jsnext:main&quot;: &quot;main.mjs&quot;,</div><div class="line">  &quot;browser&quot;: &quot;main.browser.js&quot;,</div><div class="line">  ...</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><code>tools/build.js</code>脚本是一种便捷的方式去配置你的编译过程，它看起来可能会像这样：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div></pre></td><td class="code"><pre><div class="line"><span class="meta">'use strict'</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</div><div class="line"><span class="keyword">const</span> del = <span class="built_in">require</span>(<span class="string">'del'</span>);</div><div class="line"><span class="keyword">const</span> rollup = <span class="built_in">require</span>(<span class="string">'rollup'</span>);</div><div class="line"><span class="keyword">const</span> babel = <span class="built_in">require</span>(<span class="string">'rollup-plugin-babel'</span>);</div><div class="line"><span class="keyword">const</span> uglify = <span class="built_in">require</span>(<span class="string">'rollup-plugin-uglify'</span>);</div><div class="line"><span class="keyword">const</span> pkg = <span class="built_in">require</span>(<span class="string">'../package.json'</span>);</div><div class="line"></div><div class="line"><span class="keyword">const</span> bundles = [</div><div class="line">  &#123;</div><div class="line">    format: <span class="string">'cjs'</span>, ext: <span class="string">'.js'</span>, plugins: [],</div><div class="line">    babelPresets: [<span class="string">'stage-1'</span>], babelPlugins: [</div><div class="line">      <span class="string">'transform-es2015-destructuring'</span>,</div><div class="line">      <span class="string">'transform-es2015-function-name'</span>,</div><div class="line">      <span class="string">'transform-es2015-parameters'</span></div><div class="line">    ]</div><div class="line">  &#125;,</div><div class="line">  &#123;</div><div class="line">    format: <span class="string">'es6'</span>, ext: <span class="string">'.mjs'</span>, plugins: [],</div><div class="line">    babelPresets: [<span class="string">'stage-1'</span>], babelPlugins: [</div><div class="line">      <span class="string">'transform-es2015-destructuring'</span>,</div><div class="line">      <span class="string">'transform-es2015-function-name'</span>,</div><div class="line">      <span class="string">'transform-es2015-parameters'</span></div><div class="line">    ]</div><div class="line">  &#125;,</div><div class="line">  &#123;</div><div class="line">    format: <span class="string">'cjs'</span>, ext: <span class="string">'.browser.js'</span>, plugins: [],</div><div class="line">    babelPresets: [<span class="string">'es2015-rollup'</span>, <span class="string">'stage-1'</span>], babelPlugins: []</div><div class="line">  &#125;,</div><div class="line">  &#123;</div><div class="line">    format: <span class="string">'umd'</span>, ext: <span class="string">'.js'</span>, plugins: [],</div><div class="line">    babelPresets: [<span class="string">'es2015-rollup'</span>, <span class="string">'stage-1'</span>], babelPlugins: [],</div><div class="line">    moduleName: <span class="string">'my-library'</span></div><div class="line">  &#125;,</div><div class="line">  &#123;</div><div class="line">    format: <span class="string">'umd'</span>, ext: <span class="string">'.min.js'</span>, plugins: [uglify()]</div><div class="line">    babelPresets: [<span class="string">'es2015-rollup'</span>, <span class="string">'stage-1'</span>], babelPlugins: [],</div><div class="line">    moduleName: <span class="string">'my-library'</span>, minify: <span class="literal">true</span></div><div class="line">  &#125;</div><div class="line">];</div><div class="line"></div><div class="line"><span class="keyword">let</span> promise = <span class="built_in">Promise</span>.resolve();</div><div class="line"></div><div class="line"><span class="comment">// Clean up the output directory</span></div><div class="line">promise = promise.then(() =&gt; del([<span class="string">'dist/*'</span>]));</div><div class="line"></div><div class="line"><span class="comment">// Compile source code into a distributable format with Babel and Rollup</span></div><div class="line"><span class="keyword">for</span> (<span class="keyword">const</span> config <span class="keyword">of</span> bundles) &#123;</div><div class="line">  promise = promise.then(() =&gt; rollup.rollup(&#123;</div><div class="line">    entry: <span class="string">'src/main.js'</span>,</div><div class="line">    external: <span class="built_in">Object</span>.keys(pkg.dependencies),</div><div class="line">    plugins: [</div><div class="line">      babel(&#123;</div><div class="line">        babelrc: <span class="literal">false</span>,</div><div class="line">        exclude: <span class="string">'node_modules/**'</span>,</div><div class="line">        presets: config.babelPresets,</div><div class="line">        plugins: config.babelPlugins,</div><div class="line">      &#125;)</div><div class="line">    ].concat(config.plugins),</div><div class="line">  &#125;).then(bundle =&gt; bundle.write(&#123;</div><div class="line">    dest: <span class="string">`dist/<span class="subst">$&#123;config.moduleName || 'main'&#125;</span><span class="subst">$&#123;config.ext&#125;</span>`</span>,</div><div class="line">    format: config.format,</div><div class="line">    sourceMap: !config.minify,</div><div class="line">    moduleName: config.moduleName,</div><div class="line">  &#125;)));</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// Copy package.json and LICENSE.txt</span></div><div class="line">promise = promise.then(() =&gt; &#123;</div><div class="line">  <span class="keyword">delete</span> pkg.private;</div><div class="line">  <span class="keyword">delete</span> pkg.devDependencies;</div><div class="line">  <span class="keyword">delete</span> pkg.scripts;</div><div class="line">  <span class="keyword">delete</span> pkg.eslintConfig;</div><div class="line">  <span class="keyword">delete</span> pkg.babel;</div><div class="line">  fs.writeFileSync(<span class="string">'dist/package.json'</span>, <span class="built_in">JSON</span>.stringify(pkg, <span class="literal">null</span>, <span class="string">'  '</span>), <span class="string">'utf-8'</span>);</div><div class="line">  fs.writeFileSync(<span class="string">'dist/LICENSE.txt'</span>, fs.readFileSync(<span class="string">'LICENSE.txt'</span>, <span class="string">'utf-8'</span>), <span class="string">'utf-8'</span>);</div><div class="line">&#125;);</div><div class="line"></div><div class="line">promise.catch(err =&gt; <span class="built_in">console</span>.error(err.stack)); <span class="comment">// eslint-disable-line no-console</span></div><div class="line"><span class="comment">// https://gist.github.com/koistya/1abc156c61814fc307210f33e127f124</span></div></pre></td></tr></table></figure></p>
<p>现在你只需要简单运行 <code>node tools/build</code> (假定你已经在本地装好了Node.js v6)，就可以构建你的牛X库了，然后你只需要在 <code>dist</code> 目录下，将代码发布到NPM就OK了。</p>
<p>希望该博可以对你有所帮助，这或许是将你的牛库是以ES6发布在NPM上的最好方式。你也可以在这里看到预配置好的发布NPM包的样板文件：<a href="https://github.com/kriasoft/babel-starter-kit" target="_blank" rel="external">https://github.com/kriasoft/babel-starter-kit</a></p>
<p>如果你发现有什么遗漏，不清楚，欢迎留言 :)</p>
<p>[译]<a href="https://medium.com/@tarkus/how-to-build-and-publish-es6-modules-today-with-babel-and-rollup-4426d9c7ca71#.38s3c7m0q" target="_blank" rel="external">How to Build and Publish ES6 Modules Today, with Babel and Rollup</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;早在2015年六月，ES2015规范或者叫ES6就正式被ECMA国际协会(Ecma International)批准，成为了新一代的语言标准。2016年四月，Node.js团队发布了号称支持93%的ES6语言特性的Node v6，不过这一切还是由于V8引擎v5.0的发布。&lt;
    
    </summary>
    
    
      <category term="Babel" scheme="http://owenyang0.github.io/tags/Babel/"/>
    
      <category term="Rollup" scheme="http://owenyang0.github.io/tags/Rollup/"/>
    
      <category term="Modules" scheme="http://owenyang0.github.io/tags/Modules/"/>
    
      <category term="ES6" scheme="http://owenyang0.github.io/tags/ES6/"/>
    
      <category term="NPM" scheme="http://owenyang0.github.io/tags/NPM/"/>
    
  </entry>
  
  <entry>
    <title>赶在2015最后一班车</title>
    <link href="http://owenyang0.github.io/2016/01/03/%E8%B5%B6%E5%9C%A82015%E6%9C%80%E5%90%8E%E4%B8%80%E7%8F%AD%E8%BD%A6/"/>
    <id>http://owenyang0.github.io/2016/01/03/赶在2015最后一班车/</id>
    <published>2016-01-02T16:15:17.000Z</published>
    <updated>2016-08-15T09:00:19.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>2015人在路上，心在外边。</p>
</blockquote>
<h3 id="别煽情了"><a href="#别煽情了" class="headerlink" title="别煽情了"></a>别煽情了</h3><blockquote>
<p>一切都是安好，一段刻骨铭心却注定未果的交往，一场不闻外事说走就走的旅行，一人默默品尝苦辣酸甜的生活，以及一丝从未消逝掉的那抹期待。慢慢地，学会了一个人。</p>
</blockquote>
<p>早已不是当初的那只雏鸟，却也算不得自由挥翅的雄鹰，这是毕业后完整的一年，同学之间见得少了，朋友之间的联系也不是那么多了，每个人都生活在新的圈子里，或是独自承受，或是开始担当。不是忘了，兴许是累了，应该不会有人去忘却曾经的岁月青葱，如果有那么天，定会想起当初的约定，初心么？</p>
<p>学不会怎么去煽情，也不懂如何去述事，每每有一点东西，欲从内心深处蹦出，却又在键盘上的指间错过。</p>
<p>时间下午，还有夕阳。地点武汉，开往机场。人物出租车师傅以及自己，漫天黄沙与雾霾。就在沙与霾的包裹中，从夕阳时走到晚上，视野早已不清楚，不是因为没有灯，是因为灯光下的世界是那么的模糊。<br><img src="/images/airport.jpg" alt="airport" title="airport"></p>
<h3 id="要实在点"><a href="#要实在点" class="headerlink" title="要实在点"></a>要实在点</h3><ul>
<li><p><strong>读书</strong> 是个严肃活儿，有计划，有目标，有方向才能更好地读懂生活。去年，或许只有读书计划完成了，貌似是因为也没其他的计划。翻了一下去年的总结，计划不多，一年30本书，足矣。</p>
<ul>
<li>相比于2014，也是有了长足的进步。20本 –&gt; 33本。</li>
<li>明年，2016，成长着，<em><em>50本</em></em>。</li>
</ul>
</li>
<li><p><strong>文字</strong> 很神奇，放得越久越能感受其伟大。回看2014的总结，才知当时自己是种怎样的心境。记录生活，记录自己，不是把自己复制，只求某一天回首时，能发现自己也走过如些不一般的道路。</p>
</li>
<li><p><strong>旅行</strong> 不是放纵，也许是放松，但对某些人更可能是灵魂的洗涤净化。日本有去，古都文化，走着走着，你会顿悟吗？下一站，你说呢？</p>
</li>
<li><p><strong>英语</strong> 这东西怎么说呢，日常似乎也能应付，但缺乏系统地掌握。身处这样一个环境之中，是多么好的机会，明年要不拿个雅思玩？要求别太高，<em>6分</em> 吧。</p>
</li>
<li><p><strong>电影</strong> 不只是那么120分钟的剧情，也不是影院里的各种特效，在乎的是什么呢。今年看书算是比较多了，电影感觉也没落下，慢慢地发现电影中有太多自己没有思考过的事情，和书一样传递出思考。</p>
</li>
</ul>
<ul>
<li><strong>驾照</strong>，哟就一本儿，找个机会拿下它吧。</li>
</ul>
<h3 id="留点东西"><a href="#留点东西" class="headerlink" title="留点东西"></a>留点东西</h3><p>去年送给自己的一句话：心态，别抑郁，要乐观，诚对人，能坚持，追梦想。除了“别抑郁”，自己都做得挺好。<br>再送自己一句话，给2016:</p>
<blockquote>
<p>你就是你，不要在乎别人的比拟，自己觉得自己活得精彩那便是精彩。</p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;2015人在路上，心在外边。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;别煽情了&quot;&gt;&lt;a href=&quot;#别煽情了&quot; class=&quot;headerlink&quot; title=&quot;别煽情了&quot;&gt;&lt;/a&gt;别煽情了&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;
    
    </summary>
    
    
      <category term="2015" scheme="http://owenyang0.github.io/tags/2015/"/>
    
      <category term="summary" scheme="http://owenyang0.github.io/tags/summary/"/>
    
      <category term="plan" scheme="http://owenyang0.github.io/tags/plan/"/>
    
      <category term="2016" scheme="http://owenyang0.github.io/tags/2016/"/>
    
  </entry>
  
  <entry>
    <title>Overview of ES6</title>
    <link href="http://owenyang0.github.io/2015/05/31/Overview-of-ES6/"/>
    <id>http://owenyang0.github.io/2015/05/31/Overview-of-ES6/</id>
    <published>2015-05-31T09:03:25.000Z</published>
    <updated>2016-08-15T09:00:19.000Z</updated>
    
    <content type="html"><![CDATA[<p>Slides in ES6 overview workshop</p>
<h2 id="Intro"><a href="#Intro" class="headerlink" title="Intro"></a>Intro</h2><h3 id="What"><a href="#What" class="headerlink" title="What"></a>What</h3><p>ECMAScript 6（以下简称ES6）是JavaScript语言的下一代标准</p>
<h3 id="Goal"><a href="#Goal" class="headerlink" title="Goal"></a>Goal</h3><p>ES6的目标，是使得JavaScript语言可以用来编写大型的复杂的应用程序，成为企业级开发语言。<br>新的语言特性，代码更优雅，程序更健壮，减少不必要的重复，减少不必要的第三方依赖。</p>
<h2 id="Agenda"><a href="#Agenda" class="headerlink" title="Agenda"></a>Agenda</h2><ul>
<li>template strings</li>
<li>const</li>
<li>let</li>
<li>block-level declaration</li>
<li>Destructuring Assignment</li>
<li>arrow functions</li>
<li>default function params</li>
<li>class</li>
<li>module</li>
</ul>
<h2 id="Requirements"><a href="#Requirements" class="headerlink" title="Requirements"></a>Requirements</h2><p>Babel <a href="https://babeljs.io/docs/usage/cli/" target="_blank" rel="external">https://babeljs.io/docs/usage/cli/</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ npm install --global babel</div></pre></td></tr></table></figure>
<h2 id="Talk-is-cheap-show-me-the-code"><a href="#Talk-is-cheap-show-me-the-code" class="headerlink" title="Talk is cheap, show me the code."></a>Talk is cheap, show me the code.</h2><h2 id="template-strings"><a href="#template-strings" class="headerlink" title="template strings"></a>template strings</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> first = <span class="string">"Song"</span></div><div class="line"><span class="keyword">var</span> last = <span class="string">"Yang"</span>;</div><div class="line"><span class="keyword">var</span> name = <span class="string">`I'm <span class="subst">$&#123;first&#125;</span> <span class="subst">$&#123;last&#125;</span>!`</span>;</div></pre></td></tr></table></figure>
<p><strong>性能对比</strong><br><a href="http://heeroluo.net/article/detail/54" target="_blank" rel="external">http://heeroluo.net/article/detail/54</a></p>
<p>它可以当作普通字符串使用，也可以用来定义多行字符串，或者在字符串中嵌入变量。</p>
<h2 id="const"><a href="#const" class="headerlink" title="const"></a>const</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> PI = <span class="number">3.14</span></div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Object</span>.defineProperty(<span class="keyword">typeof</span> global === <span class="string">"object"</span> ? global : <span class="built_in">window</span>, <span class="string">"PI"</span>, &#123;</div><div class="line">    value:        <span class="number">3.14</span>,</div><div class="line">    enumerable:   <span class="literal">true</span>,</div><div class="line">    writable:     <span class="literal">false</span>,</div><div class="line">    configurable: <span class="literal">false</span></div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h2 id="let"><a href="#let" class="headerlink" title="let"></a>let</h2><p>声明变量，变量只在let命令所在代码块内有效。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="keyword">var</span> a = <span class="number">1</span>;</div><div class="line">  <span class="keyword">let</span> b = <span class="number">10</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line">a <span class="comment">//1</span></div><div class="line">b <span class="comment">// ReferenceError: b is not defined.</span></div></pre></td></tr></table></figure>
<p>let不允许在相同作用域内，重复声明同一个变量。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// error</span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">let</span> a = <span class="number">10</span>;</div><div class="line">    <span class="keyword">let</span> a = <span class="number">1</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="block-level-declaration"><a href="#block-level-declaration" class="headerlink" title="block-level declaration"></a>block-level declaration</h2><ul>
<li>let, const 块级作用域</li>
<li>var 函数作用域</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>,len=<span class="number">5</span>;i&lt;len;i++) &#123;</div><div class="line">        <span class="comment">//body</span></div><div class="line">    &#125;</div><div class="line">    <span class="built_in">console</span>.log(i,len);=&gt; <span class="number">5</span>,<span class="number">5</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ES5的JavaScript的不支持块级作用域，变量仅仅被限制到函数作用域内。</p>
<h3 id="Pros"><a href="#Pros" class="headerlink" title="Pros"></a>Pros</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// IIFE写法</span></div><div class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> tmp = ...;</div><div class="line">    ...</div><div class="line">&#125;());</div><div class="line"></div><div class="line"><span class="comment">// 块级作用域写法</span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">let</span> tmp = ...;</div><div class="line">    ...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="function-scope"><a href="#function-scope" class="headerlink" title="function scope"></a>function scope</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123; <span class="built_in">console</span>.log(<span class="string">'I am outside!'</span>); &#125;</div><div class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span>(<span class="literal">false</span>) &#123;</div><div class="line">    <span class="comment">// What should happen with this redeclaration?</span></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123; <span class="built_in">console</span>.log(<span class="string">'I am inside!'</span>); &#125;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  f();</div><div class="line">&#125;());</div></pre></td></tr></table></figure>
<h2 id="Destructuring-Assignment"><a href="#Destructuring-Assignment" class="headerlink" title="Destructuring Assignment"></a>Destructuring Assignment</h2><p>ES6允许按照一定模式，从数组和对象中提取值，对变量进行赋值，这被称为解构（Destructuring）。</p>
<h3 id="Array-destructuring"><a href="#Array-destructuring" class="headerlink" title="Array destructuring"></a>Array destructuring</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> a = <span class="number">1</span>;</div><div class="line"><span class="keyword">var</span> b = <span class="number">2</span>;</div><div class="line"><span class="keyword">var</span> c = <span class="number">3</span>;</div><div class="line"></div><div class="line"><span class="keyword">var</span> [a, b, c] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</div><div class="line"></div><div class="line">[a, b] = [b, a];</div></pre></td></tr></table></figure>
<h3 id="模式匹配（嵌套数组）"><a href="#模式匹配（嵌套数组）" class="headerlink" title="模式匹配（嵌套数组）"></a>模式匹配（嵌套数组）</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> [foo, [[bar], baz]] = [<span class="number">1</span>, [[<span class="number">2</span>], <span class="number">3</span>]];</div><div class="line">foo <span class="comment">// 1</span></div><div class="line">bar <span class="comment">// 2</span></div><div class="line">baz <span class="comment">// 3</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> [,,third] = [<span class="string">"foo"</span>, <span class="string">"bar"</span>, <span class="string">"baz"</span>];</div><div class="line">third <span class="comment">// "baz"</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> [head, ...tail] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>];</div><div class="line">head <span class="comment">// 1</span></div><div class="line">tail <span class="comment">// [2, 3, 4]</span></div></pre></td></tr></table></figure>
<h3 id="解构失败"><a href="#解构失败" class="headerlink" title="解构失败"></a>解构失败</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> [foo] = [];</div><div class="line"><span class="keyword">var</span> [foo] = <span class="number">1</span>;</div><div class="line"><span class="keyword">var</span> [foo] = <span class="string">'Hello'</span>;</div><div class="line"><span class="keyword">var</span> [foo] = <span class="literal">false</span>;</div><div class="line"><span class="keyword">var</span> [foo] = <span class="literal">NaN</span>;</div><div class="line"><span class="keyword">var</span> [bar, foo] = [<span class="number">1</span>];</div><div class="line"></div><div class="line">foo <span class="comment">// undefined</span></div></pre></td></tr></table></figure>
<ul>
<li><p>如果对undefined或null进行解构，会报错。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 报错</span></div><div class="line"><span class="keyword">var</span> [foo] = <span class="literal">undefined</span>;</div><div class="line"><span class="keyword">var</span> [foo] = <span class="literal">null</span>;</div></pre></td></tr></table></figure>
</li>
<li><p>解构赋值允许指定默认值。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[x, y=<span class="string">'b'</span>] = [<span class="string">'a'</span>] <span class="comment">// x=3, y='b'</span></div></pre></td></tr></table></figure>
</li>
<li><p>解构赋值不仅适用于var命令，也适用于let和const命令。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> [v1, v2, ..., vN ] = array;</div><div class="line"><span class="keyword">let</span> [v1, v2, ..., vN ] = array;</div><div class="line"><span class="keyword">const</span> [v1, v2, ..., vN ] = array;</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="Object-destructuring"><a href="#Object-destructuring" class="headerlink" title="Object destructuring"></a>Object destructuring</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> &#123; foo, bar &#125; = &#123; foo: <span class="string">"aaa"</span>, bar: <span class="string">"bbb"</span> &#125;;</div><div class="line">foo <span class="comment">// "aaa"</span></div><div class="line">bar <span class="comment">// "bbb"</span></div></pre></td></tr></table></figure>
<p>如果变量名与属性名不一致，必须写成下面这样。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> &#123; foo: baz &#125; = &#123; foo: <span class="string">"aaa"</span>, bar: <span class="string">"bbb"</span> &#125;;</div><div class="line">baz <span class="comment">// "aaa"</span></div></pre></td></tr></table></figure></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> o = &#123;</div><div class="line">  p: [</div><div class="line">    <span class="string">"Hello"</span>,</div><div class="line">    &#123; y: <span class="string">"World"</span> &#125;</div><div class="line">  ]</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> &#123; p: [x, &#123; y &#125;] &#125; = o;</div><div class="line">x <span class="comment">// "Hello"</span></div><div class="line">y <span class="comment">// "World"</span></div></pre></td></tr></table></figure>
<ul>
<li>对象的解构也可以指定默认值。</li>
<li>如果要将一个已经声明的变量用于解构赋值<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 错误的写法</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> x;</div><div class="line">&#123;x&#125; = &#123;x:<span class="number">1</span>&#125;;</div><div class="line"><span class="comment">// SyntaxError: syntax error</span></div><div class="line"></div><div class="line">(&#123;x&#125; = &#123;x:<span class="number">1</span>&#125;);</div></pre></td></tr></table></figure>
</li>
</ul>
<p>JavaScript引擎会将{x}理解成一个代码块，从而发生语法错误。</p>
<p><strong>NOTE</strong> 数组的元素是按次序排列的，变量的取值由它的位置决定；而对象的属性没有次序，变量必须与属性同名，才能取到正确的值。</p>
<h3 id="Pros-1"><a href="#Pros-1" class="headerlink" title="Pros"></a>Pros</h3><ul>
<li>交换变量的值</li>
<li>从函数返回多个值</li>
<li><p>遍历Map结构<br>配合变量的解构赋值，获取键名和键值</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> [key, value] <span class="keyword">of</span> map) &#123;</div><div class="line">  <span class="built_in">console</span>.log(key + <span class="string">" is "</span> + value);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>输入模块的指定方法</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> &#123; SourceMapConsumer, SourceNode &#125; = <span class="built_in">require</span>(<span class="string">"source-map"</span>);</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="Arrow-Function"><a href="#Arrow-Function" class="headerlink" title="Arrow Function"></a>Arrow Function</h2><ul>
<li>语法糖：function的简写，或者是使用胖箭头 () =&gt; 的Lamda表达式。</li>
<li>不仅仅是语法糖：自动绑定外部作用域的”this”.</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> items = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>];</div><div class="line"></div><div class="line"><span class="keyword">var</span> double = (x) =&gt; x * <span class="number">2</span>;</div><div class="line"><span class="keyword">var</span> byTwo = items.map(double);</div><div class="line"><span class="comment">// =&gt; [2, 4, 6, 8]</span></div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> foot = &#123;</div><div class="line">    kickNormal: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">      <span class="keyword">this</span>.yelp = <span class="string">"Ouch!"</span>;</div><div class="line">      setImmediate(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.yelp);</div><div class="line">      &#125;.bind(<span class="keyword">this</span>));</div><div class="line">    &#125;,</div><div class="line">    kick: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="keyword">this</span>.yelp = <span class="string">"Ouch!"</span>;</div><div class="line">        setImmediate(() =&gt; <span class="built_in">console</span>.log(<span class="keyword">this</span>.yelp));</div><div class="line">    &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h2 id="default-function-params"><a href="#default-function-params" class="headerlink" title="default function params"></a>default function params</h2><p>在ES6默认值特性出现前，手动处理默认值有几种方式：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">log</span>(<span class="params">message, level</span>) </span>&#123;</div><div class="line">  level = level || <span class="string">'warning'</span>;</div><div class="line">  <span class="built_in">console</span>.log(level, <span class="string">': '</span>, message);</div><div class="line">&#125;</div><div class="line"></div><div class="line">log(<span class="string">'low memory'</span>); <span class="comment">// warning: low memory</span></div><div class="line">log(<span class="string">'out of memory'</span>, <span class="string">'error'</span>); <span class="comment">// error: out of memory</span></div></pre></td></tr></table></figure>
<p>为了处理参数未传递的情况，我们常看到typeof检测:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (<span class="keyword">typeof</span> level == <span class="string">'undefined'</span>) &#123;</div><div class="line">  level = <span class="string">'warning'</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>有时也可以检查arguments.length</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (<span class="built_in">arguments</span>.length == <span class="number">1</span>) &#123;</div><div class="line">  level = <span class="string">'warning'</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这些方法都可以很好的工作，但都过于手动且缺少抽象。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">log</span>(<span class="params">message, level = 'warning'</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(level, <span class="string">': '</span>, message);</div><div class="line">&#125;</div><div class="line"></div><div class="line">log(<span class="string">'low memory'</span>); <span class="comment">// warning: low memory</span></div><div class="line">log(<span class="string">'out of memory'</span>, <span class="string">'error'</span>); <span class="comment">// error: out of memory</span></div></pre></td></tr></table></figure>
<p>参数默认值使用方便且毫无违和感。</p>
<h2 id="Classes"><a href="#Classes" class="headerlink" title="Classes"></a>Classes</h2><p>A formal inheritance syntax comes to JavaScript<br>Really just syntactical sugar over JS prototypical inheritance</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Greeter</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>(msg) &#123;</div><div class="line">    <span class="keyword">this</span>.msg = msg;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">static</span> create(msg) &#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="keyword">this</span>(msg);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  greet() &#123;</div><div class="line">    <span class="keyword">return</span> <span class="string">`Hello <span class="subst">$&#123;this.msg&#125;</span>`</span>;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  set message(msg) &#123;</div><div class="line">    <span class="keyword">this</span>.msg = msg;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  get message() &#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.msg;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> _createClass = (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="function"><span class="keyword">function</span> <span class="title">defineProperties</span>(<span class="params">target, props</span>) </span>&#123; <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; props.length; i++) &#123; <span class="keyword">var</span> descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || <span class="literal">false</span>; descriptor.configurable = <span class="literal">true</span>; <span class="keyword">if</span> (<span class="string">'value'</span> <span class="keyword">in</span> descriptor) descriptor.writable = <span class="literal">true</span>; <span class="built_in">Object</span>.defineProperty(target, descriptor.key, descriptor); &#125; &#125; <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">Constructor, protoProps, staticProps</span>) </span>&#123; <span class="keyword">if</span> (protoProps) defineProperties(Constructor.prototype, protoProps); <span class="keyword">if</span> (staticProps) defineProperties(Constructor, staticProps); <span class="keyword">return</span> Constructor; &#125;; &#125;)();</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">_classCallCheck</span>(<span class="params">instance, Constructor</span>) </span>&#123; <span class="keyword">if</span> (!(instance <span class="keyword">instanceof</span> Constructor)) &#123; <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">'Cannot call a class as a function'</span>); &#125; &#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> Greeter = (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">Greeter</span>(<span class="params">msg</span>) </span>&#123;</div><div class="line">    _classCallCheck(<span class="keyword">this</span>, Greeter);</div><div class="line"></div><div class="line">    <span class="keyword">this</span>.msg = msg;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  Greeter.create = <span class="function"><span class="keyword">function</span> <span class="title">create</span>(<span class="params">msg</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="keyword">this</span>(msg);</div><div class="line">  &#125;;</div><div class="line"></div><div class="line">  Greeter.prototype.greet = <span class="function"><span class="keyword">function</span> <span class="title">greet</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="string">'Hello '</span> + <span class="keyword">this</span>.msg;</div><div class="line">  &#125;;</div><div class="line"></div><div class="line">  _createClass(Greeter, [&#123;</div><div class="line">    key: <span class="string">'message'</span>,</div><div class="line">    set: <span class="function"><span class="keyword">function</span> (<span class="params">msg</span>) </span>&#123;</div><div class="line">      <span class="keyword">this</span>.msg = msg;</div><div class="line">    &#125;,</div><div class="line">    get: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">      <span class="keyword">return</span> <span class="keyword">this</span>.msg;</div><div class="line">    &#125;</div><div class="line">  &#125;]);</div><div class="line"></div><div class="line">  <span class="keyword">return</span> Greeter;</div><div class="line">&#125;)();</div></pre></td></tr></table></figure>
<h3 id="Extends"><a href="#Extends" class="headerlink" title="Extends"></a>Extends</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">FancyGreeter</span> <span class="keyword">extends</span> <span class="title">Greeter</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>(msg, name) &#123;</div><div class="line">    <span class="keyword">super</span>(msg);</div><div class="line">    <span class="keyword">this</span>.name = name;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  greet () &#123;</div><div class="line">    <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;this.name&#125;</span>, Hello <span class="subst">$&#123;this.msg&#125;</span>`</span>;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> fg = <span class="keyword">new</span> FancyGreeter(<span class="string">'World'</span>, <span class="string">'Song'</span>);</div><div class="line"><span class="built_in">console</span>.log(fg <span class="keyword">instanceof</span> FancyGreeter);</div><div class="line"><span class="built_in">console</span>.log(fg <span class="keyword">instanceof</span> Greeter);</div></pre></td></tr></table></figure>
<h2 id="Module"><a href="#Module" class="headerlink" title="Module"></a>Module</h2><h3 id="export和import"><a href="#export和import" class="headerlink" title="export和import"></a>export和import</h3><p>ES6实现了模块功能，试图解决JavaScript代码的依赖和部署上的问题，取代现有的CommonJS和AMD规范，成为浏览器和服务器通用的模块解决方案。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;&#125;</div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> first = <span class="string">'David'</span>;</div><div class="line"><span class="keyword">var</span> last = <span class="string">'Belle'</span>;</div><div class="line"><span class="keyword">var</span> year = <span class="number">1973</span>;</div><div class="line"></div><div class="line"><span class="keyword">export</span> &#123;first, last, year&#125;;</div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123;first, last, year&#125; <span class="keyword">from</span> <span class="string">'./profile'</span>;</div><div class="line"><span class="keyword">import</span> &#123;first <span class="keyword">as</span> f, last&#125; <span class="keyword">from</span> <span class="string">'./profile'</span>;</div><div class="line"><span class="keyword">import</span> * <span class="keyword">as</span> profile <span class="keyword">from</span> <span class="string">'./profile'</span>;</div></pre></td></tr></table></figure>
<h2 id="NOT-Included"><a href="#NOT-Included" class="headerlink" title="NOT Included"></a>NOT Included</h2><ul>
<li>Map, WeakMap, Set, WeakSet</li>
<li>Promise</li>
<li>Generator</li>
<li>Iterator</li>
<li>Rest Parameter</li>
<li>Spread Operator</li>
</ul>
<h3 id="新的内建方法"><a href="#新的内建方法" class="headerlink" title="新的内建方法"></a>新的内建方法</h3><ul>
<li>Object.assign</li>
<li>[arr].find</li>
<li>“str”.repeat</li>
<li>“str”.startsWith</li>
<li>“str”.endsWith</li>
<li>“str”.includes</li>
<li>Number.isNaN</li>
<li>Number.isFinite</li>
<li>Number.isSafeInteger</li>
<li>Math.trunc</li>
<li>Math.sign</li>
</ul>
<h2 id="Using-ES6-Today"><a href="#Using-ES6-Today" class="headerlink" title="Using ES6 Today"></a>Using ES6 Today</h2><h3 id="Server"><a href="#Server" class="headerlink" title="Server"></a>Server</h3><ul>
<li>io 2.2.0</li>
<li>node 0.12.4</li>
</ul>
<h3 id="Browser"><a href="#Browser" class="headerlink" title="Browser"></a>Browser</h3><ul>
<li>Browserify</li>
<li>Babel</li>
</ul>
<h2 id="Resources"><a href="#Resources" class="headerlink" title="Resources"></a>Resources</h2><ul>
<li><a href="http://es6-features.org/" target="_blank" rel="external">ECMAScript 6 — New Features</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Slides in ES6 overview workshop&lt;/p&gt;
&lt;h2 id=&quot;Intro&quot;&gt;&lt;a href=&quot;#Intro&quot; class=&quot;headerlink&quot; title=&quot;Intro&quot;&gt;&lt;/a&gt;Intro&lt;/h2&gt;&lt;h3 id=&quot;What&quot;&gt;&lt;a href=
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>两分钟了解ReactiveX</title>
    <link href="http://owenyang0.github.io/2015/05/08/2-minute-introduction-to-Rx/"/>
    <id>http://owenyang0.github.io/2015/05/08/2-minute-introduction-to-Rx/</id>
    <published>2015-05-08T03:59:09.000Z</published>
    <updated>2016-08-15T09:00:19.000Z</updated>
    
    <content type="html"><![CDATA[<p>可能在之前，你就已经看过这篇<a href="https://gist.github.com/staltz/868e7e9bc2a7b8c1f754" target="_blank" rel="external">响应式编程的入门</a>。什么？太长？好吧，这都没关系，<a href="https://github.com/Reactive-Extensions/RxJS" target="_blank" rel="external">Rx</a>并不难，你甚至可以自己实现一个这样的框架。<br>知道数组吧？你当然知道，这就是：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[ 14, 9, 5, 2, 10, 13, 4 ]</div></pre></td></tr></table></figure></p>
<p>如果说这是一个<strong>非可变数组</strong>，但需要移除所有的奇数，你会怎样做呢？可能会是这样：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">[ <span class="number">14</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">10</span>, <span class="number">13</span>, <span class="number">4</span> ]</div><div class="line"></div><div class="line">filter( (x) -&gt; x % <span class="number">2</span> == <span class="number">0</span> )</div><div class="line"><span class="comment">// =&gt; [ 14, 2, 10, 4 ]</span></div></pre></td></tr></table></figure>
<p>直到现在也没什么新鲜东西，这在<code>underscore.js</code>, <code>ECMAScript 5.1</code>, <code>LINQ</code>, <code>Guava</code>, 等等之中，早已司空见惯。这些都是来自于函数式的编程范型。</p>
<hr>
<p>再来想想带来坐标位置数据的点击事件。如果画一条时间线，它们看起来应该是这样。<br><img src="/images/click-events.png" alt="click events line"></p>
<p>是的，这是一个事件流，它有一妮称，叫 “Observable”。</p>
<p>这些点击事件，都来自于鼠标，意味着整个事件流都是<strong>不可变的</strong>。事件被触发后，我们没有办法对事件进行添加或删除。<br>但我如果只是关心<code>x &lt; 250</code>的事件呢？能不能创建一个像数组一样的新的流，再对其进行过滤呢？<br><img src="/images/click-events.png" alt="click events line"></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">filter( (event) -&gt; event.x &lt; <span class="number">250</span> )</div></pre></td></tr></table></figure>
<p><img src="/images/click-events-filtered.png" alt="click events filted line"></p>
<p>非可变数组和Observables有什么区别呢？其实不多，两个都可以使用<code>map</code>, <code>filter</code>, <code>reduce</code>等高阶函数。在Observables中，你也可以使用<code>merge</code>, <code>delay</code>, <code>concat</code>, <code>buffer</code>, <code>distinct</code>, <code>first</code>, <code>last</code>, <code>zip</code>, <code>startWith</code>, <code>window</code>, <code>takeUntil</code>, <code>skip</code>, <code>scan</code>, <code>sample</code>, <code>amb</code>, <code>n</code>, <code>flatMap</code>等函数。</p>
<p><strong>想像一下异步的非可变数组</strong><br><code>Rx</code>可以说是操作事件的<code>underscore.js</code>。但，等一下，什么是事件？在你的程序中，难道不是绝大多数代码都是事件吗？<br>程序启动事件，API响应事件，键盘事件，设备休眠事件等等。</p>
<p>基本上，所有东西都可以是事件流。所需要的只是要适当地进行排列组合。</p>
<p>这就是<code>Rx</code>的两分钟。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;可能在之前，你就已经看过这篇&lt;a href=&quot;https://gist.github.com/staltz/868e7e9bc2a7b8c1f754&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;响应式编程的入门&lt;/a&gt;。什么？太长？好吧，这都没关系，&lt;a
    
    </summary>
    
    
      <category term="Rx" scheme="http://owenyang0.github.io/tags/Rx/"/>
    
      <category term="RxJS" scheme="http://owenyang0.github.io/tags/RxJS/"/>
    
      <category term="Reactive Programming" scheme="http://owenyang0.github.io/tags/Reactive-Programming/"/>
    
  </entry>
  
  <entry>
    <title>Functional Programming in JavaScript</title>
    <link href="http://owenyang0.github.io/2015/04/12/functional-programming-in-javascript/"/>
    <id>http://owenyang0.github.io/2015/04/12/functional-programming-in-javascript/</id>
    <published>2015-04-11T16:09:44.000Z</published>
    <updated>2016-08-15T09:00:19.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Agenda"><a href="#Agenda" class="headerlink" title="Agenda"></a>Agenda</h2><ul>
<li>What is Functional Programming?</li>
<li>How Functional Programming Differs From Other Paradigms</li>
<li>Functional Programming in Javascript</li>
<li>Advantages and Disadvantages of Functional Style</li>
<li>Interaction of Functional and Object-Oriented Styles</li>
</ul>
<hr>
<h2 id="What-is-Functional-Programming"><a href="#What-is-Functional-Programming" class="headerlink" title="What is Functional Programming?"></a>What is Functional Programming?</h2><ul>
<li><strong>Restricted sense,</strong> FP means programming without mutable variables, assignments, loops and other imperative control structures</li>
<li><strong>Wider sense,</strong> FP means focusing on the functions</li>
<li><strong>Particularly,</strong> functions can be values that are produced, consumed, and composed.</li>
</ul>
<hr>
<h2 id="Functional-Programming-Languages"><a href="#Functional-Programming-Languages" class="headerlink" title="Functional Programming Languages"></a>Functional Programming Languages</h2><p>Functions in a FP languages are first-class citizens. This means:</p>
<ul>
<li>they can be defined anywhere, including inside other function</li>
<li>like any other values, they can be passed as parameters to functions and returned as results</li>
<li>as for other values, there exist a set of operators to compose functions</li>
</ul>
<hr>
<h2 id="Some-languages"><a href="#Some-languages" class="headerlink" title="Some languages"></a>Some languages</h2><p><strong>Restricted sense:</strong></p>
<ul>
<li>Pure Lisp, XSLT, XPath, XQuery, FP</li>
</ul>
<p><strong>Wider sense:</strong></p>
<ul>
<li>JavaScript</li>
<li>Lisp, Scheme, Racket, Clojure</li>
<li>SML, F#</li>
<li>Haskell (full language)</li>
<li>Scala</li>
</ul>
<hr>
<h2 id="OOP-vs-FP"><a href="#OOP-vs-FP" class="headerlink" title="OOP vs FP"></a>OOP vs FP</h2><p>OO focuses on the differences in the data, while FP concentrates on consistent data structures.</p>
<hr>
<h3 id="Object-Oriented"><a href="#Object-Oriented" class="headerlink" title="Object-Oriented"></a>Object-Oriented</h3><ul>
<li>Data and the operations upon it are tightly coupled</li>
<li>Objects hide their implementation of operations from other objects via their interfaces</li>
<li>The central model for abstraction is the data itself</li>
<li>The central activity is composing new objects and extending existing objects by adding new methods to them</li>
</ul>
<hr>
<h3 id="Functional"><a href="#Functional" class="headerlink" title="Functional"></a>Functional</h3><ul>
<li>Data is only loosely coupled to functions</li>
<li>Functions hide their implementation, and the language’s abstractions speak to functions and the way they are combined or expressed</li>
<li>The central model for abstraction is the function, not the data structure.<br>The central activity is writing new functions</li>
</ul>
<hr>
<h2 id="Declarative-vs-Imperative"><a href="#Declarative-vs-Imperative" class="headerlink" title="Declarative vs Imperative"></a>Declarative vs Imperative</h2><p>One main distinguishing characteristics of functional programming languages is that they describe what they want done, and not how to do it. OO, inside its methods, still uses mostly imperative techniques.</p>
<hr>
<h3 id="Imperative-programming-is-about"><a href="#Imperative-programming-is-about" class="headerlink" title="Imperative programming is about"></a>Imperative programming is about</h3><ul>
<li>modifying mutable variables</li>
<li>using assignment</li>
<li>and control structures such as if-then-else, loops, break, continue, return.</li>
</ul>
<hr>
<p>The most common informal way to understand imperative programs is as instruction sequences for a Von Neumann computer</p>
<p>Processor &lt;—- bus —-&gt; Memory</p>
<hr>
<h3 id="Declarative-programming-is-about"><a href="#Declarative-programming-is-about" class="headerlink" title="Declarative programming is about"></a>Declarative programming is about</h3><ul>
<li>concentrate on functions</li>
<li>avoid mutations (mutation can bestroy useful laws)</li>
<li>have powerful ways to abstract and compose functions</li>
</ul>
<hr>
<h3 id="Imperative-style"><a href="#Imperative-style" class="headerlink" title="Imperative style"></a>Imperative style</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">var sumOfSquares = function(list) &#123;</div><div class="line">    var result = 0;</div><div class="line">    for (var i = 0; i &lt; list.length; i++) &#123;</div><div class="line">        result += square(list[i]);</div><div class="line">    &#125;</div><div class="line">    return result;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">console.log(sumOfSquares([2, 3, 5]));</div></pre></td></tr></table></figure>
<h3 id="Functional-style"><a href="#Functional-style" class="headerlink" title="Functional style"></a>Functional style</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> sumOfSquares = pipe(map(square), reduce(add, <span class="number">0</span>));</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(sumOfSquares([<span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>]));</div></pre></td></tr></table></figure>
<hr>
<h2 id="Functional-Features-in-JavaScript"><a href="#Functional-Features-in-JavaScript" class="headerlink" title="Functional Features in JavaScript"></a>Functional Features in JavaScript</h2><h3 id="Easily-available-in-Javascript"><a href="#Easily-available-in-Javascript" class="headerlink" title="Easily available in Javascript"></a>Easily available in Javascript</h3><ul>
<li>First-class functions</li>
<li>Lambdas/Anonymous Functions with closures</li>
<li>Compact, even terse, functions</li>
</ul>
<h3 id="Possible-to-accomplish-in-JavaScript"><a href="#Possible-to-accomplish-in-JavaScript" class="headerlink" title="Possible to accomplish in JavaScript"></a>Possible to accomplish in JavaScript</h3><ul>
<li>Mostly stateless processing</li>
<li>Side-effect-free functions calls</li>
</ul>
<hr>
<h3 id="Not-available-in-JavaScript"><a href="#Not-available-in-JavaScript" class="headerlink" title="Not available in JavaScript"></a>Not available in JavaScript</h3><ul>
<li>Performant recursion through tail call optimization</li>
<li>Pattern matching (Haskell, Erlang)</li>
<li>Lazy Evaluation (Miranda, Haskell)</li>
<li>Homoiconicity (mostly LISP-like languages?)</li>
</ul>
<hr>
<h3 id="Shared-examples"><a href="#Shared-examples" class="headerlink" title="Shared examples"></a>Shared examples</h3><p>This calculates the odds of choosing the correct <code>n</code> numbers out of the <code>p</code> possibilities.</p>
<h3 id="iterative-version"><a href="#iterative-version" class="headerlink" title="iterative version"></a>iterative version</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">odds</span>(<span class="params">n, p</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> acc = <span class="number">1</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</div><div class="line">        acc *= (n - i) / (p - i);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> acc;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(odds(<span class="number">3</span>, <span class="number">10</span>)); <span class="comment">//=&gt; (3/10) * (2/9) * (1/8) =&gt; (1/120) =&gt; 0.008333...</span></div></pre></td></tr></table></figure>
<hr>
<h3 id="Recursive-version"><a href="#Recursive-version" class="headerlink" title="Recursive version"></a>Recursive version</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Recursive version</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">odds</span>(<span class="params">n, p</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> (n == <span class="number">0</span>) ? <span class="number">1</span> : (n / p) * odds(n - <span class="number">1</span>, p - <span class="number">1</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(odds(<span class="number">3</span>, <span class="number">10</span>)); <span class="comment">//=&gt; (3/10) * (2/9) * (1/8) =&gt; (1/120) =&gt; 0.008333...</span></div></pre></td></tr></table></figure>
<ul>
<li>recursive functions are often much more elegant than their iterative cousins.</li>
<li>Unfortunately, they often don’t perform as well. All the overhead of creating stack contexts for function calls tends to add up. But certain kinds of recursive calls can be easily optimized.</li>
</ul>
<hr>
<h3 id="tail-recursive"><a href="#tail-recursive" class="headerlink" title="tail recursive"></a>tail recursive</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">var odds = (function()&#123;</div><div class="line">    var odds1 = function(n, p, acc) &#123;</div><div class="line">        return (n == 0) ? acc : odds1(n - 1, p - 1, (n / p) * acc);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    return function(n, p) &#123;</div><div class="line">        return odds1(n, p, 1)</div><div class="line">    &#125;</div><div class="line">&#125;)();</div></pre></td></tr></table></figure>
<p>Note that the recursive call in <strong>odds1</strong> is the last statement in its branch of the function. If this is true for all recursive calls, then the function is <strong>tail-recursive</strong>, and the compiler can replace the entire set of nested calls with simple <strong>JUMP</strong> operations.</p>
<hr>
<h2 id="Functional-Programming-in-Javascript"><a href="#Functional-Programming-in-Javascript" class="headerlink" title="Functional Programming in Javascript"></a>Functional Programming in Javascript</h2><p>With first-class function, closures, and anonymous functions, Javascript allows us to do a great deal of functional programming, even if we don’t have things like pattern matching and homoiconicity.</p>
<p>There are some tools built in to modern Javascript environments, and it’s straightforward to roll your own.</p>
<ul>
<li>Ramda</li>
<li>Underscore, Lo-Dash</li>
</ul>
<hr>
<h2 id="Using-Functional-Techniques-in-JavaScript"><a href="#Using-Functional-Techniques-in-JavaScript" class="headerlink" title="Using Functional Techniques in JavaScript"></a>Using Functional Techniques in JavaScript</h2><p>Example will be a Task List application, fetching something like the following data from the server:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> data = &#123;</div><div class="line">    result: <span class="string">"SUCCESS"</span>,</div><div class="line">    interfaceVersion: <span class="string">"1.0.3"</span>,</div><div class="line">    requested: <span class="string">"10/17/2013 15:31:20"</span>.</div><div class="line">    lastUpdated: <span class="string">"10/16/2013 10:52:39"</span>,</div><div class="line">    tasks: [</div><div class="line">        &#123;id: <span class="number">104</span>, complete: <span class="literal">false</span>,            priority: <span class="string">"high"</span>,</div><div class="line">                  dueDate: <span class="string">"11/29/2013"</span>,      member: <span class="string">"Scott"</span>,</div><div class="line">                  title: <span class="string">"Do something"</span>,      created: <span class="string">"9/22/2013"</span>&#125;,</div><div class="line">        &#123;id: <span class="number">105</span>, complete: <span class="literal">false</span>,            priority: <span class="string">"medium"</span>,</div><div class="line">                  dueDate: <span class="string">"11/22/2013"</span>,      member: <span class="string">"Lena"</span>,</div><div class="line">                  title: <span class="string">"Do something else"</span>, created: <span class="string">"9/22/2013"</span>&#125;,</div><div class="line">        &#123;id: <span class="number">107</span>, complete: <span class="literal">true</span>,             priority: <span class="string">"high"</span>,</div><div class="line">                  dueDate: <span class="string">"11/22/2013"</span>,      member: <span class="string">"Mike"</span>,</div><div class="line">                  title: <span class="string">"Fix the foo"</span>,       created: <span class="string">"9/22/2013"</span>&#125;,</div><div class="line">        &#123;id: <span class="number">108</span>, complete: <span class="literal">false</span>,            priority: <span class="string">"low"</span>,</div><div class="line">                  dueDate: <span class="string">"11/15/2013"</span>,      member: <span class="string">"Punam"</span>,</div><div class="line">                  title: <span class="string">"Adjust the bar"</span>,    created: <span class="string">"9/25/2013"</span>&#125;,</div><div class="line">        &#123;id: <span class="number">110</span>, complete: <span class="literal">false</span>,            priority: <span class="string">"medium"</span>,</div><div class="line">                  dueDate: <span class="string">"11/15/2013"</span>,      member: <span class="string">"Scott"</span>,</div><div class="line">                  title: <span class="string">"Rename everything"</span>, created: <span class="string">"10/2/2013"</span>&#125;,</div><div class="line">        &#123;id: <span class="number">112</span>, complete: <span class="literal">true</span>,             priority: <span class="string">"high"</span>,</div><div class="line">                  dueDate: <span class="string">"11/27/2013"</span>,      member: <span class="string">"Lena"</span>,</div><div class="line">                  title: <span class="string">"Alter all quuxes"</span>,  created: <span class="string">"10/5/2013"</span>&#125;</div><div class="line">        <span class="comment">// , ...</span></div><div class="line">    ]</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<hr>
<h2 id="Goal"><a href="#Goal" class="headerlink" title="Goal"></a>Goal</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">tasks: [</div><div class="line">        &#123;id: 104, complete: false,            priority: &quot;high&quot;,</div><div class="line">                  dueDate: &quot;11/29/2013&quot;,      member: &quot;Scott&quot;,</div><div class="line">                  title: &quot;Do something&quot;,      created: &quot;9/22/2013&quot;&#125;,</div><div class="line">        &#123;id: 105, complete: false,            priority: &quot;medium&quot;,</div><div class="line">                  dueDate: &quot;11/22/2013&quot;,      member: &quot;Lena&quot;,</div><div class="line">                  title: &quot;Do something else&quot;, created: &quot;9/22/2013&quot;&#125;,</div><div class="line">    // , ...</div><div class="line">]</div></pre></td></tr></table></figure>
<p>The goal will be a function that accepts a <code>member</code> parameter, then fetches the data from the server (or from some application cache), chooses the tasks for that member that are not complete, returns their ids, priorities, titles, and dues dates, sorted by due date.</p>
<ul>
<li>asynchronous, we’ll hook everything together with promises.</li>
<li>ignore all error-checking</li>
</ul>
<hr>
<h2 id="Imperative-Approach"><a href="#Imperative-Approach" class="headerlink" title="Imperative Approach"></a>Imperative Approach</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> getIncompleteTaskSummariesForMember_imperative = <span class="function"><span class="keyword">function</span>(<span class="params">memberName</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> fetchData()</div><div class="line">        .then(<span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</div><div class="line">            <span class="keyword">return</span> data.tasks;</div><div class="line">        &#125;)</div><div class="line">        .then(<span class="function"><span class="keyword">function</span>(<span class="params">tasks</span>) </span>&#123;</div><div class="line">            <span class="keyword">var</span> results = [];</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, len = tasks.length; i &lt; len; i++) &#123;</div><div class="line">                <span class="keyword">if</span> (tasks[i].member == memberName) &#123;</div><div class="line">                    results.push(tasks[i]);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">return</span> results;</div><div class="line">        &#125;)</div><div class="line">        .then(<span class="function"><span class="keyword">function</span>(<span class="params">tasks</span>) </span>&#123;</div><div class="line">            <span class="keyword">var</span> results = [];</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, len = tasks.length; i &lt; len; i++) &#123;</div><div class="line">                <span class="keyword">if</span> (!tasks[i].complete) &#123;</div><div class="line">                    results.push(tasks[i]);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">return</span> results;</div><div class="line">        &#125;)</div><div class="line">        .then(<span class="function"><span class="keyword">function</span>(<span class="params">tasks</span>) </span>&#123;</div><div class="line">            <span class="keyword">var</span> results = [], task;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, len = tasks.length; i &lt; len; i++) &#123;</div><div class="line">                task = tasks[i];</div><div class="line">                results.push(&#123;</div><div class="line">                    id: task.id,</div><div class="line">                    dueDate: task.dueDate,</div><div class="line">                    title: task.title,</div><div class="line">                    priority: task.priority</div><div class="line">                &#125;)</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">return</span> results;</div><div class="line">        &#125;)</div><div class="line">        .then(<span class="function"><span class="keyword">function</span>(<span class="params">tasks</span>) </span>&#123;</div><div class="line">            tasks.sort(<span class="function"><span class="keyword">function</span>(<span class="params">first, second</span>) </span>&#123;</div><div class="line">                <span class="keyword">return</span> first.dueDate - second.dueDate;</div><div class="line">            &#125;);</div><div class="line">            <span class="keyword">return</span> tasks;</div><div class="line">        &#125;);</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<hr>
<h2 id="Object-Oriented-Approach"><a href="#Object-Oriented-Approach" class="headerlink" title="Object-Oriented Approach"></a>Object-Oriented Approach</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// main method</span></div><div class="line"><span class="keyword">var</span> getIncompleteTaskSummariesForMember_objectOriented = <span class="function"><span class="keyword">function</span>(<span class="params">memberName</span>) </span>&#123;</div><div class="line">   <span class="keyword">return</span> fetchData()</div><div class="line">       .then(<span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</div><div class="line">           <span class="keyword">var</span> taskList = <span class="keyword">new</span> TaskList(data.tasks);</div><div class="line">           taskList.chooseByMember(memberName);</div><div class="line">           taskList.chooseByCompletion(<span class="literal">false</span>);</div><div class="line">           <span class="keyword">var</span> newTaskList = taskList.getSummaries();</div><div class="line">           newTaskList.sort(<span class="keyword">new</span> TaskListSorter(<span class="string">"dueDate"</span>));</div><div class="line">           <span class="keyword">return</span> newTaskList.tasks;</div><div class="line">       &#125;);</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<hr>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line">var TaskList = (function() &#123;</div><div class="line">    var TaskList = function(/*Task[]*/ tasks) &#123;</div><div class="line">        this.tasks = tasks;</div><div class="line">    &#125;;</div><div class="line">    TaskList.prototype.chooseByMember = function(memberName) &#123;</div><div class="line">        var results = [];</div><div class="line">        for (var i = 0, len = this.tasks.length; i &lt; len; i++) &#123;</div><div class="line">            if (this.tasks[i].member === memberName) &#123;</div><div class="line">                results.push(this.tasks[i]);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        this.tasks = results;</div><div class="line">    &#125;;</div><div class="line">    TaskList.prototype.chooseByCompletion = function(completion) &#123;</div><div class="line">        var results = [];</div><div class="line">        for (var i = 0, len = this.tasks.length; i &lt; len; i++) &#123;</div><div class="line">            if (this.tasks[i].complete == completion) &#123;</div><div class="line">                results.push(this.tasks[i]);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        this.tasks = results;</div><div class="line">    &#125;;</div><div class="line">    TaskList.prototype.getSummaries = function() &#123;</div><div class="line">            var results = [], task;</div><div class="line">            for (var i = 0, len = this.tasks.length; i &lt; len; i++) &#123;</div><div class="line">                task = this.tasks[i];</div><div class="line">                results.push(&#123;</div><div class="line">                    id: task.id,</div><div class="line">                    dueDate: task.dueDate,</div><div class="line">                    title: task.title,</div><div class="line">                    priority: task.priority</div><div class="line">                &#125;)</div><div class="line">            &#125;</div><div class="line">            return new TaskList(results);</div><div class="line">        &#125;;</div><div class="line"></div><div class="line">        TaskList.prototype.sort = function(/*TaskListSorter*/ sorter) &#123;</div><div class="line">            this.tasks.sort(sorter.getSortFunction());</div><div class="line">        &#125;;</div><div class="line"></div><div class="line">        return TaskList;</div><div class="line">    &#125;());</div></pre></td></tr></table></figure>
<hr>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">var TaskListSorter = (function()  &#123;</div><div class="line">    var TaskListSorter = function(propName) &#123;</div><div class="line">        this.propName = propName;</div><div class="line">    &#125;;</div><div class="line">    TaskListSorter.prototype.getSortFunction = function() &#123;</div><div class="line">        var propName = this.propName;</div><div class="line">        return function(first, second) &#123;</div><div class="line">            return first[propName] &lt; second[propName] ? -1 :</div><div class="line">                   first[propName] &gt; second[propName] ? +1 : 0;</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    return TaskListSorter;</div><div class="line">&#125;());</div></pre></td></tr></table></figure>
<p>The contents of the functions are much the same; it’s the way they are organized that varies.</p>
<hr>
<h2 id="Converting-to-Functional-Code"><a href="#Converting-to-Functional-Code" class="headerlink" title="Converting to Functional Code"></a>Converting to Functional Code</h2><p>The process for the remainder of this talk will be to convert this code into concise, readable, functional code, one block at a time, explaining some of the basic building blocks of functional programming as we go. First up is this little function:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">.then(<span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> data.tasks;</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<p>Functional version<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">.then(prop(<span class="string">'tasks'</span>))</div></pre></td></tr></table></figure></p>
<p>So the obvious question, then, is, what is the <strong>prop</strong> function?</p>
<hr>
<h2 id="The-prop-function"><a href="#The-prop-function" class="headerlink" title="The prop function"></a>The prop function</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">module</span>.exports = _curry2(<span class="function"><span class="keyword">function</span> <span class="title">prop</span>(<span class="params">p, obj</span>) </span>&#123; <span class="keyword">return</span> obj[p]; &#125;);</div></pre></td></tr></table></figure>
<p>Our <strong>then</strong> call needs a function, so <strong>curry</strong> must be doing something interesting with this function, which should return an object propery, to instead returning a new function. So we need to take a detour to discuss <strong>curry</strong> a bit.</p>
<hr>
<h2 id="Currying-Functions"><a href="#Currying-Functions" class="headerlink" title="Currying Functions"></a>Currying Functions</h2><p>Currying is the process of converting functions that take multiple arguments into ones that, when supplied fewer arguments, return new functions that accept the remaining ones.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> addFourNumbers = <span class="function"><span class="keyword">function</span>(<span class="params">a, b, c, d</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> a + b + c + d;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> curriedAddFourNumbers = R.curry(addFourNumbers);</div><div class="line"><span class="keyword">var</span> f = curriedAddFourNumbers(<span class="number">1</span>, <span class="number">2</span>);</div><div class="line"><span class="keyword">var</span> g = f(<span class="number">3</span>);</div><div class="line">g(<span class="number">4</span>); <span class="comment">//=&gt; 10</span></div></pre></td></tr></table></figure>
<hr>
<h2 id="Back-to-get"><a href="#Back-to-get" class="headerlink" title="Back to get"></a>Back to get</h2><p>Now that we understand curry, we can see that a manually curried version of this function might look like this:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> prop = <span class="function"><span class="keyword">function</span>(<span class="params">prop</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">obj</span>) </span>&#123;</div><div class="line">        <span class="keyword">return</span> obj[prop];</div><div class="line">    &#125;;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>And that means that our new <strong>get(‘tasks’)</strong> is equivalent to<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span>(<span class="params">obj</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> obj[<span class="string">'tasks'</span>];</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<hr>
<h2 id="Filtering"><a href="#Filtering" class="headerlink" title="Filtering"></a>Filtering</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">.then(<span class="function"><span class="keyword">function</span>(<span class="params">tasks</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> results = [];</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, len = tasks.length; i &lt; len; i++) &#123;</div><div class="line">        <span class="keyword">if</span> (tasks[i].member == memberName) &#123;</div><div class="line">            results.push(tasks[i]);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> results;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<hr>
<p>Functional version<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">.then(filter(<span class="function"><span class="keyword">function</span>(<span class="params">task</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> task.member == memberName;</div><div class="line">&#125;))</div></pre></td></tr></table></figure></p>
<p>But we’ve done something more important too: We’ve moved the focus from iteration and updating the state of a local collection to the real point of this block: choosing the tasks with the proper member property.</p>
<p>One of the most important features of functional programming is that it makes it easy to shift focus in this manner.</p>
<hr>
<h2 id="Rejecting-elements"><a href="#Rejecting-elements" class="headerlink" title="Rejecting elements"></a>Rejecting elements</h2><p>The next block is similar, except that instead of using filter, we will use reject, which behaves exactly the same except that it chooses those members of the list that don’t match the predicate. We replace this code:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">.then(<span class="function"><span class="keyword">function</span>(<span class="params">tasks</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> results = [];</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, len = tasks.length; i &lt; len; i++) &#123;</div><div class="line">        <span class="keyword">if</span> (!tasks[i].complete) &#123;</div><div class="line">            results.push(tasks[i]);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> results;</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<p>with this:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">.then(reject(<span class="function"><span class="keyword">function</span>(<span class="params">task</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> task.complete === <span class="literal">true</span>;</div><div class="line">)))</div></pre></td></tr></table></figure>
<hr>
<h2 id="Refactoring"><a href="#Refactoring" class="headerlink" title="Refactoring"></a>Refactoring</h2><p>A reasonable question would be why with didn’t do this instead, which would work equally well:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">.then(filter(function(task) &#123;</div><div class="line">    return task.complete !== true;</div><div class="line">))</div></pre></td></tr></table></figure>
<p>The reason is that the similarity between these two blocks will offer us a chance to refactor our code into something still more descriptive:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">function(task) &#123;</div><div class="line">    return task.member == memberName;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">function(task) &#123;</div><div class="line">    return task.complete === true;</div><div class="line">)</div></pre></td></tr></table></figure>
<p>Both of these functions accept an object and return a boolean that describes whether a particular property of the object has a given value. Perhaps a good name for a function that generates such functions would be <strong>propEq</strong>.</p>
<hr>
<h2 id="Implementing-propEq"><a href="#Implementing-propEq" class="headerlink" title="Implementing propEq"></a>Implementing propEq</h2><p>Simplest Approach<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> propEq = <span class="function"><span class="keyword">function</span>(<span class="params">prop, val</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">obj</span>) </span>&#123;</div><div class="line">        <span class="keyword">return</span> obj[prop] === val;</div><div class="line">    &#125;;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>This works, and we could leave it there, but we’re going to take another detour into a popular style of functional programming known as <strong>points-free</strong> coding.</p>
<hr>
<h2 id="Points-free-definitions"><a href="#Points-free-definitions" class="headerlink" title="Points-free definitions"></a>Points-free definitions</h2><p>With the functions <strong>add</strong> (which adds two numbers) and <strong>reduce</strong> (which runs the supplied function against an accumulator and each element of the list, feeding the result of each call into the next one and returning the final result), we can easily define a <strong>sum</strong> function like this:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> sum = <span class="function"><span class="keyword">function</span>(<span class="params">list</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> reduce(add, <span class="number">0</span>, list);</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>Because of the automatic currying, though, the following is entirely equivalent:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> sum = reduce(add, <span class="number">0</span>);</div></pre></td></tr></table></figure>
<p>This is the <strong>points-free</strong> style, defining functions without ever making direct reference to their arguments.</p>
<hr>
<p><strong>Wikipedia</strong><br>&gt;<br>Tacit [point-free] programming is a programming paradigm in which a function definition does not include information regarding its arguments, using combinators and function composition (but not ?-abstraction) instead of variables.</p>
<p>There are plenty of reasons to like it, but the most important one might just be the simplicity. There is a great deal to be said for elegant, readable code.</p>
<hr>
<h2 id="A-points-free-version-of-propEq"><a href="#A-points-free-version-of-propEq" class="headerlink" title="A points-free version of propEq"></a>A points-free version of propEq</h2><p>Can we redefine the following in a points-free style?</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> propEq = <span class="function"><span class="keyword">function</span>(<span class="params">prop, val</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">obj</span>) </span>&#123;</div><div class="line">        <span class="keyword">return</span> obj[prop] === val;</div><div class="line">    &#125;;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Here’s a version that is closer to points-free, removing the direct reference to obj:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> propEq = <span class="function"><span class="keyword">function</span>(<span class="params">prop, val</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> compose(eq(val), get(prop));</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>Huh? What? <strong>compose</strong>? <strong>eq</strong>?</p>
<p><strong>eq</strong> is easy: like all good functions of multiple parameters, it’s curried, and it simply reports whether its two arguments are equal. So <strong>eq(val)</strong> is a function which reports whether its parameter has the same value as does <strong>val</strong>. But now we need to discuss <strong>compose</strong>.</p>
<hr>
<h2 id="Functional-composition"><a href="#Functional-composition" class="headerlink" title="Functional composition"></a>Functional composition</h2><p>In mathematics <strong>f ∘ g</strong> (pronounced “f composed with g”) is the function that given <strong>x</strong>, returns <strong>f(g(x))</strong>.</p>
<p>So if we follow the mathematical model <strong>compose(add1, square)(x)</strong> should equal <strong>add1(square(x))</strong>.</p>
<p>Simplest Implementation</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> compose = <span class="function"><span class="keyword">function</span>(<span class="params">f, g</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">x</span>) </span>&#123;</div><div class="line">        <span class="keyword">return</span> f(g(x));</div><div class="line">    &#125;;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>Note that <strong>Ramda</strong> also defines <strong>pipe</strong>, which does much the same thing, but runs the functions in the opposite order. So <strong>pipe(add1, square)(x)</strong> equals <strong>square(add1(x))</strong>. Both styles have their uses.</p>
<hr>
<h2 id="Back-to-propEq"><a href="#Back-to-propEq" class="headerlink" title="Back to propEq"></a>Back to propEq</h2><p>So now this definition makes sense:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> propEq = <span class="function"><span class="keyword">function</span>(<span class="params">prop, val</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> pipe(get(prop), eq(val));</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Note the switch from <strong>compose</strong> to <strong>pipe</strong>.</p>
<p>This gives us a further way to clean it up, and make it entirely <strong>points-free</strong>, using a useful feature of Ramda we haven’t seen implemented in other libraries, which we call (for now) <strong>callWith</strong>. Used like <strong>callWith(fn, transformer1, … transformerN)</strong>, this returns a function which accepts N parameters, feeds them to the respective transformers, and then calls <strong>fn</strong> using the results of all these. This gives us the final version of propEq:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> propEq = callWith(pipe, get, eq);</div></pre></td></tr></table></figure>
<hr>
<h2 id="Definition-of-propEq"><a href="#Definition-of-propEq" class="headerlink" title="Definition of propEq"></a>Definition of propEq</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">module.exports = _curry3(function propEq(name, val, obj) &#123;</div><div class="line">  return _eq(obj[name], val);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<hr>
<h2 id="Using-our-new-function"><a href="#Using-our-new-function" class="headerlink" title="Using our new function"></a>Using our new function</h2><p>Still, all these explanations aside, it was only a minute or two of work to do this refactoring and arrive at a fairly simple version of <strong>propEq</strong>. We would plug it back in like this:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> propEq = callWith(pipe, get, eq);</div><div class="line"></div><div class="line"><span class="comment">// ...</span></div><div class="line"></div><div class="line">.then(filter(propEq(<span class="string">'member'</span>, memberName)))</div><div class="line">.then(reject(propEq(<span class="string">'complete'</span>, <span class="literal">true</span>)))</div></pre></td></tr></table></figure>
<hr>
<h2 id="New-objects-from-old"><a href="#New-objects-from-old" class="headerlink" title="New objects from old"></a>New objects from old</h2><p>The next block we wanted to update looked like this:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">.then(<span class="function"><span class="keyword">function</span>(<span class="params">tasks</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> results = [], task;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, len = tasks.length; i &lt; len; i++) &#123;</div><div class="line">        task = tasks[i];</div><div class="line">        results.push(&#123;</div><div class="line">            id: task.id,</div><div class="line">            dueDate: task.dueDate,</div><div class="line">            title: task.title,</div><div class="line">            priority: task.priority</div><div class="line">        &#125;)</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> results;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>Functional version:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">.then(map(pick([<span class="string">'id'</span>, <span class="string">'dueDate'</span>, <span class="string">'title'</span>, <span class="string">'priority'</span>])))</div></pre></td></tr></table></figure>
<p>You’re a smart bunch, right? I probably don’t even have to explain what pick does, right?</p>
<hr>
<h2 id="The-map-function"><a href="#The-map-function" class="headerlink" title="The map function"></a>The <strong>map</strong> function</h2><p>One of the most fundamental functions used in FP is <strong>map</strong>, which is used to convert one list into a related one by running the same function against each member.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> fiveSquares = map(square, [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]); <span class="comment">// =&gt; [1, 4, 9, 16, 25];</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> shouts = map(toUpperCase, [<span class="string">"oy"</span>, <span class="string">"vey"</span>]); <span class="comment">//=&gt; ["OY", "VEY"]</span></div></pre></td></tr></table></figure>
<p>There isn’t much more to say about <strong>map</strong>, but it’s important to point out that this function and <strong>reduce</strong>, which we mentioned briefly earlier, are among the most important functional programming tools around.</p>
<hr>
<h2 id="Partial-clones-of-our-objects"><a href="#Partial-clones-of-our-objects" class="headerlink" title="Partial clones of our objects"></a>Partial clones of our objects</h2><p>We used map like this:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">.then(map(pick([<span class="string">'id'</span>, <span class="string">'dueDate'</span>, <span class="string">'title'</span>, <span class="string">'priority'</span>])))</div></pre></td></tr></table></figure>
<p>The magic of currying is again at work here:</p>
<ul>
<li><strong>pick</strong> accepts a list of properties and an object and return a partial clone, copying those properties from the original. Since we just pass in the properties, this curried function returns a new function that accepts an object and returns that partial clone.</li>
<li><strong>map</strong> accepts a function and a list an applies the function to the list. But because it’s curried, and because we supply only the function generated by the curried pick, this one also returns a new function which will accept a list and create these partial clones of each element in the list.</li>
<li>This function is passed to <strong>then</strong>, which will simply pass along its parameter (whenever that becomes ready) to our function and “return” the result of running our function against it. (We simply know because of the way prior calls have been built that this will be a list of tasks.)</li>
</ul>
<hr>
<h2 id="A-final-task-of-some-sort"><a href="#A-final-task-of-some-sort" class="headerlink" title="A final task of some sort"></a>A final task of some sort</h2><p>The last segment we wanted to convert looked like this:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">.then(function(tasks) &#123;</div><div class="line">    tasks.sort(function(first, second) &#123;</div><div class="line">        return first.dueDate - second.dueDate;</div><div class="line">    &#125;);</div><div class="line">    return tasks;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>Sorts the list according to a key generated by the supplied function.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> sortByFirstItem = R.sortBy(prop(<span class="number">0</span>));</div><div class="line"><span class="keyword">var</span> pairs = [[<span class="number">-1</span>, <span class="number">1</span>], [<span class="number">-2</span>, <span class="number">2</span>], [<span class="number">-3</span>, <span class="number">3</span>]];</div><div class="line">sortByFirstItem(pairs); <span class="comment">//=&gt; [[-3, 3], [-2, 2], [-1, 1]]</span></div></pre></td></tr></table></figure>
<hr>
<h2 id="Again-with-the-curry"><a href="#Again-with-the-curry" class="headerlink" title="Again with the curry"></a>Again with the curry</h2><p>Again, we take advantage of the fact that our important functions are curried, and use <strong>prop(‘dueDate’)</strong>. This creates a function that, fed one of our task objects, returns its due date. We can feed this into <strong>sortBy</strong> to get the following:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">.then(sortBy(prop(&apos;dueDate&apos;)))</div></pre></td></tr></table></figure>
<hr>
<p>While this is not a lot less code than the original:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">.then(<span class="function"><span class="keyword">function</span>(<span class="params">tasks</span>) </span>&#123;</div><div class="line">    tasks.sort(<span class="function"><span class="keyword">function</span>(<span class="params">first, second</span>) </span>&#123;</div><div class="line">        <span class="keyword">return</span> first.dueDate - second.dueDate;</div><div class="line">    &#125;);</div><div class="line">    <span class="keyword">return</span> tasks;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>it clearly is a savings. However, much more importantly, the code is all clearly aimed at our problem.</p>
<hr>
<h2 id="Recap-–-Imperative"><a href="#Recap-–-Imperative" class="headerlink" title="Recap – Imperative"></a>Recap – Imperative</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> getIncompleteTaskSummariesForMember_imperative = <span class="function"><span class="keyword">function</span>(<span class="params">memberName</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> fetchData()</div><div class="line">        .then(<span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</div><div class="line">            <span class="keyword">return</span> data.tasks;</div><div class="line">        &#125;)</div><div class="line">        .then(<span class="function"><span class="keyword">function</span>(<span class="params">tasks</span>) </span>&#123;</div><div class="line">            <span class="keyword">var</span> results = [];</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, len = tasks.length; i &lt; len; i++) &#123;</div><div class="line">                <span class="keyword">if</span> (tasks[i].member == memberName) &#123;</div><div class="line">                    results.push(tasks[i]);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">return</span> results;</div><div class="line">        &#125;)</div><div class="line">        .then(<span class="function"><span class="keyword">function</span>(<span class="params">tasks</span>) </span>&#123;</div><div class="line">            <span class="keyword">var</span> results = [];</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, len = tasks.length; i &lt; len; i++) &#123;</div><div class="line">                <span class="keyword">if</span> (!tasks[i].complete) &#123;</div><div class="line">                    results.push(tasks[i]);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">return</span> results;</div><div class="line">        &#125;)</div><div class="line">        .then(<span class="function"><span class="keyword">function</span>(<span class="params">tasks</span>) </span>&#123;</div><div class="line">            <span class="keyword">var</span> results = [], task;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, len = tasks.length; i &lt; len; i++) &#123;</div><div class="line">                task = tasks[i];</div><div class="line">                results.push(&#123;</div><div class="line">                    id: task.id,</div><div class="line">                    dueDate: task.dueDate,</div><div class="line">                    title: task.title,</div><div class="line">                    priority: task.priority</div><div class="line">                &#125;)</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">return</span> results;</div><div class="line">        &#125;)</div><div class="line">        .then(<span class="function"><span class="keyword">function</span>(<span class="params">tasks</span>) </span>&#123;</div><div class="line">            tasks.sort(<span class="function"><span class="keyword">function</span>(<span class="params">first, second</span>) </span>&#123;</div><div class="line">                <span class="keyword">return</span> first.dueDate - second.dueDate;</div><div class="line">            &#125;);</div><div class="line">            <span class="keyword">return</span> tasks;</div><div class="line">        &#125;);</div><div class="line">      &#125;</div></pre></td></tr></table></figure>
<hr>
<h2 id="Recap-–-Functional"><a href="#Recap-–-Functional" class="headerlink" title="Recap – Functional"></a>Recap – Functional</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> getIncompleteTaskSummariesForMemberFunctional = <span class="function"><span class="keyword">function</span>(<span class="params">memberName</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> fetchData()</div><div class="line">        .then(get(<span class="string">'tasks'</span>))</div><div class="line">        .then(filter(propEq(<span class="string">'member'</span>, memberName)))</div><div class="line">        .then(reject(propEq(<span class="string">'complete'</span>, <span class="literal">true</span>)))</div><div class="line">        .then(map(pick([<span class="string">'id'</span>, <span class="string">'dueDate'</span>, <span class="string">'title'</span>, <span class="string">'priority'</span>])))</div><div class="line">        .then(sortBy(get(<span class="string">'dueDate'</span>)));</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<hr>
<h2 id="Most-Important-Functions"><a href="#Most-Important-Functions" class="headerlink" title="Most Important Functions"></a>Most Important Functions</h2><p>We’ve seen what are probably the most important functions in functional programming:</p>
<ul>
<li>map</li>
<li>reduce</li>
<li>filter</li>
<li>compose</li>
<li>curry</li>
</ul>
<p>There’s one that to some might be conspicuous by it’s absence:</p>
<ul>
<li>forEach<br>Maybe it is not actually appropriate to functional programming, as its main purpose is to help you achieve side-effects. But many libraries do include one.</li>
</ul>
<hr>
<h3 id="What-We-Gain-from-FP-Style"><a href="#What-We-Gain-from-FP-Style" class="headerlink" title="What We Gain from FP Style"></a>What We Gain from FP Style</h3><ul>
<li>Elegance and simplicity</li>
<li>Easier decomposition of problems</li>
<li>Code more closely tied to the problem domain</li>
</ul>
<p><strong>And through these, we can also achieve</strong></p>
<ul>
<li>Straightforward unit testing</li>
<li>Easier debugging</li>
<li>Simple concurrency</li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Agenda&quot;&gt;&lt;a href=&quot;#Agenda&quot; class=&quot;headerlink&quot; title=&quot;Agenda&quot;&gt;&lt;/a&gt;Agenda&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;What is Functional Programming?&lt;/li&gt;
&lt;li&gt;How Fun
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://owenyang0.github.io/tags/JavaScript/"/>
    
      <category term="FP" scheme="http://owenyang0.github.io/tags/FP/"/>
    
      <category term="Functional Programming" scheme="http://owenyang0.github.io/tags/Functional-Programming/"/>
    
      <category term="Ramda" scheme="http://owenyang0.github.io/tags/Ramda/"/>
    
  </entry>
  
  <entry>
    <title>修复AWS上EC2损坏的sshd_config文件</title>
    <link href="http://owenyang0.github.io/2015/03/16/%E4%BF%AE%E5%A4%8DAWS%E4%B8%8AEC2%E6%8D%9F%E5%9D%8F%E7%9A%84sshd-config%E6%96%87%E4%BB%B6/"/>
    <id>http://owenyang0.github.io/2015/03/16/修复AWS上EC2损坏的sshd-config文件/</id>
    <published>2015-03-16T12:11:09.000Z</published>
    <updated>2016-08-15T09:00:19.000Z</updated>
    
    <content type="html"><![CDATA[<p><strong>常识：</strong> AWS是没有root用户的，登陆也都是通过SSH KEY完成授权认证。</p>
<p><strong>背景：</strong> 正在AWS上搭一个<code>CI</code> (GO)，与<code>gitlab</code>，为了将其进行集成，需将gitlab的deploy key设置成GO的SSH KEY。然而，GO创建的是无密码的用户go，导致无法进入用户go的home目录。<br>正常 <code>su go</code> 无法切换到go用户，当时又恰巧正在看SSH的config文件：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/etc/ssh/sshd_config</div></pre></td></tr></table></figure></p>
<p>里面有一条 <code>PermitEmptyPasswords no</code>，接着便私自改成了<code>yes</code>，无用。<code>PermitRootLogin no</code>，改成 <code>yes</code>，依旧无用。<br><strong>注：</strong>废话，肯定没用啊，这是设置SSH的。</p>
<p>正确的做法：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo su go</div></pre></td></tr></table></figure></p>
<p>当修改之后，没改回来，当我退出AWS之后就杯具了。再也登陆到AWS上，因为登陆时却输密码，而实际却是没有密码。此时真想多天说一句：X。</p>
<p>Google了很多解决方案，都说得是用Live CD，重新引导进入，然后挂载有sshd_config文件的磁盘并修复它。这在EC2上是根本不可能的，能做的只有把root磁盘卷拆卸，再装载到另外的EC2实例上，并修改相应的文件。以下便是详细操作：</p>
<ol>
<li>关闭当前EC2实例</li>
<li>将有错误sshd_config的磁盘(EBS)拆卸</li>
<li><p>当磁盘重新装载到另一个EC2实例上，并挂载该磁盘<br>拆卸与装载都在AWS的console界面操作，装载成功后，可用以下命令挂载（我的新的磁盘名字是 xdf)：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">sudo mkdir /mnt/other</div><div class="line">sudo mount /dev/xvdf /mnt/other</div></pre></td></tr></table></figure>
</li>
<li><p>编辑损坏的文件sshd_config，修复配置与语法错误</p>
</li>
<li><p>反挂载并拆卸掉该磁盘</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo umount /mnt/other</div></pre></td></tr></table></figure>
</li>
<li><p>再次将该磁盘装载到原EC2实例上</p>
</li>
<li>启动原EC2实例，测试修改结果</li>
</ol>
<p>这些做完之后，一切都如以前一样。又可以通过SSH KEY连上原来的实例。</p>
<h3 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h3><p>教训是，永远别再一次做这种事。在适当的时候，也可以给你的编辑器sudo的权限，vim的配置<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cnoremap w!! %!sudo tee &gt; /dev/null %</div></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;常识：&lt;/strong&gt; AWS是没有root用户的，登陆也都是通过SSH KEY完成授权认证。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;背景：&lt;/strong&gt; 正在AWS上搭一个&lt;code&gt;CI&lt;/code&gt; (GO)，与&lt;code&gt;gitlab&lt;/code&gt;，为
    
    </summary>
    
    
      <category term="linux" scheme="http://owenyang0.github.io/tags/linux/"/>
    
      <category term="aws" scheme="http://owenyang0.github.io/tags/aws/"/>
    
      <category term="ec2" scheme="http://owenyang0.github.io/tags/ec2/"/>
    
      <category term="ssh" scheme="http://owenyang0.github.io/tags/ssh/"/>
    
      <category term="passwd" scheme="http://owenyang0.github.io/tags/passwd/"/>
    
      <category term="amazon-web-services" scheme="http://owenyang0.github.io/tags/amazon-web-services/"/>
    
  </entry>
  
  <entry>
    <title>2014压过的辙痕</title>
    <link href="http://owenyang0.github.io/2015/02/22/2014%E5%8E%8B%E8%BF%87%E7%9A%84%E8%BE%99%E7%97%95/"/>
    <id>http://owenyang0.github.io/2015/02/22/2014压过的辙痕/</id>
    <published>2015-02-22T06:30:55.000Z</published>
    <updated>2016-08-15T09:00:19.000Z</updated>
    
    <content type="html"><![CDATA[<p>2014过去2个月有余，才回过神来做一下去年的总结。自己的拖延症也是厉害，此时也希望不会太晚。不过，好歹也才刚过春节。<br>一年，从去学校毕业了。<br>一年，从实习到了试用，从新蛋到了TW。<br>一年，大家各奔东西，世界留给了一群追梦的人。<br>一年，又开始了一段新的人生罢。</p>
<p>现在都记不得最初的梦想了，自己的追逐的意义依旧还是存在的，只是少了当初那份一往无前的勇气。<br>去年<br><img src="/images/goal_2014.png" alt="2014 goal"><br>今年<br><img src="/images/goal_2015.png" alt="2015 goal"><br>去年的整个计划是开始读书，可是真正执行起来才会发现并非想像中的那么容易。当然，也有其他，只是其他还算得上不易。</p>
<h3 id="1-读书"><a href="#1-读书" class="headerlink" title="1. 读书"></a>1. 读书</h3><p>人人都会，却又不是人人都会的技能。<a href="http://book.douban.com/people/owenyang0/" target="_blank" rel="external">http://book.douban.com/people/owenyang0/</a><br>我开始学会用豆瓣来Track自己的读书进度，年终还可以用来分析分析自己的读书倾向。不得不说豆瓣在这个方面，做得也还是不错的。给书友提供了一个平台，分享与交流。<br>相比一些个大神，一年上百本书的战果，我这根本不值一提。不过，自己也慢慢开始了自己的读书习惯，与计划。</p>
<h3 id="2-写博"><a href="#2-写博" class="headerlink" title="2. 写博"></a>2. 写博</h3><p>想写，却又不容易坚持的习惯。<a href="http://www.cnblogs.com/owenyang/" target="_blank" rel="external">http://www.cnblogs.com/owenyang/</a><br>一直想写一些，或者坚持写一些博客，来记录自己的平凡但不应该平淡的生活。但实际情况，却还是一样：不太容易坚持。一年下来，总共有10篇博文。细看又是那么的不均匀，其中有4篇是在12月所写。原来效率，也不会是平均分布到整年。抓住时间，用每一分秒提高效率。</p>
<h3 id="3-初心"><a href="#3-初心" class="headerlink" title="3. 初心"></a>3. 初心</h3><p>想忘，又不忘，想而不舍忘。<br>和某人，在某时，去过某些地方。却又在，某时，走向了远方。既然，风筝早已远去，任你在风中如何摇曳，也终究拉不回曾经的时光。风在吹，某在飞，时光无法回流，选择只有向前而走。随心而行，是那么的不靠谱，不行动意味着不作为。有过开心，欢乐，但更多是在失去后所保留的执著。</p>
<p>去年也成往事，还是今年的计划吧。<br><strong>1.读书：</strong>有人说，一年读50本书，才算得上是读书人。粗算一下，一周就得读一本，想想压力也是挺大的。去年一年的时间，也才20本。第二年，也别过分高估自己。今年30本吧。<br><strong>2.写博：</strong>别去想自己写多少，去想自己有多少可以写吧。保持不断学习的热情，一直学习下去，与分享下去。不只是技术，还有其他。<br><strong>3.初心：</strong>初心？初心是什么？不懂，忘了。只是希望自己的这一年，走得不会太艰难。</p>
<p>最后一句话，留给自己：心态，别抑郁，要乐观，诚对人，能坚持，追梦想。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;2014过去2个月有余，才回过神来做一下去年的总结。自己的拖延症也是厉害，此时也希望不会太晚。不过，好歹也才刚过春节。&lt;br&gt;一年，从去学校毕业了。&lt;br&gt;一年，从实习到了试用，从新蛋到了TW。&lt;br&gt;一年，大家各奔东西，世界留给了一群追梦的人。&lt;br&gt;一年，又开始了一段新
    
    </summary>
    
    
      <category term="2014" scheme="http://owenyang0.github.io/tags/2014/"/>
    
      <category term="2015" scheme="http://owenyang0.github.io/tags/2015/"/>
    
      <category term="goal" scheme="http://owenyang0.github.io/tags/goal/"/>
    
      <category term="summary" scheme="http://owenyang0.github.io/tags/summary/"/>
    
      <category term="plan" scheme="http://owenyang0.github.io/tags/plan/"/>
    
  </entry>
  
  <entry>
    <title>ECMAScript 6中字符串的新特性</title>
    <link href="http://owenyang0.github.io/2015/02/12/New-string-features-in-ECMAScript-6/"/>
    <id>http://owenyang0.github.io/2015/02/12/New-string-features-in-ECMAScript-6/</id>
    <published>2015-02-12T12:26:43.000Z</published>
    <updated>2016-08-15T09:00:19.000Z</updated>
    
    <content type="html"><![CDATA[<p>本文将覆盖在ECMAScript 6 (ES6)中，字符串的新特性。</p>
<h2 id="Unicode-码位-code-point-转义"><a href="#Unicode-码位-code-point-转义" class="headerlink" title="Unicode 码位(code point)转义"></a>Unicode 码位(code point)转义</h2><p>Unicode字符码位的长度是21位<a href="http://speakingjs.com/es5/ch24.html" target="_blank" rel="external">[2]</a>。而JavaScript的字符串，是16位的，以UTF-16的方式编码。因此，超出16位码长的码位范围(the Basic Multilingual Pane, BMP, 基本多文种平面)则用两个JavaScript字符表示。直到现在，如果想用数字指定这样的码位，需要两个叫Unicode转义符的东西。以下，则会以相应的码位(0x1F680)打印出一个火箭。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log(<span class="string">'\uD83D\uDE80'</span>);</div></pre></td></tr></table></figure></p>
<p>在ECMAScript 6中，有一个新的Unicode转义符，能让你指定任意的码位（不用再管是否是16位）：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log(<span class="string">'\u&#123;1F680&#125;'</span>);</div></pre></td></tr></table></figure></p>
<h2 id="字符串的插值，多行及原始字符语法"><a href="#字符串的插值，多行及原始字符语法" class="headerlink" title="字符串的插值，多行及原始字符语法"></a>字符串的插值，多行及原始字符语法</h2><p>模板字符串 <a href="http://www.2ality.com/2011/09/quasi-literals.html" target="_blank" rel="external">[3]</a>提供了3个有意思的特性。<br><strong>1. 模板字符中，支持字符串插值：</strong><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> first = <span class="string">'Jane'</span>;</div><div class="line"><span class="keyword">let</span> last = <span class="string">'Doe'</span>;</div><div class="line"><span class="built_in">console</span>.log(<span class="string">`Hello <span class="subst">$&#123;first&#125;</span> <span class="subst">$&#123;last&#125;</span>!`</span>);</div><div class="line"><span class="comment">// Hello Jane Doe!</span></div></pre></td></tr></table></figure></p>
<p><strong>2. 模板字符串可以包含多行：</strong><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> multiLine = <span class="string">`</span></div><div class="line">  This is</div><div class="line">  a string</div><div class="line">  with multiple</div><div class="line">  lines`;</div></pre></td></tr></table></figure></p>
<p><strong>3. 模板字符串可以是原始的：</strong><br>若使用<code>String.raw</code> 作为模板字符串的前缀，则模板字符串可以是<em>原始(raw)</em>的。反斜线也不再是特殊字符，<code>\n</code> 也不会被解释成换行符：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> raw = <span class="built_in">String</span>.raw<span class="string">`Not a newline: \n`</span>;</div><div class="line"><span class="built_in">console</span>.log(raw === <span class="string">'Not a newline: \\n'</span>); <span class="comment">// true</span></div></pre></td></tr></table></figure></p>
<h2 id="字符串迭代那些事"><a href="#字符串迭代那些事" class="headerlink" title="字符串迭代那些事"></a>字符串迭代那些事</h2><p>字符串是可迭代的 <a href="http://www.2ality.com/2013/06/iterators-generators.html" target="_blank" rel="external">[4]</a>，这就意味着可以使用<code>for-of</code> 去迭代其中的字符：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> ch <span class="keyword">of</span> <span class="string">'abc'</span>) &#123;</div><div class="line">    <span class="built_in">console</span>.log(ch);</div><div class="line">&#125;</div><div class="line"><span class="comment">// Output:</span></div><div class="line"><span class="comment">// a</span></div><div class="line"><span class="comment">// b</span></div><div class="line"><span class="comment">// c</span></div></pre></td></tr></table></figure></p>
<p>亦可用展开运行符(…) 将字符串转换成数组：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> chars = [...<span class="string">'abc'</span>];</div><div class="line"><span class="comment">// ['a', 'b', 'c']</span></div></pre></td></tr></table></figure></p>
<h3 id="处理Unicode的码位"><a href="#处理Unicode的码位" class="headerlink" title="处理Unicode的码位"></a>处理Unicode的码位</h3><p>字符串迭代器，会以码位边界将字符串进行划分。这将导致迭代器的返回值，会是一个或两个字符：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> ch <span class="keyword">of</span> <span class="string">'x\uD83D\uDE80y'</span>) &#123;</div><div class="line">    <span class="built_in">console</span>.log(ch.length);</div><div class="line">&#125;</div><div class="line"><span class="comment">// Output:</span></div><div class="line"><span class="comment">// 1</span></div><div class="line"><span class="comment">// 2</span></div><div class="line"><span class="comment">// 1</span></div></pre></td></tr></table></figure></p>
<p>这将会为我提供一个快速而简单的方法，去计算字符串Unicode码位的数量：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; [...<span class="string">'x\uD83D\uDE80y'</span>].length</div><div class="line"><span class="number">3</span></div></pre></td></tr></table></figure></p>
<p>这同样会在，不包含基本多文种平面(non-BMP)码位的字符串操作中提供方便。如：反转字符串：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> str = <span class="string">'x\uD83D\uDE80y'</span>;</div><div class="line"></div><div class="line"><span class="comment">// ES5: \uD83D\uDE80 are (incorrectly) reversed</span></div><div class="line"><span class="built_in">console</span>.log(str.split(<span class="string">''</span>).reverse().join(<span class="string">''</span>));</div><div class="line"><span class="comment">// 'y\uDE80\uD83Dx'</span></div><div class="line"></div><div class="line"><span class="comment">// ES6: order of \uD83D\uDE80 is preserved</span></div><div class="line"><span class="built_in">console</span>.log([...str].reverse().join(<span class="string">''</span>));</div><div class="line"><span class="comment">// 'y\uD83D\uDE80x'</span></div></pre></td></tr></table></figure></p>
<p>这是在firefox控制台中，两个反转之后的结果：<br><img src="/images/firefox_unicode.png" alt="Unicode in Firefox"></p>
<h3 id="码位中数值"><a href="#码位中数值" class="headerlink" title="码位中数值"></a>码位中数值</h3><p>有一个新的方法 <code>codePointAt()</code> 将返回字符串，给定索引的码位数字值：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> str = <span class="string">'x\uD83D\uDE80y'</span>;</div><div class="line"><span class="built_in">console</span>.log(str.codePointAt(<span class="number">0</span>).toString(<span class="number">16</span>)); <span class="comment">// 78</span></div><div class="line"><span class="built_in">console</span>.log(str.codePointAt(<span class="number">1</span>).toString(<span class="number">16</span>)); <span class="comment">// 1f680</span></div><div class="line"><span class="built_in">console</span>.log(str.codePointAt(<span class="number">3</span>).toString(<span class="number">16</span>)); <span class="comment">// 79</span></div></pre></td></tr></table></figure></p>
<p>该方法在与字符串迭代操作结合时，也能很好的运行使用：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> ch <span class="keyword">of</span> <span class="string">'x\uD83D\uDE80y'</span>) &#123;</div><div class="line">    <span class="built_in">console</span>.log(ch.codePointAt(<span class="number">0</span>).toString(<span class="number">16</span>));</div><div class="line">&#125;</div><div class="line"><span class="comment">// Output:</span></div><div class="line"><span class="comment">// 78</span></div><div class="line"><span class="comment">// 1f680</span></div><div class="line"><span class="comment">// 79</span></div></pre></td></tr></table></figure></p>
<p>与方法<code>codePointAt()</code>相对的则是<code>String.fromCodePoint()</code>：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; <span class="built_in">String</span>.fromCodePoint(<span class="number">0x78</span>, <span class="number">0x1f680</span>, <span class="number">0x79</span>) === <span class="string">'x\uD83D\uDE80y'</span></div><div class="line"><span class="literal">true</span></div></pre></td></tr></table></figure></p>
<h2 id="包含与重要字符串的方法"><a href="#包含与重要字符串的方法" class="headerlink" title="包含与重要字符串的方法"></a>包含与重要字符串的方法</h2><p>有三个方法，可以检查一个字符串是否存在于另一个字符串：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&gt; <span class="string">'hello'</span>.startsWith(<span class="string">'hell'</span>)</div><div class="line"><span class="literal">true</span></div><div class="line">&gt; <span class="string">'hello'</span>.endsWith(<span class="string">'ello'</span>)</div><div class="line"><span class="literal">true</span></div><div class="line">&gt; <span class="string">'hello'</span>.includes(<span class="string">'ell'</span>)</div><div class="line"><span class="literal">true</span></div></pre></td></tr></table></figure></p>
<p>每一个方法都有一个可选的，第二个参数。可以指定被搜寻字符串的开始或结束位置：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&gt; <span class="string">'hello'</span>.startsWith(<span class="string">'ello'</span>, <span class="number">1</span>)</div><div class="line"><span class="literal">true</span></div><div class="line">&gt; <span class="string">'hello'</span>.endsWith(<span class="string">'hell'</span>, <span class="number">4</span>)</div><div class="line"><span class="literal">true</span></div><div class="line"></div><div class="line">&gt; <span class="string">'hello'</span>.includes(<span class="string">'ell'</span>, <span class="number">1</span>)</div><div class="line"><span class="literal">true</span></div><div class="line">&gt; <span class="string">'hello'</span>.includes(<span class="string">'ell'</span>, <span class="number">2</span>)</div><div class="line"><span class="literal">false</span></div></pre></td></tr></table></figure></p>
<p>方法<code>repeat()</code> 则用以重复某个字符串：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; <span class="string">'doo '</span>.repeat(<span class="number">3</span>)</div><div class="line"><span class="string">'doo doo doo '</span></div></pre></td></tr></table></figure></p>
<h2 id="所有新方法"><a href="#所有新方法" class="headerlink" title="所有新方法"></a>所有新方法</h2><h3 id="模板字符串："><a href="#模板字符串：" class="headerlink" title="模板字符串："></a>模板字符串：</h3><ul>
<li>String.raw(callSite, …substitutions) : string<br>用于产生<em>原始(raw)</em>字串(反斜杠不会被转义)。</li>
</ul>
<h3 id="Unicode和码位："><a href="#Unicode和码位：" class="headerlink" title="Unicode和码位："></a>Unicode和码位：</h3><ul>
<li><p>String.fromCodePoint(…codePoints : number[]) : string<br>将数字值码位转换成字符串。</p>
</li>
<li><p>String.prototype.codePointAt(pos) : number<br>返回码位开始位置的数字值(会包含一个或两个JavaScript的字符)。</p>
</li>
<li><p>String.prototype.normalize(form? : string) : string<br>不同的码位组合，最后可能有一致的显示。<a href="">Unicode normalization</a>可以将它们转化成同样的值，这会被叫做规范的表示方式(canonical representation)。这将有助于比较和查找字符串。在一般的文本之中，’NFC’是一种被推荐的形式。</p>
</li>
</ul>
<h3 id="查找字符串："><a href="#查找字符串：" class="headerlink" title="查找字符串："></a>查找字符串：</h3><ul>
<li><p>String.prototype.startsWith(searchString, position=0) : boolean<br>检查一个字符串是否以另一个字符串(searchString)开始。位置(position)指定从哪开始执行检查。</p>
</li>
<li><p>String.prototype.endsWith(searchString, endPosition=searchString.length) : boolean<br>检查一个字符串是否以另一个字符串(searchString)结尾。结束位置(endPosition)指定在哪执行结尾检查。</p>
</li>
<li><p>String.prototype.includes(searchString, position=0) : boolean<br>检查一个字符字符串是否包含另一个字符串(searchString)。位置(position)指定从哪开始检查。</p>
</li>
</ul>
<h3 id="重复字符串："><a href="#重复字符串：" class="headerlink" title="重复字符串："></a>重复字符串：</h3><ul>
<li>String.prototype.repeat(count) : string<br>返回给定字符串N次。</li>
</ul>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ol>
<li><a href="http://www.2ality.com/2014/08/es6-today.html" target="_blank" rel="external">Using ECMAScript 6 today</a></li>
<li>Chapter 24, “<a href="http://speakingjs.com/es5/ch24.html" target="_blank" rel="external">Unicode and JavaScript</a>” of “Speaking JavaScript”; includes an introduction to Unicode.</li>
<li><a href="http://www.2ality.com/2011/09/quasi-literals.html" target="_blank" rel="external">Template strings: embedded DSLs in ECMAScript 6</a></li>
<li><a href="http://www.2ality.com/2013/06/iterators-generators.html" target="_blank" rel="external">Iterators and generators in ECMAScript 6</a></li>
<li>译自 <a href="http://www.2ality.com/2015/01/es6-strings.html" target="_blank" rel="external">New string features in ECMAScript 6</a></li>
</ol>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;本文将覆盖在ECMAScript 6 (ES6)中，字符串的新特性。&lt;/p&gt;
&lt;h2 id=&quot;Unicode-码位-code-point-转义&quot;&gt;&lt;a href=&quot;#Unicode-码位-code-point-转义&quot; class=&quot;headerlink&quot; title=&quot;Un
    
    </summary>
    
    
      <category term="ES6" scheme="http://owenyang0.github.io/tags/ES6/"/>
    
      <category term="JavaScript" scheme="http://owenyang0.github.io/tags/JavaScript/"/>
    
      <category term="ECMAScript 6" scheme="http://owenyang0.github.io/tags/ECMAScript-6/"/>
    
      <category term="Template" scheme="http://owenyang0.github.io/tags/Template/"/>
    
      <category term="Template String" scheme="http://owenyang0.github.io/tags/Template-String/"/>
    
  </entry>
  
  <entry>
    <title>NPM install - killed error solution</title>
    <link href="http://owenyang0.github.io/2015/02/09/NPM-install-killed-error-solution/"/>
    <id>http://owenyang0.github.io/2015/02/09/NPM-install-killed-error-solution/</id>
    <published>2015-02-09T11:29:46.000Z</published>
    <updated>2016-08-15T09:00:19.000Z</updated>
    
    <content type="html"><![CDATA[<p>在接手一个Node项目的时候，<code>npm install</code>。却出现了”killed”的错误。以为是Node版本的问题，熟练地切换了0.11与0.10版，同样无解。<br>由于新的npm版本吧，<code>npm install</code>的时候已经无法看到常规的log信息了。以<code>npm install -d</code>查看安装的过程，发现无任何特殊的地方。在一定程度的时候，直接被”killed”。关于<code>npm install -d</code>可以看 <a href="https://docs.npmjs.com/misc/config" target="_blank" rel="external">npm config</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">-v: --version</div><div class="line">-h, -?, --help, -H: --usage</div><div class="line">-s, --silent: --loglevel silent</div><div class="line">-q, --quiet: --loglevel warn</div><div class="line">-d: --loglevel info</div><div class="line">-dd, --verbose: --loglevel verbose</div><div class="line">-ddd: --loglevel silly</div><div class="line">-g: --global</div><div class="line">-C: --prefix</div><div class="line">-l: --long</div><div class="line">-m: --message</div><div class="line">-p, --porcelain: --parseable</div><div class="line">-reg: --registry</div><div class="line">-f: --force</div><div class="line">-desc: --description</div><div class="line">-S: --save</div><div class="line">-D: --save-dev</div><div class="line">-O: --save-optional</div><div class="line">-B: --save-bundle</div><div class="line">-E: --save-exact</div><div class="line">-y: --yes</div><div class="line">-n: --yes false</div><div class="line">ll and la commands: ls --long</div></pre></td></tr></table></figure></p>
<p>最后才想到，可能是内存不够了。由于是以vagrant启动的一台ubuntu14.04的虚拟机，默认只有500M的内存。而且该项目会用到一些底层的npm包，会编译一些代码。这就导致了内存不够用。<br>可以查一下相应的系统log，在路径 <code>/var/log</code>之下，确认自己的问题。如<code>/var/log/syslog</code> 和 <code>/var/log/messages</code>等。</p>
<h3 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h3><h4 id="1-增大内存。"><a href="#1-增大内存。" class="headerlink" title="1. 增大内存。"></a>1. 增大内存。</h4><p>由于我是虚拟机，所有增大内存相对简单。在vagrantfile里，只需要增加一条：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">config.vm.provider &quot;virtualbox&quot; do |v|</div><div class="line">  v.memory = 1024</div><div class="line">end</div></pre></td></tr></table></figure></p>
<p>即可。</p>
<h4 id="2-利用swap-file实现虚拟内存"><a href="#2-利用swap-file实现虚拟内存" class="headerlink" title="2. 利用swap file实现虚拟内存"></a>2. 利用swap file实现虚拟内存</h4><p>使用<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo swapon -s</div></pre></td></tr></table></figure></p>
<p>查看系统是否配置了交换区域。没有的话， 便直接开始创建swap file。<br>创建一个1G的文件。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo fallocate -l 1G /swapfile</div></pre></td></tr></table></figure></p>
<p>使用<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ls -lh /swapfile</div></pre></td></tr></table></figure></p>
<p>确认是否是自己所需要的文件大小。</p>
<p><strong>启用Swap文件</strong><br>首先调整文件的权限，若该文件能被其他用户随意的读写，则会产生很大的安全隐患。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo chmod 600 /swapfile</div></pre></td></tr></table></figure></p>
<p>现在安全多了，可以让系统开始设置交换区域了。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo mkswap /swapfile</div></pre></td></tr></table></figure></p>
<p>启用该文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo swapon /swapfile</div></pre></td></tr></table></figure></p>
<p>现在基本的步骤已经完成了，可以使用最初的命令验证swap file是否正确使用。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">sudo swapon -s</div><div class="line"></div><div class="line">Filename                    Type          Size     Used     Priority</div><div class="line">/swapfile                               file          1048572     0     -1</div></pre></td></tr></table></figure></p>
<p>交换分区已经成功设置，系统会在必要的时候使用它。</p>
<p><strong>注意</strong><br>现在已经启用了swap文件，但当我们重启的时候，系统不会自动地启用该swap文件。可以通过修改<code>fstab</code>文件实现开机使用swap文件。<br>用root权限编辑<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo vim /etc/fstab</div></pre></td></tr></table></figure></p>
<p>在文件的最后，需要添加一行告诉操作系统自动使用swap文件。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/swapfile   none    swap    sw    0   0</div></pre></td></tr></table></figure></p>
<p>如此再<code>npm install</code> 的时候，便解决了所有的问题了。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;在接手一个Node项目的时候，&lt;code&gt;npm install&lt;/code&gt;。却出现了”killed”的错误。以为是Node版本的问题，熟练地切换了0.11与0.10版，同样无解。&lt;br&gt;由于新的npm版本吧，&lt;code&gt;npm install&lt;/code&gt;的时候已经无法
    
    </summary>
    
    
      <category term="npm" scheme="http://owenyang0.github.io/tags/npm/"/>
    
      <category term="npm install" scheme="http://owenyang0.github.io/tags/npm-install/"/>
    
      <category term="killed" scheme="http://owenyang0.github.io/tags/killed/"/>
    
      <category term="memory" scheme="http://owenyang0.github.io/tags/memory/"/>
    
      <category term="npm install killed" scheme="http://owenyang0.github.io/tags/npm-install-killed/"/>
    
  </entry>
  
  <entry>
    <title>React JS快速开始手册</title>
    <link href="http://owenyang0.github.io/2015/01/17/The-React-Quick-Start-Guide/"/>
    <id>http://owenyang0.github.io/2015/01/17/The-React-Quick-Start-Guide/</id>
    <published>2015-01-17T03:19:11.000Z</published>
    <updated>2016-08-15T09:00:19.000Z</updated>
    
    <content type="html"><![CDATA[<p>怎样用React JS构建一个用户界面？本文将快速地给你一个React JS的概览。代码，请君移步<a href="https://github.com/owenyang0/react-starter" target="_blank" rel="external">react-starter</a></p>
<h2 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h2><p>React只有很少的API，这使得它很容易去学习与理解。当然，使用它也是相当有意思的。但是，简约却并不简单。在我们开始之前，有一些概念是需要去理解的。</p>
<h3 id="React元素-React-elements"><a href="#React元素-React-elements" class="headerlink" title="React元素(React elements)"></a>React元素(React elements)</h3><p>React元素是用于呈现HTML结构的JavaScript对象。它们不会存在于浏览器中，只是用于描述浏览器中的元素，比如<code>h1</code>, <code>div</code> 或者 <code>section</code>等等。</p>
<h3 id="模块-Components"><a href="#模块-Components" class="headerlink" title="模块(Components)"></a>模块(Components)</h3><p>模块是开发者创建的React元素。它们通过比用户界面的范围要大，因为它们同时包含了其结构与功能。想像一下导航栏，点赞按钮，图片上传这些模块的概念。</p>
<h3 id="JSX"><a href="#JSX" class="headerlink" title="JSX"></a>JSX</h3><p>JSX是一种用于创建React元素和模块的技术，或者说是规范、语言。比如 <code>&lt;h1&gt;Hello&lt;/h1&gt;</code> 便是一个用JSX所写的React元素。同样的React元素，可以用原生的JavaScript实现，即 <code>React.DOM.h1(null, &#39;Hello&#39;);</code>。相比原生的JavaScript，JSX更加简洁。会让你花更少的精力去读和写代码，在上线的时候将其转换成原生的JavaScript即可。</p>
<h3 id="虚拟DOM-Virtual-DOM"><a href="#虚拟DOM-Virtual-DOM" class="headerlink" title="虚拟DOM(Virtual DOM)"></a>虚拟DOM(Virtual DOM)</h3><p>虚拟DOM是一个JavaScript的树形结构，包含了React元素和模块。React通过渲染虚拟DOM到浏览器，使得用户界面得以显示。React也会观察虚拟DOM的变化，根据虚拟DOM自动地改变浏览器DOM元素。</p>
<p>了解了这些概念之后，我们就可以畅快地敲React代码了。这里将会创建一系列的用户界面，每一个界面都将提前添加一层功能层。我们会做一个类似instagram的应用 - 当然，这个很粗糙。</p>
<h2 id="渲染-Rendering"><a href="#渲染-Rendering" class="headerlink" title="渲染(Rendering)"></a>渲染(Rendering)</h2><p>业务的第一步是渲染一个虚拟的元素(React元素或者模块都可以)。由于每一个虚拟元素都存在于内存之中，所以我们必须显式地告诉React，将其渲染到浏览器的DOM之中。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">React.render(&lt;img src='http://owenyang0.github.io/img/background.jpg' /&gt;, document.body);</div></pre></td></tr></table></figure>
<p><code>render</code> 函数接受两个参数，一个是虚拟元素，一个是真实的DOM节点。React就是获取到虚拟元素之后，将其插入到所给的节点之中。此时，在浏览器中便可以看到照片了。</p>
<h2 id="模块-Components-1"><a href="#模块-Components-1" class="headerlink" title="模块(Components)"></a>模块(Components)</h2><p>模块是React的核心与灵魂。它们可以自定义React元素。经常由单一的功能或者结构扩展而来。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> Photo = React.createClass(&#123;</div><div class="line"></div><div class="line">  render: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> &lt;img src='http://owenyang0.github.io/img/background.jpg' /&gt;</div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">React.render(&lt;Photo /&gt;, document.body);</div></pre></td></tr></table></figure>
<p><code>createClass</code> 函数接受一个对象，该对象实现了<code>render</code> 的函数。<br>这个<code>Photo</code>模块被构建好，<code>&lt;Photo /&gt;</code>，然后渲染到document body中。<br>该模块并没有比上一个React图像元素做更多的事情，但这却更加有利于在功能和结构上进行扩展。</p>
<h2 id="属性-Props"><a href="#属性-Props" class="headerlink" title="属性(Props)"></a>属性(Props)</h2><p>属性可以认为是模块的一些配置选项。它们以参数(arguments)的形式传递给模块，看起来就像HTML的属性(attributes)。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> Photo = React.createClass(&#123;</div><div class="line"></div><div class="line">  render: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      &lt;div className='photo'&gt;</div><div class="line">        &lt;img src=&#123;this.props.imageURL&#125; /&gt;</div><div class="line">        &lt;span&gt;&#123;this.props.caption&#125;&lt;/span&gt;</div><div class="line">      &lt;/div&gt;</div><div class="line">    )</div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">React.render(&lt;Photo imageURL='http://owenyang0.github.io/img/background.jpg' caption='Headset' /&gt;, document.body);</div></pre></td></tr></table></figure>
<p>在<code>render</code> 函数里面，两个属性(props)传到了<code>Photo</code>模块，<code>imageURL</code> 和 <code>caption</code>。<code>imageURL</code>属性被用作React元素中的<code>src</code>。而<code>caption</code>属性则以纯文本的方式在React中的span元素使用。</p>
<p>值得一提的是，模块永远不应该去改变属性的的值，它们是不可变的。如果一个模块有一个可变的数据，那应该应用使用状态对象(state object)。</p>
<h2 id="状态-State"><a href="#状态-State" class="headerlink" title="状态(State)"></a>状态(State)</h2><p>状态对象是一个模块的内部对象。它会持有可变的数据。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> Photo = React.createClass(&#123;</div><div class="line"></div><div class="line">  toggleLiked: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">this</span>.setState(&#123;</div><div class="line">      liked: !<span class="keyword">this</span>.state.liked</div><div class="line">    &#125;);</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  getInitialState: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">      liked: <span class="literal">false</span></div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  render: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> buttonClass = <span class="keyword">this</span>.state.liked ? <span class="string">'active'</span> : <span class="string">''</span>;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      &lt;div className='photo'&gt;</div><div class="line">        &lt;img src=&#123;this.props.src&#125; /&gt;</div><div class="line"></div><div class="line">        &lt;div className='bar'&gt;</div><div class="line">          &lt;button onClick=&#123;this.toggleLiked&#125; className=&#123;buttonClass&#125;&gt;</div><div class="line">            ♥</div><div class="line">          &lt;/button&gt;</div><div class="line">          &lt;span&gt;&#123;this.props.caption&#125;&lt;/span&gt;</div><div class="line">        &lt;/div&gt;</div><div class="line">      &lt;/div&gt;</div><div class="line">    )</div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">React.render(&lt;Photo src='http://owenyang0.github.io/img/background.jpg' caption='Headset'/&gt;, document.body);</div></pre></td></tr></table></figure>
<p>在模块中引入状态，会增加一点点的复杂度。</p>
<p>在这模块中，有一个新的函数<code>getInitialState</code>。当模块初始化的时候，React会调用这个函数。而返回的对象则作为React的初始化状态(看函数名就知道)。<br>还有一个新的函数叫<code>toggleLiked</code>。这个函数调用了模块上的setState方法，可以改变状态<code>liked</code>的值。<br>通过模块的render函数，变量<code>buttonClass</code>被赋值成了’active’或者空，这都依赖于<code>liked</code>状态。<br><code>buttonClass</code>是React按钮元素的class名字。按钮还拥有一个<code>onClick</code>的事件回调，指向<code>toggleLiked</code>函数。</p>
<p>当模块渲染成浏览器DOM的时候，究竟发生全过程：</p>
<ul>
<li>当按钮点击被触发时，调用了<code>toggleLiked</code></li>
<li><code>liked</code>的状态被改变</li>
<li>React将模块再次渲染成虚拟DOM</li>
<li>新的虚拟DOM与旧的虚拟DOM相比较</li>
<li>React将改变的部分隔离，然后更新到浏览器DOM</li>
</ul>
<p>在这个场景中，React会改变button上的类名。</p>
<h2 id="组合-Composition"><a href="#组合-Composition" class="headerlink" title="组合(Composition)"></a>组合(Composition)</h2><p>组合的意思是说，将小的分散的模块组成一个大的整体。比如<code>Photo</code>模块可以在<code>PhotoGallery</code>中使用：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> Photo = React.createClass(&#123;</div><div class="line"></div><div class="line">  toggleLiked: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">this</span>.setState(&#123;</div><div class="line">      liked: !<span class="keyword">this</span>.state.liked</div><div class="line">    &#125;);</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  getInitialState: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">      liked: <span class="literal">false</span></div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  render: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> buttonClass = <span class="keyword">this</span>.state.liked ? <span class="string">'active'</span> : <span class="string">''</span>;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      &lt;div className='photo'&gt;</div><div class="line">        &lt;img src=&#123;this.props.src&#125; /&gt;</div><div class="line"></div><div class="line">        &lt;div className='bar'&gt;</div><div class="line">          &lt;button onClick=&#123;this.toggleLiked&#125; className=&#123;buttonClass&#125;&gt;</div><div class="line">            ♥</div><div class="line">          &lt;/button&gt;</div><div class="line">          &lt;span&gt;&#123;this.props.caption&#125;&lt;/span&gt;</div><div class="line">        &lt;/div&gt;</div><div class="line">      &lt;/div&gt;</div><div class="line">    )</div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">var PhotoGallery = React.createClass(&#123;</div><div class="line"></div><div class="line">  getDataFromServer: function() &#123;</div><div class="line">    return [&#123;</div><div class="line">      url: 'http://owenyang0.github.io/img/background.jpg',</div><div class="line">      caption: 'Headset'</div><div class="line">    &#125;,</div><div class="line">    &#123;</div><div class="line">      url: 'http://owenyang0.github.io/images/mocha.png',</div><div class="line">      caption: 'Mocha'</div><div class="line">    &#125;,</div><div class="line">    &#123;</div><div class="line">      url: 'http://owenyang0.github.io/images/catalog.png',</div><div class="line">      caption: 'Catelog'</div><div class="line">    &#125;];</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  render: function() &#123;</div><div class="line">    var data = this.getDataFromServer();</div><div class="line"></div><div class="line">    var photos = data.map(function(photo) &#123;</div><div class="line">      return &lt;Photo src=&#123;photo.url&#125; caption=&#123;photo.caption&#125; /&gt;</div><div class="line">    &#125;);</div><div class="line"></div><div class="line">    return (</div><div class="line">      &lt;div className='photo-gallery'&gt;</div><div class="line">        &#123;photos&#125;</div><div class="line">      &lt;/div&gt;</div><div class="line">    )</div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">React.render(&lt;PhotoGallery /&gt;, document.body);</div></pre></td></tr></table></figure></p>
<p>这个<code>Photo</code>模块完完全全和上面的一样。但新的<code>PhotoGallery</code>模块会生成<code>Photo</code>模块。该场景中，伪造了返回包含三个对象的数组的数据，每一个对象都返回一个url和其标题。通过循环，生成了三个<code>Photo</code>的模块，将最终的返回值插入到<code>render</code>函数之中。</p>
<h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>用React来构建你的用户界面，我想这也差不多了。React的文档手册，包含了所有的细节。强烈推荐大家去读一下。<br>同样的，该文也没有涉及你本地环境安装的细节。<a href="http://facebook.github.io/react/docs/getting-started.html" target="_blank" rel="external">文档</a>都会有的。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;怎样用React JS构建一个用户界面？本文将快速地给你一个React JS的概览。代码，请君移步&lt;a href=&quot;https://github.com/owenyang0/react-starter&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;reac
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://owenyang0.github.io/tags/JavaScript/"/>
    
      <category term="React" scheme="http://owenyang0.github.io/tags/React/"/>
    
      <category term="ReactJS" scheme="http://owenyang0.github.io/tags/ReactJS/"/>
    
      <category term="JS" scheme="http://owenyang0.github.io/tags/JS/"/>
    
      <category term="Facebook" scheme="http://owenyang0.github.io/tags/Facebook/"/>
    
  </entry>
  
  <entry>
    <title>ECMAScript 6中的数组操作方法</title>
    <link href="http://owenyang0.github.io/2015/01/04/ECMAScript-6%E4%B8%AD%E7%9A%84%E6%95%B0%E7%BB%84%E6%93%8D%E4%BD%9C%E6%96%B9%E6%B3%95/"/>
    <id>http://owenyang0.github.io/2015/01/04/ECMAScript-6中的数组操作方法/</id>
    <published>2015-01-04T14:20:25.000Z</published>
    <updated>2016-08-15T09:00:19.000Z</updated>
    
    <content type="html"><![CDATA[<p>本文介绍ECMAScript 6即将带给我们新的数组操作方法，以及在怎样在现有浏览器应用这些新的数组特性。</p>
<p><strong>Note:</strong> 我将使用交替使用构造器(constructor)和类(class)两个术语。</p>
<h2 id="类方法"><a href="#类方法" class="headerlink" title="类方法"></a>类方法</h2><p>数组(Array)自身所拥有的方法。</p>
<h3 id="Array-from-arrayLike-mapFunc-thisArg"><a href="#Array-from-arrayLike-mapFunc-thisArg" class="headerlink" title="Array.from(arrayLike, mapFunc?, thisArg?)"></a>Array.from(arrayLike, mapFunc?, thisArg?)</h3><p><code>Array.from()</code>的基本功能是，转换两种类型的对象成数组。</p>
<blockquote>
<p><strong>类数组对象(Array-like objects)</strong></p>
</blockquote>
<p>该类对象有长度与索引的属性。DOM操作符的结果即属于该类，如<code>document.getElementsByClassName()</code>。</p>
<blockquote>
<p><strong>可迭代对象(Iterable objects)</strong></p>
</blockquote>
<p>这类对象在取值时，每次只能取一个元素。数组是可迭代的，就如ECMAScript中新的数组结构，映射(Map)和集(Set)。</p>
<p>以下代码是一个转换类数组对象到数组的一个示例：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> lis = <span class="built_in">document</span>.querySelectorAll(<span class="string">'ul.fancy li'</span>);</div><div class="line"><span class="built_in">Array</span>.from(lis).forEach(<span class="function"><span class="keyword">function</span> (<span class="params">li</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(node);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p><code>querySelectorAll()</code>的结果不是一个数组，也不会有<code>forEach()</code>这个方法。这是我们需要在使用这个方法之前，将它转换成数组的原因。</p>
<p><strong>通过Array.from()使用Mapping</strong><br><code>Array.from()</code>同样也是一个泛型使用<code>map()</code>的替代选择。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> spans = <span class="built_in">document</span>.querySelectorAll(<span class="string">'span.name'</span>);</div><div class="line"></div><div class="line"><span class="comment">// map(), generically:</span></div><div class="line"><span class="keyword">let</span> names1 = <span class="built_in">Array</span>.prototype.map.call(spans, s =&gt; s.textContent);</div><div class="line"></div><div class="line"><span class="comment">// Array.from():</span></div><div class="line"><span class="keyword">let</span> names2 = <span class="built_in">Array</span>.from(spans, s =&gt; s.textContent);</div></pre></td></tr></table></figure>
<p>两个方法中的第二个参数，都是箭头函数(arrow function)。<br>在这个示例中，<code>document.querySelectorAll()</code>的结果又是一个类数组对象，而非数组。这就是我们不能直接调用<code>map()</code>的原因。第一个示例中，为了使用<code>forEach()</code>，我们将类数组对象转换成了数组。这里我们通过泛型方法和两个参数版本的<code>Array.from()</code>，而省去了中间步骤。</p>
<p><strong>Holes</strong><br><code>Array.from()</code>会忽略数组里缺失的元素 - 洞(holes)，它会以未定义的元素(undefined elements)进行对待。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; <span class="built_in">Array</span>.from([<span class="number">0</span>,,<span class="number">2</span>])</div><div class="line">[ <span class="number">0</span>, <span class="literal">undefined</span>, <span class="number">2</span> ]</div></pre></td></tr></table></figure>
<p>这就意味着，你可以使用<code>Array.from()</code>来创建或者填充一个数组：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&gt; <span class="built_in">Array</span>.from(<span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">5</span>), () =&gt; <span class="string">'a'</span>)</div><div class="line">[ <span class="string">'a'</span>, <span class="string">'a'</span>, <span class="string">'a'</span>, <span class="string">'a'</span>, <span class="string">'a'</span> ]</div><div class="line">&gt; <span class="built_in">Array</span>.from(<span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">5</span>), (x,i) =&gt; i)</div><div class="line">[ <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span> ]</div></pre></td></tr></table></figure>
<p>如果你想用一个固定的值去填充一个数组，那么<code>Array.prototype.fill()</code>(请看下文)将是一个更好的选择。第一个即是以上示例的两种方式。</p>
<p><strong>在数组(Array)子类中的from()</strong><br>另一个<code>Array.from()</code>的使用场景是，转换类数组对象或可迭代对象到一个数组(Array)子类的一个实例。如你创建了一个Array的子类MyArray，想将此类对象转化成MyArray的一个实例，你就可以简单地使用<code>MyArray.from()</code>。可以这样使用的原因是，在ECMAScript 6中构造器(constructors)会继承下去(父类构造器是它子类构造器的原型(prototype))。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyArray</span> <span class="keyword">extends</span> <span class="title">Array</span> </span>&#123;</div><div class="line">  ...</div><div class="line">&#125;</div><div class="line"><span class="keyword">let</span> instanceOfMyArray = MyArray.from(anIterable);</div></pre></td></tr></table></figure>
<p>你可以将该功能与映射(mapping)结合起来，在一个你控制结果构造器的地方完成映射操作(map operation)：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// from() – determine the result’s constructor via the receiver</span></div><div class="line"><span class="comment">// (in this case, MyArray)</span></div><div class="line"><span class="keyword">let</span> instanceOfMyArray = MyArray.from([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], x =&gt; x * x);</div><div class="line"></div><div class="line"><span class="comment">// map(): the result is always an instance of Array</span></div><div class="line"><span class="keyword">let</span> instanceOfArray   = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].map(x =&gt; x * x);</div></pre></td></tr></table></figure>
<h3 id="Array-of-…items"><a href="#Array-of-…items" class="headerlink" title="Array.of(…items)"></a>Array.of(…items)</h3><p>如果你想将一组值转换成一个数组，你应该使用数组源文本(array literal)。特别是只有一个值且还是数字的时候，数组的构造器便罢工了。更多<a href="http://speakingjs.com/es5/ch18.html#array_constructor" target="_blank" rel="external">信息</a>请参考。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&gt; <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">3</span>, <span class="number">11</span>, <span class="number">8</span>)</div><div class="line">[ <span class="number">3</span>, <span class="number">11</span>, <span class="number">8</span> ]</div><div class="line">&gt; <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">3</span>)</div><div class="line">[ , ,  ,]</div><div class="line">&gt; <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">3.1</span>)</div><div class="line"><span class="built_in">RangeError</span>: Invalid array length</div></pre></td></tr></table></figure>
<p>便如果要将一组值转换成数字子构造器(sub-constructor)的一个实例，我们应该怎么做呢？这就是<code>Array.of()</code>存在的价值(记住，数组子构造器会继承所有的数组方法，当然也包括<code>of()</code>)。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyArray</span> <span class="keyword">extends</span> <span class="title">Array</span> </span>&#123;</div><div class="line">  ...</div><div class="line">&#125;</div><div class="line"><span class="built_in">console</span>.log(MyArray.of(<span class="number">3</span>, <span class="number">11</span>, <span class="number">8</span>) <span class="keyword">instanceof</span> MyArray); <span class="comment">// true</span></div><div class="line"><span class="built_in">console</span>.log(MyArray.of(<span class="number">3</span>).length === <span class="number">1</span>); <span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>把值包裹嵌套在数组里，<code>Array.of()</code>会相当方便，而不会有<code>Array()</code>一样怪异的处理方式。但也要注意<code>Array.prototype.map()</code>，此处有坑：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&gt; [<span class="string">'a'</span>, <span class="string">'b'</span>].map(<span class="built_in">Array</span>.of)</div><div class="line">[ [ <span class="string">'a'</span>, <span class="number">0</span>, [ <span class="string">'a'</span>, <span class="string">'b'</span> ] ],</div><div class="line">[ <span class="string">'b'</span>, <span class="number">1</span>, [ <span class="string">'a'</span>, <span class="string">'b'</span> ] ] ]</div><div class="line">&gt; [<span class="string">'a'</span>, <span class="string">'b'</span>].map(x =&gt; <span class="built_in">Array</span>.of(x)) <span class="comment">// better</span></div><div class="line">[ [ <span class="string">'a'</span> ], [ <span class="string">'b'</span> ] ]</div><div class="line">&gt; [<span class="string">'a'</span>, <span class="string">'b'</span>].map(x =&gt; [x]) <span class="comment">// best (in this case)</span></div><div class="line">[ [ <span class="string">'a'</span> ], [ <span class="string">'b'</span> ] ]</div></pre></td></tr></table></figure>
<p>如你所看，<code>map()</code>会传递三个参数到它的回调里面。最后两个又是经常被忽略的(<a href="http://speakingjs.com/es5/ch15.html#_pitfall_unexpected_optional_parameters" target="_blank" rel="external">详细</a>)。</p>
<h2 id="原型方法-Prototype-methods"><a href="#原型方法-Prototype-methods" class="headerlink" title="原型方法(Prototype methods)"></a>原型方法(Prototype methods)</h2><p>数组的实例会有很多新的方法可用。</p>
<h3 id="数组里的迭代-Iterating-over-arrays"><a href="#数组里的迭代-Iterating-over-arrays" class="headerlink" title="数组里的迭代(Iterating over arrays)"></a>数组里的迭代(Iterating over arrays)</h3><p>以下的方法，会帮助完成在数组里的迭代：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Array</span>.prototype.entries()</div><div class="line"><span class="built_in">Array</span>.prototype.keys()</div><div class="line"><span class="built_in">Array</span>.prototype.values()</div></pre></td></tr></table></figure>
<p>以上的每一个方法都会返回一串值，却不会作为一个数组返回。它们会通过迭代器，一个接一个的显示。让我们看一个示例(我将使用<code>Array.from()将迭代器的内容放在数组中</code>)：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&gt; <span class="built_in">Array</span>.from([ <span class="string">'a'</span>, <span class="string">'b'</span> ].keys())</div><div class="line">[ <span class="number">0</span>, <span class="number">1</span> ]</div><div class="line">&gt; <span class="built_in">Array</span>.from([ <span class="string">'a'</span>, <span class="string">'b'</span> ].values())</div><div class="line">[ <span class="string">'a'</span>, <span class="string">'b'</span> ]</div><div class="line">&gt; <span class="built_in">Array</span>.from([ <span class="string">'a'</span>, <span class="string">'b'</span> ].entries())</div><div class="line">[ [ <span class="number">0</span>, <span class="string">'a'</span> ],</div><div class="line">[ <span class="number">1</span>, <span class="string">'b'</span> ] ]</div></pre></td></tr></table></figure>
<p>你可以结合<code>entries()</code>和ECMAScript 6中的<code>for-of</code>循环，方便地将迭代对象拆解成key-value对：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> [index, elem] <span class="keyword">of</span> [<span class="string">'a'</span>, <span class="string">'b'</span>].entries()) &#123;</div><div class="line">  <span class="built_in">console</span>.log(index, elem);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>Note:</strong> 这段代码已经可以在最新的Firefox浏览器里运行了。t Firefox.</p>
<h3 id="查找数组元素"><a href="#查找数组元素" class="headerlink" title="查找数组元素"></a>查找数组元素</h3><p><code>Array.prototype.find(predicate, thisArg?)</code> 会返回满足回调函数的第一个元素。如果没有任何一个元素满足条件，它会返回<code>undefined</code>。比如：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&gt; [<span class="number">6</span>, <span class="number">-5</span>, <span class="number">8</span>].find(x =&gt; x &lt; <span class="number">0</span>)</div><div class="line"><span class="number">-5</span></div><div class="line">&gt; [<span class="number">6</span>, <span class="number">5</span>, <span class="number">8</span>].find(x =&gt; x &lt; <span class="number">0</span>)</div><div class="line"><span class="literal">undefined</span></div></pre></td></tr></table></figure>
<p><code>Array.prototype.findIndex(predicate, thisArg?)</code><br>会返回满足回调函数的第一个元素的索引。如果找不任何满足的元素，则返回-1。比如：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&gt; [<span class="number">6</span>, <span class="number">-5</span>, <span class="number">8</span>].findIndex(x =&gt; x &lt; <span class="number">0</span>)</div><div class="line"><span class="number">1</span></div><div class="line">&gt; [<span class="number">6</span>, <span class="number">5</span>, <span class="number">8</span>].findIndex(x =&gt; x &lt; <span class="number">0</span>)</div><div class="line"><span class="number">-1</span></div></pre></td></tr></table></figure>
<p>两个find*方法都会忽略洞(holes)，即不会关注undefined的元素。回调的完成函数签名是：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">predicate(element, index, array)</div></pre></td></tr></table></figure>
<p><strong>通过findIndex()找NaN</strong></p>
<p><code>Array.prototype.indexOf()</code>有一个大家所熟知的限制，那就是不能查找NaN。因为它用恒等(===)查找匹配元素：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; [<span class="literal">NaN</span>].indexOf(<span class="literal">NaN</span>)</div><div class="line"><span class="number">-1</span></div></pre></td></tr></table></figure>
<p>使用<code>findIndex()</code>，你就可以使用<code>Object.is()</code>，这就不会产生这样的问题：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; [<span class="literal">NaN</span>].findIndex(y =&gt; <span class="built_in">Object</span>.is(<span class="literal">NaN</span>, y))</div><div class="line"><span class="number">0</span></div></pre></td></tr></table></figure>
<p>你同样也可以采用更通用的方式，创建一个帮助函数<code>elemIs()</code>：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&gt; <span class="function"><span class="keyword">function</span> <span class="title">elemIs</span>(<span class="params">x</span>) </span>&#123; <span class="keyword">return</span> <span class="built_in">Object</span>.is.bind(<span class="built_in">Object</span>, x) &#125;</div><div class="line">&gt; [<span class="literal">NaN</span>].findIndex(elemIs(<span class="literal">NaN</span>))</div><div class="line"><span class="number">0</span></div></pre></td></tr></table></figure>
<h3 id="Array-prototype-fill-value-start-end"><a href="#Array-prototype-fill-value-start-end" class="headerlink" title="Array.prototype.fill(value, start?, end?)"></a>Array.prototype.fill(value, start?, end?)</h3><p>用所给的数值，填充一个数组：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>].fill(<span class="number">7</span>)</div><div class="line">[ <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span> ]</div></pre></td></tr></table></figure>
<p>洞(Holes)也不会有任何的特殊对待：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">3</span>).fill(<span class="number">7</span>)</div><div class="line">[ <span class="number">7</span>, <span class="number">7</span>, <span class="number">7</span> ]</div></pre></td></tr></table></figure>
<p>你也可以限制你填充的起始与结束：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>].fill(<span class="number">7</span>, <span class="number">1</span>, <span class="number">2</span>)</div><div class="line">[ <span class="string">'a'</span>, <span class="number">7</span>, <span class="string">'c'</span> ]</div></pre></td></tr></table></figure>
<h2 id="什么时候可以使用新的数组方法？"><a href="#什么时候可以使用新的数组方法？" class="headerlink" title="什么时候可以使用新的数组方法？"></a>什么时候可以使用新的数组方法？</h2><p>有一些方法已经可以在浏览器里使用了。通过，你可以通过kangax查看兼容性<a href="http://kangax.github.io/compat-table/es6/" target="_blank" rel="external">ECMAScript 6 compatibility table</a>。</p>
<p>Paul Miller的 <a href="https://github.com/paulmillr/es6-shim" target="_blank" rel="external">es6-shim</a>库可以将ES6转换成ES5。</p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul>
<li><a href="http://www.2ality.com/2014/05/es6-array-methods.html" target="_blank" rel="external">http://www.2ality.com/2014/05/es6-array-methods.html</a></li>
<li><a href="http://speakingjs.com/es5/ch18.html#array_holes" target="_blank" rel="external">Holes in Arrays</a> (Speaking JavaScript)</li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;本文介绍ECMAScript 6即将带给我们新的数组操作方法，以及在怎样在现有浏览器应用这些新的数组特性。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt; 我将使用交替使用构造器(constructor)和类(class)两个术语。&lt;/p&gt;
&lt;h2 id=&quot;类方
    
    </summary>
    
    
      <category term="ES6" scheme="http://owenyang0.github.io/tags/ES6/"/>
    
      <category term="JavaScript" scheme="http://owenyang0.github.io/tags/JavaScript/"/>
    
      <category term="ECMAScript 6" scheme="http://owenyang0.github.io/tags/ECMAScript-6/"/>
    
      <category term="Array" scheme="http://owenyang0.github.io/tags/Array/"/>
    
  </entry>
  
  <entry>
    <title>Ubuntu上的Git Server</title>
    <link href="http://owenyang0.github.io/2014/12/24/Ubuntu%E4%B8%8A%E7%9A%84Git-Server/"/>
    <id>http://owenyang0.github.io/2014/12/24/Ubuntu上的Git-Server/</id>
    <published>2014-12-24T12:48:00.000Z</published>
    <updated>2016-08-15T09:00:19.000Z</updated>
    
    <content type="html"><![CDATA[<p>Git是一个开源的版本控制系统，由Linus Torvalds主导，用于支持Linux内核开发。每一个Git工作目录，都是一个完整的代码库，包含所有的提交历史。有能力跟踪所有的代码版本，而不会去依赖于网络与中央服务器。</p>
<h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><p>Git可以通过以下的命令进行安装<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apt-get install git</div></pre></td></tr></table></figure></p>
<h3 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h3><p>每一个git的用户，在第一次使用的时候都需要通过以下两个命令，进行相应的配置</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git config --global user.email <span class="string">"you@example.com"</span></div><div class="line">git config --global user.name <span class="string">"Your Name"</span></div></pre></td></tr></table></figure>
<h3 id="基本用法"><a href="#基本用法" class="headerlink" title="基本用法"></a>基本用法</h3><p>假设用户可以通过SSH的方式访问Server，对于用户想以分布式以及安全的方式使用Git，则已经完全足够了。在服务器端，创建一个新的仓库。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git init --bare /path/to/repository</div></pre></td></tr></table></figure></p>
<p>这会创建一个裸仓库，它不允许我们直接编辑相应的文件。如果你需要在服务器端保留仓库内容的复本，去掉 –bare 选项就好了。</p>
<p>任何具有SSH权限的客户端，均可以克隆相应的仓库<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git clone username@hostname:/path/to/repository</div></pre></td></tr></table></figure></p>
<p>一旦克隆到了客户端上，用户即可编辑相应的文件，然后提交得分享相应的代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">cd /path/to/repository # 进入目录，编辑</div><div class="line">git commit -a # 提交所有修改到本地仓库</div><div class="line">git push origin master # 推送修改到服务器端的仓库</div></pre></td></tr></table></figure></p>
<h3 id="安装-gitolite-server"><a href="#安装-gitolite-server" class="headerlink" title="安装 gitolite server"></a>安装 gitolite server</h3><p>虽然以上的那些，对于创建，克隆和修改仓库已经足够。但用户在服务器端安装git，最主要是想要一个传统的源代码控制管理服务器，具有多用户与权限管理的功能。推荐的解决方案是通过以下命令，安装 gitolite server：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apt-get install gitolite</div></pre></td></tr></table></figure></p>
<h3 id="配置-gitolite"><a href="#配置-gitolite" class="headerlink" title="配置 gitolite"></a>配置 gitolite</h3><p>相比于大多数的类Unix系统，gitolite server的配置有一些小小的区别。传统的配置文件会存放在 /etc 的目录之下，而gitolite则把自己的配置文件放在一个git的仓库之中。配置一个新的gitolite的第一步，则需要有配置仓库的访问权限。<br>首先，让我们为gitolite创建一个用户，并具体其访问权限。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo adduser --system --shell /bin/bash --group --disabled-password --home /home/git git</div></pre></td></tr></table></figure></p>
<p>现在我们想让gitolite知晓仓库管理员的SSH公钥。我们假设当前用户是仓库的管理员。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cp ~/.ssh/id_rsa.pub /tmp/$(whoami).pub</div></pre></td></tr></table></figure></p>
<p>我们切换到git用户，并将管理员的公钥导入gitolite。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">sudo su - git</div><div class="line">gl-setup /tmp/*.pub</div></pre></td></tr></table></figure></p>
<p>Gitolite会允许在安装过程中，对配置文件做一些初期的修改。你现在可以通过管理员用户(即拥有管理员公钥的帐户)，克隆和修改gitolite的配置仓库。切回到管理员账号，克隆配置仓库：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">exit</div><div class="line">git clone git@$IP_ADDRESS:gitolite-admin.git</div><div class="line">cd gitolite-admin</div></pre></td></tr></table></figure></p>
<p>gitolite-admin目录包含两个子目录，conf 和 keydir。配置文件存放在 conf目录，而keydir目录存放了用户的公钥信息。</p>
<h3 id="管理gitolite帐户和仓库"><a href="#管理gitolite帐户和仓库" class="headerlink" title="管理gitolite帐户和仓库"></a>管理gitolite帐户和仓库</h3><p>添加一个新的帐户到gitolite很简单：只需要获取用户的SSH公钥信息，以$DESIRED_USER_NAME.pub 的形式放在keydir目录之下即可。值得注意的是，gitolite的用户名不必和系统的用户名相匹配，它们仅仅是用在gitolite的配置文件之中，管理其访问权限的。同样的，删除用户只需要删除其对应的公钥文件即可。所有修改完毕之后，别忘了提交相应的修改，然后通过以下命令推回服务器端：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git commit -a</div><div class="line">git push origin master</div></pre></td></tr></table></figure></p>
<p>仓库是需要编辑conf/gitolite.conf文件进行管理。通过空格分割，遵守相应的权限规则，指定相应的仓库即可。以下是一些默认的示例。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">repo    gitolite-admin</div><div class="line">        RW+     =   admin</div><div class="line">        R       =   alice</div><div class="line">repo    project1</div><div class="line">        RW+     =   alice</div><div class="line">        RW      =   bob</div><div class="line">        R       =   denise</div></pre></td></tr></table></figure>
<h3 id="使用服务器"><a href="#使用服务器" class="headerlink" title="使用服务器"></a>使用服务器</h3><p>要使用新创建的帐户，用户需要gitolite的管理员将其公钥导入到gitolite的配置仓库之中。然后，用户即可拥有相应的项目权限：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git clone git@$SERVER_IP:$PROJECT_NAME.git</div></pre></td></tr></table></figure></p>
<p>或者为一个已存在的git仓库添加一个远程地址：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git remote add gitolite git@$SERVER_IP:$PROJECT_NAME.git</div></pre></td></tr></table></figure></p>
<p>如此便搭好了一个简易的，可用的git server。为了更好的查看相应的代码，或者管理，也可使用相对较重的，gitlab开源项目。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Git是一个开源的版本控制系统，由Linus Torvalds主导，用于支持Linux内核开发。每一个Git工作目录，都是一个完整的代码库，包含所有的提交历史。有能力跟踪所有的代码版本，而不会去依赖于网络与中央服务器。&lt;/p&gt;
&lt;h3 id=&quot;安装&quot;&gt;&lt;a href=&quot;#安
    
    </summary>
    
    
      <category term="ubuntu" scheme="http://owenyang0.github.io/tags/ubuntu/"/>
    
      <category term="git" scheme="http://owenyang0.github.io/tags/git/"/>
    
      <category term="git server" scheme="http://owenyang0.github.io/tags/git-server/"/>
    
      <category term="gitolite" scheme="http://owenyang0.github.io/tags/gitolite/"/>
    
  </entry>
  
  <entry>
    <title>css - position relative与display table-cell深入分析</title>
    <link href="http://owenyang0.github.io/2014/12/14/css-position-relative%E4%B8%8Edisplay-table-cell%E6%B7%B1%E5%85%A5%E5%88%86%E6%9E%90/"/>
    <id>http://owenyang0.github.io/2014/12/14/css-position-relative与display-table-cell深入分析/</id>
    <published>2014-12-14T07:44:18.000Z</published>
    <updated>2016-08-15T09:00:19.000Z</updated>
    
    <content type="html"><![CDATA[<p>在很多时候，想使用 <code>display: table;</code> 以及其子元素使用 <code>display: table-cell</code> 都只是为了使用 <code>vertical-align</code> 这一属性。这是一个很简单的常识，但这次在项目上使用却产生意想不到的表现方式。</p>
<p>因为我在其中又使用了 <code>position: relative;</code> 这样一个属性。同样是一个很简单而标准的属性，我想即使放在一起，肯定也是可以正常工作的。可惜，我错了。</p>
<h2 id="缘起"><a href="#缘起" class="headerlink" title="缘起"></a>缘起</h2><p>就这样的一个简单的样式场景，</p>
<p><strong>Chrome</strong><br><img src="/images/lists.png" alt="lists"><br><strong>FireFox</strong><br><img src="/images/lists-ff.png" alt="lists"></p>
<p>看着两个图不一样，很难受是吧？开始的时候，即用的是 <code>vertical-align: top;</code> 使用 <code>position: relative;</code>去修这样一个位置。因为icon没有 <code>padding</code>，而文字却是有 <code>line-height</code> 的。直接使用vertical-align: top; 是不够雅观的，必须往下移大概3个px。我就用position: relative; 去调整了一下(当然，使用 <code>padding-top: 3px;</code>的话，就没这么多的后话了)。</p>
<p>做为一个开发者，一般说来都会习惯用Chrome或者FF调试自己的样式。而幸运的是，我用的是Chrome，Chrome对很多东西都支持很好，我用了position: relative; 在Chrome调好了样式。这就导致了在Chrome上很好的东西，到其他浏览器的时候会丑得像一堆X一样。到FF上的时候，发现这些位置根本不工作。</p>
<h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><p>客户的代码还是就算了，随便写个demo代码吧。<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"table"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"cell"</span>&gt;</span>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.<span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"cell cell-icon"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.table</span> &#123;</div><div class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#ccc</span>;</div><div class="line">  <span class="attribute">display</span>: table;</div><div class="line">&#125;</div><div class="line"><span class="selector-class">.cell</span> &#123;</div><div class="line">  <span class="attribute">padding</span>: <span class="number">10px</span>;</div><div class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#ccc</span>;</div><div class="line">  <span class="attribute">display</span>: table-cell;</div><div class="line">  <span class="attribute">vertical-align</span>: top;</div><div class="line">&#125;</div><div class="line"><span class="selector-class">.cell-icon</span><span class="selector-pseudo">:before</span> &#123;</div><div class="line">  <span class="attribute">content</span>: <span class="string">"icon"</span>;</div><div class="line">&#125;</div><div class="line"><span class="selector-class">.cell-icon</span> &#123;</div><div class="line">  <span class="attribute">position</span>: relative;</div><div class="line">  <span class="attribute">top</span>: <span class="number">20px</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>目的只是为了让 <code>top: 20px;</code> 工作而已，不用去管它现在是否为业务价值。当然，在客户那里是肯定有价值的。经过测试：</p>
<p><strong>WORK：</strong><br>Chrome |<br>Safari |<br>IE 8+</p>
<p>唯FireFox不行，根本不关心你是否有此(position: relative;)属性。</p>
<h2 id="过程"><a href="#过程" class="headerlink" title="过程"></a>过程</h2><p>遇到这种情况，当然去查找相关资料，最后查到了CSS规范: <a href="http://www.w3.org/TR/CSS21/visuren.html#choose-position" target="_blank" rel="external">choose-position</a>。里面有一句:</p>
<blockquote>
<p>The effect of ‘position:relative’ on table-row-group, table-header-group, table-footer-group, table-row, table-column-group, table-column, table-cell, and table-caption elements is undefined.</p>
</blockquote>
<p>大致一意思就是说：<code>position: relative;</code>在table-cell或者其他table元素下都是不工作的，醒醒吧少年。</p>
<p>实际的情况是：有些浏览器又允许用户在table-cell里使用绝对或者相对定位(在这里可以看到更多详细信息<a href="http://www.w3.org/TR/CSS21/visuren.html#comp-abspos" target="_blank" rel="external">http://www.w3.org/TR/CSS21/visuren.html#comp-abspos</a>)。但浏览器又有权不实现那些开发者想要的规范，毕竟这些都不在W3定义的规范里面。</p>
<p>所以，到这里已经明了了，不是由于FF不给力，而确实是由于规范里面没有这样要求，那么剩下的，我们去寻找真正的解决办法就好了。</p>
<h2 id="解决"><a href="#解决" class="headerlink" title="解决"></a>解决</h2><p><strong>1.</strong><br>以上其实提到过，可以跳过 <code>position: relative;</code>，直接就用 <code>padding-top: 20px;</code> 就好了。但这明显不能满足我们的好奇心。所以，请看方法二。</p>
<p><strong>2.</strong><br>这需要在table-cell里面在包一层，在这层限定这的position就好了。然后，所有浏览器测试一遍，搞定。<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"table"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"cell"</span>&gt;</span>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.<span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"cell"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"cell-icon"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p><a href="http://owenyang0.github.io/Snippets/html/table-cell/">Demo</a></p>
<p>或者有人会觉得简单，我觉得不。这些都只是经验型的东西，如果此前没遇到过，或许你会花很长时间去搞明白到底是怎么一回事。这在所有的事情面前都是一样的。</p>
<p>所以，保持学习，努力填坑。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;在很多时候，想使用 &lt;code&gt;display: table;&lt;/code&gt; 以及其子元素使用 &lt;code&gt;display: table-cell&lt;/code&gt; 都只是为了使用 &lt;code&gt;vertical-align&lt;/code&gt; 这一属性。这是一个很简单的常识，但这次在
    
    </summary>
    
    
      <category term="css" scheme="http://owenyang0.github.io/tags/css/"/>
    
      <category term="table-cell" scheme="http://owenyang0.github.io/tags/table-cell/"/>
    
      <category term="display" scheme="http://owenyang0.github.io/tags/display/"/>
    
      <category term="position" scheme="http://owenyang0.github.io/tags/position/"/>
    
      <category term="relative" scheme="http://owenyang0.github.io/tags/relative/"/>
    
  </entry>
  
  <entry>
    <title>AEM - Adobe CMS 扒坑记之始</title>
    <link href="http://owenyang0.github.io/2014/12/13/AEM-Adobe-CMS-%E6%89%92%E5%9D%91%E8%AE%B0%E4%B9%8B%E5%A7%8B/"/>
    <id>http://owenyang0.github.io/2014/12/13/AEM-Adobe-CMS-扒坑记之始/</id>
    <published>2014-12-13T08:02:06.000Z</published>
    <updated>2016-08-15T09:00:19.000Z</updated>
    
    <content type="html"><![CDATA[<p>AEM是Adobe公司所出的商业内容管理系统，全称<strong>阿豆比体验管理系统</strong>(Adobe Experience Manager)，其前身叫<strong>CQ</strong>，分别有<code>CQ5</code> <code>CQ6</code>两个大版本。它提供了整套的网站内容管理系统解决方案，是一个企业级的重型系统。当然，这套系统在中国几乎没什么人知晓。但在澳洲，这系统几乎在所有金融行业遍地开花了。</p>
<p>基于客户的发展战略，不可避免地开始了<code>AEM</code>的扒坑之旅。不过，此前一直在扒<code>Drupal</code>的坑，再扒一堆坑也无关紧要了。</p>
<h2 id="AEM-技术栈"><a href="#AEM-技术栈" class="headerlink" title="AEM 技术栈"></a>AEM 技术栈</h2><p><img src="/images/cq_technology_stack.png" alt="stack" title="cq5 technology stack"></p>
<h3 id="Apache-Sling"><a href="#Apache-Sling" class="headerlink" title="Apache Sling"></a>Apache Sling</h3><p><code>Apache Sling</code> 是一个以内容为中心的网络框架。其使用Java的内容仓库去存储与管理内容，比如<code>Apache Jackrabbit</code> 和 <code>CRX</code>。</p>
<blockquote>
<ul>
<li>基于<code>REST</code>原则，以内容为导向进行开发</li>
<li>与<code>CQ5</code>(或者说<code>AEM5, 6</code>)天然集成</li>
<li>用于处理<code>HTTP</code>的渲染与<code>数据存储</code>的请求。这是一种新的方式，它将在后台将内容组装，渲染最终将其呈现给用户</li>
<li>能将内容对象与处理数据的组成映射起来</li>
<li>支持服务端与<code>AJAX</code>请求</li>
<li>支持多种脚本语言(比如，JSP, ESP, Ruby等)</li>
<li><em>注</em> <a href="http://incubator.apache.org/projects/sling.html" target="_blank" rel="external">http://incubator.apache.org/projects/sling.html</a> 查看更多关于<code>Sling</code>的信息</li>
</ul>
</blockquote>
<hr>
<h3 id="OSGi-Apache-Felix"><a href="#OSGi-Apache-Felix" class="headerlink" title="OSGi (Apache Felix)"></a>OSGi (Apache Felix)</h3><p>CQ5 内建了基于<code>OSGI R4 服务平台</code>(OSGi Service Platform Release 4) 的应用程序框架。</p>
<blockquote>
<ul>
<li>是一个针对<code>JAVA</code>的动态模块系统</li>
<li>发展自通用中间键。很多第三方的组件可以以bundle的形式进行复用</li>
<li>OSGI的bundle可以包含经编译后的JAVA代码，脚本，或者内容。这些均可根据需要将其加载到相应的仓库，或者对其进行配置等等。</li>
</ul>
</blockquote>
<h2 id="获得软件"><a href="#获得软件" class="headerlink" title="获得软件"></a>获得软件</h2><p>所有需要的，只是一个可独立执行的jar包。由于是商业软件，License是必须的。我们将其放到一个文件夹下，暂且命名为<code>aem-install</code>吧。<br><img src="/images/aem-dir.png" alt="aem-dir" title="AEM directory structure"></p>
<p>关于目录下的 <code>crx-quickstart</code> 是当你启动后，自动生成的。里面包含了，你开发所需要的所有，包含所有的内容，以及配置等等。</p>
<h3 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h3><p>AEM 是一个基于<code>JAVA</code>跨平台的系统，所以<code>OS X</code>, <code>桌面版 Windows</code>, <code>Linux</code>肯定都可以支持啦。</p>
<p>唯一需要注意的是，AEM运行在<code>JAVA 7</code>上。所以如果你是用的<code>JAVA 8</code>，但却装有<code>JAVA 7</code>的话，只需要切换一下<code>JAVA_HOME</code>。将这条命令放在你的 <code>.bashrc</code> 或者<code>.zshrc</code> source一下就搞定啦。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">export JAVA_HOME=`/usr/libexec/java_home -v 1.7`</div></pre></td></tr></table></figure></p>
<h3 id="启动"><a href="#启动" class="headerlink" title="启动"></a>启动</h3><p>好的，一准备工作就绪，那么我们就开始我们的正式启动。比如有趣的是，Adobe提供了两种方法供我们使用。</p>
<blockquote>
<p><strong>1. 控制台</strong></p>
<p>不用说，作为一个职业代码人，我们还是比较喜欢这样的方式的。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">java -Xmx1024M -jar cq-author-p4502.jar -p 4502 -r author</div></pre></td></tr></table></figure>
<p>其中，以下两个参数是可省的，因为默认的参数就是 <strong>端口 4502</strong>，<strong>模式 author</strong>。当然，如果你的电脑足够强大，<strong>-Xmx1024M</strong> 也是可以省的。</p>
<blockquote>
<ul>
<li><code>-p</code>指的是工作端口</li>
<li><code>-r</code>指的是启动模式。常见的模式有<code>author</code> 与 <code>publish</code>两种。当然还有其他的，用得不多就此略过罢</li>
</ul>
</blockquote>
<hr>
<blockquote>
<p><strong>2. GUI 双击</strong></p>
<p>当然，有时为了方便，也可以直接双击<code>cq-author-p4502.jar</code>启动。只是有几个需要注意的地方。</p>
</blockquote>
<p>默认的情况，是以<code>author</code>模式，启动在<code>localhost:4502</code>。但我们可以在启动以前，通过修改jar包的名字，达到不同模式不同端口的效果。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cq-&lt;instance-type&gt;-p&lt;port-number&gt;.jar</div></pre></td></tr></table></figure></p>
<p>比如，修改成<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cq-author-p4502.jar</div></pre></td></tr></table></figure></p>
<p>启动，这就达到了以<code>author</code>模式启动，端口设置在 <code>4502</code>的效果。<br>同理，修改成<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cq-publish-p4503.jar</div></pre></td></tr></table></figure></p>
<p>启动，就将以<code>publish</code>的模式启动，端口是<code>4503</code>。<br>理想的情况是，你需要同时启动两个<code>instance</code>，只需要把jar包和license文件放在相应目录下就可以了。如：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;aem-install&gt;/author</div><div class="line">和</div><div class="line">&lt;aem-install&gt;/publish</div></pre></td></tr></table></figure></p>
<h3 id="就绪"><a href="#就绪" class="headerlink" title="就绪"></a>就绪</h3><p>当AEM启动后，会自动打开浏览器定位到相应的页面。比如，我的是<code>localhost:4502</code>。以<code>admin:admin</code>登陆就可以开始正式的开发之路了。<br><img src="/images/crx_de.png" alt="crx-de" title="crx/de"></p>
<h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>那么就此开始，我们已经扒完了AEM的第一坑了，AEM的填坑之路就正式开始了。接下来几篇，我将着重在开发之上，讲解一下AEM的整个开发流程。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;AEM是Adobe公司所出的商业内容管理系统，全称&lt;strong&gt;阿豆比体验管理系统&lt;/strong&gt;(Adobe Experience Manager)，其前身叫&lt;strong&gt;CQ&lt;/strong&gt;，分别有&lt;code&gt;CQ5&lt;/code&gt; &lt;code&gt;CQ6&lt;/code
    
    </summary>
    
    
      <category term="AEM" scheme="http://owenyang0.github.io/tags/AEM/"/>
    
      <category term="CMS" scheme="http://owenyang0.github.io/tags/CMS/"/>
    
      <category term="Drupal" scheme="http://owenyang0.github.io/tags/Drupal/"/>
    
      <category term="Adobe" scheme="http://owenyang0.github.io/tags/Adobe/"/>
    
      <category term="Experience Management" scheme="http://owenyang0.github.io/tags/Experience-Management/"/>
    
  </entry>
  
  <entry>
    <title>Change Tab Title with JavaScript</title>
    <link href="http://owenyang0.github.io/2014/12/11/Change-Tab-Title-with-JavaScript/"/>
    <id>http://owenyang0.github.io/2014/12/11/Change-Tab-Title-with-JavaScript/</id>
    <published>2014-12-11T02:38:11.000Z</published>
    <updated>2016-08-15T09:00:19.000Z</updated>
    
    <content type="html"><![CDATA[<p>修改tab或者window的标题，是一项较老的实践。<code>Gmail</code> 用它来提示用户新的聊天消息，当有新的page通过<code>AJAX</code>加载的时候，本站同样用它更新<code>tab title</code>。这是怎样做到的呢？当时是通过设置<code>document</code>对象。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">document</span>.title = <span class="string">'Hello!'</span>; <span class="comment">// New title :)</span></div></pre></td></tr></table></figure>
<p>有一个常识性的错误是：你会以为应该去修改 <code>window.title</code>。但实际上，你应该使用<code>document</code>对象，否则你做的肯定是无用的。注意一下，你将会看到：很多时候会用 <code>setInterval</code>来实际更新 <code>document.title</code>，用以引起用户的注意！</p>
<p><strong>原文：</strong><a href="http://davidwalsh.name/change-title-javascript" target="_blank" rel="external">Change Tab Title with JavaScript</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;修改tab或者window的标题，是一项较老的实践。&lt;code&gt;Gmail&lt;/code&gt; 用它来提示用户新的聊天消息，当有新的page通过&lt;code&gt;AJAX&lt;/code&gt;加载的时候，本站同样用它更新&lt;code&gt;tab title&lt;/code&gt;。这是怎样做到的呢？当时是通过
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://owenyang0.github.io/tags/JavaScript/"/>
    
      <category term="Tab" scheme="http://owenyang0.github.io/tags/Tab/"/>
    
  </entry>
  
  <entry>
    <title>JavaScript TDD with Mocha</title>
    <link href="http://owenyang0.github.io/2014/12/04/JavaScript-TDD-with-Mocha/"/>
    <id>http://owenyang0.github.io/2014/12/04/JavaScript-TDD-with-Mocha/</id>
    <published>2014-12-03T16:37:41.000Z</published>
    <updated>2016-08-15T09:00:19.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="开发现状"><a href="#开发现状" class="headerlink" title="开发现状"></a>开发现状</h3><p>当新的版本快要发布的时候，大家都忙于加班，加紧修复BUG1、BUG2。我想这就是很多公司开发的现状。<br>为了不至于让上线的版本挂掉挂掉，少不了就是 <code>人肉测试</code>。<br>在一个项目中，我们会做许许多多各种各样的测试，这些测试都必不可少的。测试是项目成功不可或缺的一部分。但 <code>人肉测试</code> 不在本博的讨论范围。</p>
<p>测试大体分为以下几类</p>
<blockquote>
<ul>
<li>单元测试</li>
<li>集成测试</li>
<li>功能测试</li>
</ul>
</blockquote>
<h3 id="测试驱动开发"><a href="#测试驱动开发" class="headerlink" title="测试驱动开发"></a>测试驱动开发</h3><p>TDD(Test-Driven Development) 从根本上改变了传统的开发模式，它要求你在写代码之前就写好测试，而不仅仅是待你写你代码以后的用作验证的目的。<br>TDD将测试提到了应用设计的阶段，在这期间你应该用你的测试理清你写代码时的思路，我们称作 <code>Tasking</code>.</p>
<p>以下是TDD开发时的基本要点</p>
<blockquote>
<ol>
<li>Tasking (将项目需要拆分成小的task)</li>
<li>Red (写测试代码，让其失败，变红)</li>
<li>Green (写实现代码，让其通过，变绿)</li>
<li>Refactor (重构，消失代码中的bad smell)</li>
<li>Repeat (重复以上步骤)</li>
</ol>
</blockquote>
<p>这就是TDD开发过程中的基本过程，我们就在 “红-绿-红-绿” 中完成我们的软件开发。</p>
<h3 id="JavaScript-TDD"><a href="#JavaScript-TDD" class="headerlink" title="JavaScript TDD"></a>JavaScript TDD</h3><p>笔者将通过编写一个传统游戏的方式，来完成一个 JavaScript TDD 的实践。  </p>
<p><strong>4 digits</strong><br>是一个猜数字游戏。在国外称为公牛和母牛，在中国人们就叫它猜数字。游戏的目标是在八次内用尽可能短的时间猜出一个随机的四位数：</p>
<blockquote>
<ul>
<li>顺序与大小都相同的用 A 表示  </li>
<li>大小相同，但顺序不同用 B 表示</li>
</ul>
</blockquote>
<p><strong>比如</strong> 输入 1234 | 猜数 2156 | 结果 0A2B</p>
<p>这是曾经在文曲星上有过的游戏，网友做过一个GUI版的，大家可以看下截图：<br><img src="/images/digits.png" alt="4digits">   </p>
<p>当然，本文的重点是 JavaScript TDD, 不是去实现一个太过细节逻辑。我们就把需求稍微改写一下：</p>
<blockquote>
<ul>
<li>四位数先给定</li>
<li>仅做算法处理(比较所猜数字与给定数字)</li>
</ul>
</blockquote>
<h4 id="开发准备"><a href="#开发准备" class="headerlink" title="开发准备"></a>开发准备</h4><blockquote>
<ul>
<li>Node  </li>
<li>Mocha</li>
</ul>
</blockquote>
<p>如果不知道 <code>Node</code>, 估计你暂时还不用写 <code>JavaScript</code>。所以，本篇文章可能还不太适合你。</p>
<p><img src="/images/mocha.png" alt="Mocha"><br><a href="http://visionmedia.github.io/mocha/" target="_blank" rel="external">摩卡</a>是一个功能丰富的运行在 <code>Node</code> 和浏览器上的JavaScript测试框架。它允许你使用你任意喜欢的断言库。比如</p>
<blockquote>
<ul>
<li>should.js</li>
<li>chai</li>
<li>expect.js</li>
<li>better-assert</li>
</ul>
</blockquote>
<p>本次工程就选择 <a href="https://github.com/visionmedia/should.js" target="_blank" rel="external">should.js</a>吧，写TDD很优美，下面正式开发我们的TDD之旅。</p>
<h4 id="工程建立"><a href="#工程建立" class="headerlink" title="工程建立"></a>工程建立</h4><pre><code>mkdir -p digits/{src,test}
cd digits
touch src/digits.js test/digitsSpec.js
npm init
npm install -g mocha
npm install should --save-dev
</code></pre><p>工程就是这样搭建完成了，我们可以来看一下目录结构(<br>我把node_modules目录隐藏了)：<br><img src="/images/catalog.png" alt="Catalog"></p>
<p>就这样，我们就可以直接运行</p>
<pre><code>mocha 
</code></pre><p>跑测试了。当然，我们什么代码都没有写，当时没有测试可以跑，所以结果会是一个 <code>0 passing</code>。那我们正式开始吧。</p>
<h4 id="测试代码编写"><a href="#测试代码编写" class="headerlink" title="测试代码编写"></a>测试代码编写</h4><p>先写出我们的第一个测试用例吧。<br>如果输入数字，或者所给数字的长度都不等于4，则返回-1。</p>
<pre><code>var should = require(&apos;should&apos;),
  Digits = require(&apos;../src/digits&apos;).Digits;

describe(&apos;Digits&apos;, function() {
  // Digits.compare(inputNum, givenNum);
  describe(&apos;#compare()&apos;, function() {
    it(&apos;should return -1 when input and given number length isnt 4&apos;, function() {
      Digits.compare(&apos;123&apos;, &apos;&apos;).should.equal(-1);
      Digits.compare(&apos;123&apos;, null).should.equal(-1);
      Digits.compare(&apos;123&apos;, &apos;1234&apos;).should.equal(-1);
      Digits.compare(null, &apos;1234&apos;).should.equal(-1);
    });
  });
});
</code></pre><p>嗯，代码看起来不错，我们尝试着 <code>mocha</code> 跑一下。啊哦，意料之中，变红了：<img src="/images/mocha_error.png" alt="mocha error"></p>
<p>什么原因喃？原来我们根本没有写实现代码，你这不废话么？确实是这样，这就是TDD中的第一步，<strong>红</strong>。接下来，我们就编写一些代码，让它变绿吧。</p>
<h4 id="实现代码编写"><a href="#实现代码编写" class="headerlink" title="实现代码编写"></a>实现代码编写</h4><p>我们定义一个简单的Digits的function吧，通过 <code>exports.Digits = Digits;</code> 将函数接口暴露出去。就像这样：</p>
<pre><code>function Digits() {}

Digits.compare = function(inputNum, givenNum) {
  var len = 4;

  if (inputNum === null ||
    givenNum === null ||
    inputNum.length !== len ||
    givenNum.length !== len) {
    return -1;
  }
}

exports.Digits = Digits;
</code></pre><p>看吧，看起来也很不错的样子，那我们继续跑一下测试吧。啊哈，意料之中，变<strong>绿</strong>了：<img src="/images/mocha_success.png" alt="mocha success"></p>
<h4 id="repeat"><a href="#repeat" class="headerlink" title="repeat"></a>repeat</h4><p>由红变绿之后，这个task也就相当于是完成了。我们又可以按照这样的一个步骤，再写新的测试，然后再将它实现出来。到此为止，一个基本的 JavaScript TDD流程也就完了，趁着热乎劲儿。我们把这个 <code>compare</code> 函数的其他测试也一并写了吧。代码如下：</p>
<p><strong>digitsSepc.js</strong></p>
<pre><code>var should = require(&apos;should&apos;),
  Digits = require(&apos;../src/digits&apos;).Digits;

describe(&apos;Digits&apos;, function() {
  // Digits.compare(inputNum, givenNum);
  describe(&apos;#compare()&apos;, function() {
    it(&apos;should return -1 when input and given number length isnt 4&apos;, function() {
      Digits.compare(&apos;123&apos;, &apos;&apos;).should.equal(-1);
      Digits.compare(&apos;123&apos;, null).should.equal(-1);
      Digits.compare(&apos;123&apos;, &apos;1234&apos;).should.equal(-1);
      Digits.compare(null, &apos;1234&apos;).should.equal(-1);
    });

    it(&apos;should return 4A0B when input numbers matched given numbers&apos;, function() {
      Digits.compare(&apos;1234&apos;, &apos;1234&apos;).should.equal(&apos;4A0B&apos;);
      Digits.compare(&apos;5678&apos;, &apos;5678&apos;).should.equal(&apos;4A0B&apos;);
    });

    it(&apos;should return 2A2B when 2 input numbers matched given numbers, and other 2 exist but not the right order&apos;, function() {
      Digits.compare(&apos;2134&apos;, &apos;1234&apos;).should.equal(&apos;2A2B&apos;);
      Digits.compare(&apos;1324&apos;, &apos;1234&apos;).should.equal(&apos;2A2B&apos;);
      Digits.compare(&apos;3214&apos;, &apos;1234&apos;).should.equal(&apos;2A2B&apos;);
      Digits.compare(&apos;4231&apos;, &apos;1234&apos;).should.equal(&apos;2A2B&apos;);
    });

    it(&apos;should return 2A0B when 2 input numbers matched given numbers, and other 2 was wrong numbers&apos;, function() {
      Digits.compare(&apos;1256&apos;, &apos;1234&apos;).should.equal(&apos;2A0B&apos;);
      Digits.compare(&apos;7238&apos;, &apos;1234&apos;).should.equal(&apos;2A0B&apos;);
      Digits.compare(&apos;7834&apos;, &apos;1234&apos;).should.equal(&apos;2A0B&apos;);
      Digits.compare(&apos;1784&apos;, &apos;1234&apos;).should.equal(&apos;2A0B&apos;);
    });
  });
});
</code></pre><p><strong>digits.js</strong></p>
<pre><code>function Digits() {}

Digits.compare = function(inputNum, givenNum) {
  var len = 4,
    aCount = 0,
    bCount = 0;

  if (inputNum === null ||
    givenNum === null ||
    inputNum.length !== len ||
    givenNum.length !== len) {
    return -1;
  }

  if (inputNum === givenNum) {
    return &apos;4A0B&apos;;
  }

  for (var i = 0; i &lt; len; i++) {
    if (inputNum[i] === givenNum[i]) {
      aCount++;
    } else if (givenNum.indexOf(inputNum[i]) !== -1) {
      bCount++;
    }
  }

  return aCount + &apos;A&apos; + bCount + &apos;B&apos;;
}

exports.Digits = Digits;
</code></pre><p>最后再来跑一遍 <code>mocha -R spec</code>，结果如下(大功告成啦)：<img src="/images/mocha_successes.png" alt="mocha successes"></p>
<h3 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h3><p>大功告成了，此时的你其实可以洗洗睡了，不用再担心你的程序有问题啦。你的测试告诉你，你的程序都是绿色可行的。当然，如果你测试写有的问题就别当别说咯。<br>测试代码会有一些什么好处呢？</p>
<blockquote>
<ul>
<li>测试代码在那里，可以保证你以后修改代码时，或者重构时不会对已有的功能产生影响。</li>
</ul>
</blockquote>
<p>这条是很重要的，也是相当重要的。如果没有测试代码的保证，你无从知道你自己所改的代码，对已有的代码会产生什么样的影响。与其每次上线时都得加班改BUG，为啥不先写好测试，上线时早些洗洗睡了呢？</p>
]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;开发现状&quot;&gt;&lt;a href=&quot;#开发现状&quot; class=&quot;headerlink&quot; title=&quot;开发现状&quot;&gt;&lt;/a&gt;开发现状&lt;/h3&gt;&lt;p&gt;当新的版本快要发布的时候，大家都忙于加班，加紧修复BUG1、BUG2。我想这就是很多公司开发的现状。&lt;br&gt;为了不至于让上线
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://owenyang0.github.io/tags/JavaScript/"/>
    
      <category term="TDD" scheme="http://owenyang0.github.io/tags/TDD/"/>
    
      <category term="Mocha" scheme="http://owenyang0.github.io/tags/Mocha/"/>
    
  </entry>
  
  <entry>
    <title>浅谈JavaScript闭包</title>
    <link href="http://owenyang0.github.io/2014/03/02/%E6%B5%85%E8%B0%88JavaScript%E9%97%AD%E5%8C%85/"/>
    <id>http://owenyang0.github.io/2014/03/02/浅谈JavaScript闭包/</id>
    <published>2014-03-02T15:25:00.000Z</published>
    <updated>2016-08-15T09:00:19.000Z</updated>
    
    <content type="html"><![CDATA[<p>JavaScript函数是将要执行的<strong>代码</strong>及执行这些代码的<strong>作用域</strong>构成的一个综合体。计算机术语称这种代码和作用域的综合体为<strong>闭包</strong>。故所有JavaScript函数都是闭包。但我们常说的JavaScript闭包是指，一个嵌套函数被导出到它所定义的作用域外时，才明确地称为<strong>闭包</strong>。</p>
<h2 id="JavaScript闭包"><a href="#JavaScript闭包" class="headerlink" title="JavaScript闭包"></a>JavaScript闭包</h2><p>闭包是 <code>JavaScript</code> 一个非常重要的特性，这意味着当前作用域总是能够访问外部作用域中的变量。 因为<strong>函数</strong>是 <code>JavaScript</code> 中唯一拥有自身作用域的结构，因此闭包的创建<strong>依赖于</strong>函数。</p>
<h2 id="简单写法"><a href="#简单写法" class="headerlink" title="简单写法"></a>简单写法</h2><p>该函数的私有持久变量，可以被多个函数共享</p>
<pre><code>var uniqueID = (function() {
    // 私有持久值
    var id = 0;
    return function() {
        return id++;
    }
})();
</code></pre><h2 id="循环中的闭包"><a href="#循环中的闭包" class="headerlink" title="循环中的闭包"></a>循环中的闭包</h2><p>一个常见的错误出现在<strong>循环</strong>中使用闭包，开发人员在循环语句里创建函数（内部计数）时经常得不到预期的结果，假设我们需要在每次循环中调用循环<strong>序号</strong></p>
<pre><code>for(var i = 0; i &lt; 10; i++) {
    setTimeout(function() {
        console.log(i);  
    }, 1000);
}
</code></pre><p>所输入的内容不是 <code>0-9</code>，取而代之的是打印10次 <code>10</code>。<br>关键原因，在调用<code>console.log(i)</code>时，循环已经结束，同一个上下文中创建的闭包是共用一个[[Scope]]属性，导致<strong>i</strong>已经被修改成了<code>10</code>。<br>在ECMAScript中，同一个父上下文中创建的闭包是共用一个<code>[[Scope]]</code>属性的。也就是说，某个闭包对其中[[Scope]]的变量做修改会影响到其他闭包对其变量的读取。</p>
<h2 id="解决方式"><a href="#解决方式" class="headerlink" title="解决方式"></a>解决方式</h2><p>避免引用错误，获取正确序号。我们需要引入自执行函数，包裹一下。传入就是<code>i</code>的拷贝，这样就能获取正确的输出。</p>
<pre><code>for(var i = 0; i &lt; 10; i++) {
    (function(e) {
        setTimeout(function() {
            console.log(e);  
        }, 1000);
    })(i);
}
</code></pre><p>将<code>setTimeout</code>包裹在一个匿名函数中，匿名函数拥有变量<code>e</code>的引用，便不用被循环改变了。   </p>
<h2 id="使用闭包的断点"><a href="#使用闭包的断点" class="headerlink" title="使用闭包的断点"></a>使用闭包的断点</h2><p>在此贴上《JavaScript权威指南》中，使用<code>闭包的断点</code>代码。由<code>Steve Yen</code>所写，用来捕获一个函数中的当前作用域（包括局部变量和函数的参数），并返回其结果。</p>
<pre><code>function inspect(inspector, title) {
  var expression, result;
  if(&quot;ignore&quot; in arguments.callee) {
    return;
  }

  while(true) {
    var message = &quot;&quot;;
    if(title) {
      message = title + &quot;\n&quot;;
    }

    if(expression) {
      message += &quot;\n&quot; + expression + &quot; ==&gt; &quot; + result + &quot;\n&quot;;
    } else {
      expression = &quot;&quot;;
    }

    expression += &quot;Enter an expression to evaluate:&quot;;
    expression = prompt(message, expression);

    if(!expression) {
      return;
    }

    result = inspector(expression);
  }
}
</code></pre><h2 id="用断点技术计算阶乘的函数"><a href="#用断点技术计算阶乘的函数" class="headerlink" title="用断点技术计算阶乘的函数"></a>用断点技术计算阶乘的函数</h2><pre><code>function factorial(n) {
  var inspector = function($) {
    return eval($);
  }

  // inspect.ignore = true;
  inspect(inspector, &quot;Entering factorial()&quot;);

  var result = 1;
  while(n &gt; 1) {
    result *= n;
    n--;
    inspect(inspector, &quot;factorial() loop&quot;);
  }

  inspect(inspector, &quot;Exiting factorial()&quot;);
  return result;
}
</code></pre><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul>
<li><a href="http://www.amazon.cn/JavaScript%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97-%E5%BC%97%E6%8B%89%E7%BA%B3%E6%A0%B9/dp/B0012UMVYA/ref=sr_1_2?ie=UTF8&amp;qid=1393770256&amp;sr=8-2&amp;keywords=javascript+%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97" target="_blank" rel="external">JavaScript权威指南</a>  </li>
<li><a href="http://bonsaiden.github.io/JavaScript-Garden/zh/#function.closures" target="_blank" rel="external">Closure</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;JavaScript函数是将要执行的&lt;strong&gt;代码&lt;/strong&gt;及执行这些代码的&lt;strong&gt;作用域&lt;/strong&gt;构成的一个综合体。计算机术语称这种代码和作用域的综合体为&lt;strong&gt;闭包&lt;/strong&gt;。故所有JavaScript函数都是闭包。但我们常
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://owenyang0.github.io/tags/JavaScript/"/>
    
      <category term="closure" scheme="http://owenyang0.github.io/tags/closure/"/>
    
  </entry>
  
  <entry>
    <title>实习那几月</title>
    <link href="http://owenyang0.github.io/2014/02/17/%E5%AE%9E%E4%B9%A0%E9%82%A3%E5%87%A0%E6%9C%88/"/>
    <id>http://owenyang0.github.io/2014/02/17/实习那几月/</id>
    <published>2014-02-17T14:00:00.000Z</published>
    <updated>2016-08-15T09:00:19.000Z</updated>
    
    <content type="html"><![CDATA[<p>###题外<br>自<strong>新蛋实习</strong>至今，也有三个多月了吧。回想起那天面试的时候，还有些许的紧张，或许是自己知道的太少，或者是自己想表达的太多。反正初出茅庐的样子，让南哥见笑了好久（我猜的）。</p>
<p>###题前</p>
<p>新蛋算得上是我人生去的第一家公司吧，走出了学校那座象牙塔，才明白世界是如此的广阔——以至于自己在最初时，会有自己该有的迷茫。<br>今天突然有种想写一写的冲动，也不知道是写给自己，还是写给未来的自己。权当自己人生过往的一点印记，当自己未来的一种回首！</p>
<p>###题中</p>
<p>没错，我就是传说中的那个<strong>程序猿</strong>，起早而贪黑，半夜却又不想眠。不太方便形容，我此时的状态，是无法形容。</p>
<p><strong>只能说：</strong> 仅仅只是自我感受罢了</p>
<blockquote>
<p><strong>这三个月看的书，差不多比得上以前的半年</strong></p>
</blockquote>
<p>不论是技术书籍，抑或是其他类的书籍，总感觉看书才是和世界沟通的最好方式之一。如果，各位有机会&gt; 看到这篇不算博文的文章的话，建议大都去看看<code>遇见未知的自己</code>一本沉淀心灵的大作，在这个浮躁的社会，能静下心来是多么的难得</p>
<blockquote>
<p><strong>接触的越多，无知便越多</strong></p>
</blockquote>
<p>接触的项目不必太多，一两个足矣。如果自己真的把自己投入进去，才会发现原来真理的环境和象牙塔里的世界，是如此的不同。<br>IT人的技术是层出不穷，想必大家都了解。技术日新月异，追求新事物的脚步不止，深入某方面研究不悉，此乃上乘之道。</p>
<p>三个多月中，用到的主要技术是 <code>AngularJs</code> <code>jQuery</code> <code>NodeJs</code>。一切都是从新开始，所以很多公司看重<strong>学习能力</strong>还是有那么一点道理。但学习的尝试，和代码的整洁度与可阅读度，就取决于自己的积累了。对于自己的问题，还是只有自己清楚。</p>
<blockquote>
<p><strong><code>AngularJS</code> 和 <code>jQuery</code> 一起使用的时候，会出现一些问题</strong></p>
</blockquote>
<p>自己纠结最终证明都是不明志的，学会查看官方的文档，学会 <code>google</code> <code>StackOverflow</code> 才是一个程序猿所必须的。<br>典型的问题，<code>AngularJs</code> 和 <code>jQuery</code> 同时更新 <code>DOM</code> 时，绝大多数都会出错：由于两边同时调用 <code>apply</code> 方法时出错—— <code>apply</code> 方法能劫持另外一个对象的方法，继承另外一个对象的属性。可以采用timeout的方式，让避免问题的出现</p>
<blockquote>
<p><strong>设计好数据结构，永远都不会错</strong></p>
</blockquote>
<p>一个项目刚刚开始时，就要设计好主要数据的结构，否则到后期的时候，你将是苦不堪言。增增补补，修修改改，最后可能自己都对自己写的东西看不下去。因为那时，项目已经不能称之为项目了，是一个典型的垃圾补丁囤积场。</p>
<blockquote>
<p><strong>写好测试代码</strong></p>
</blockquote>
<p>很多人很可能都对 <code>TDD</code> 不屑一顾，认为那纯粹的是浪费时间。诚言，有些东西是不可测试的，但必须的测试单元还是需要的。<br>多数时候，回归 <code>BUG</code> 再现的时候，自己都不会注意所写的代码。当你改代码的时候，没有一个必须的东西来保证，你所修改的部分对其他部分不会产生影响，就算你相当的自信。</p>
<p>哈哈，其实很多东西都是瞎掰，各位看客权当笑话看就行。</p>
<p>###再说迷茫</p>
<p>我不知道别人怎样，反正作为我自己，是有些许迷茫的感觉——不知自己会从事什么，也不知自己可以深入什么。反正就一样：对很多东西都感觉兴趣。达到了别人眼中所谓的 <code>广度</code>，殊不知自己 <code>深度</code> 方面有太多的欠缺。<br>当有一天，有人问你：</p>
<blockquote>
<p>你学过那么多的东西，到底有没有一样是你真正喜欢的东西？你有自己所深入了解过的领域吗？</p>
</blockquote>
<p>一听如此言论，可能自己都会尴尬的无地自容。</p>
<blockquote>
<ul>
<li>回过头来想想自己到底在追求什么？</li>
<li>自己明白自己真的追求什么吗？</li>
<li>自己真的对自己有一个清晰的规划吗？</li>
</ul>
</blockquote>
<p>大家都想做有广度，有深度的人。但其过程，也许只有真正的有广度、有深度的人才能体会。很多时候，作决定都是艰难的。冷静下来思考一翻，可能自己还是理不清头绪，但起码自己思考过，套用一话。</p>
<blockquote>
<p>不在乎天长地长，至少我们曾经拥有。不在乎现在是否有结果，但至少我们曾经有过思考。</p>
</blockquote>
<p>###题后</p>
<p>想不到自己还是写到了最后，不说自己写了些什么，至少写的过程中，有些自己的考量。或许你们是觉得此博写得是如此的可笑，或许有一天我回头看的也觉得可笑。<br>但，那又怎样呢？</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;###题外&lt;br&gt;自&lt;strong&gt;新蛋实习&lt;/strong&gt;至今，也有三个多月了吧。回想起那天面试的时候，还有些许的紧张，或许是自己知道的太少，或者是自己想表达的太多。反正初出茅庐的样子，让南哥见笑了好久（我猜的）。&lt;/p&gt;
&lt;p&gt;###题前&lt;/p&gt;
&lt;p&gt;新蛋算得上是我
    
    </summary>
    
    
      <category term="intern" scheme="http://owenyang0.github.io/tags/intern/"/>
    
      <category term="newegg" scheme="http://owenyang0.github.io/tags/newegg/"/>
    
      <category term="graduate" scheme="http://owenyang0.github.io/tags/graduate/"/>
    
  </entry>
  
</feed>
